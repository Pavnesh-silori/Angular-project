import { __awaiter } from "tslib";
import { Component, ViewChild } from '@angular/core';
import { FormControl } from '@angular/forms';
import { ReportErrorEnum } from '../../../enum/error.enum';
import { AggregateDataRequest } from '../../../model/aggregate-data.model';
import { DevicesWithEntities } from '../../../model/device.model';
import { Alert } from '../../../model/alert.model';
import { DownloadReportRequest } from '../../../model/report.model';
// tsc-library
import { CUSTOM_RANGE_CONSTANT_EXCLUSIVE_DATE, DateFormatEnum, DateInputTypeEnum, DateTypeEnum } from '@library/date';
import { ToastrColor } from '@library/toastr-service';
import { ButtonLabelEnum, COMMON_CONSTANT, FormErrorEnum, InvalidForm, MATERIAL_CONSTANT, MatSelectSearchService, MaterialFormFieldAppearance, MessageAlertIconEnum, MessageAlertTypeEnum } from '@library/tsc-common';
import { ApplicationKeyID } from '@library/application-service';
import * as i0 from "@angular/core";
import * as i1 from "@library/storage-service";
import * as i2 from "@library/toastr-service";
import * as i3 from "@library/tsc-common";
import * as i4 from "../../../service/entity-device.service";
import * as i5 from "../../../service/aggregate-data.service";
import * as i6 from "../../../service/report.service";
import * as i7 from "../../../service/alert.service";
import * as i8 from "@library/date";
import * as i9 from "../../dropdown/aggregation-duration/aggregation-duration.component";
import * as i10 from "@angular/material/form-field";
import * as i11 from "@angular/material/select";
import * as i12 from "@angular/material/core";
import * as i13 from "ngx-mat-select-search";
import * as i14 from "../../dropdown/param-metric/param-metric.component";
import * as i15 from "../../_shared/download-report/download-report.component";
import * as i16 from "@angular/forms";
import * as i17 from "@angular/common";
// /tsc-library/
export class MeterReportComponent {
    constructor(storageService, toastService, tscCommonService, entityDeviceService, aggregateDataService, reportService, alertService) {
        this.storageService = storageService;
        this.toastService = toastService;
        this.tscCommonService = tscCommonService;
        this.entityDeviceService = entityDeviceService;
        this.aggregateDataService = aggregateDataService;
        this.reportService = reportService;
        this.alertService = alertService;
        this.materialConstant = MATERIAL_CONSTANT;
        this.commonConstant = COMMON_CONSTANT;
        this.customRangeConstant = CUSTOM_RANGE_CONSTANT_EXCLUSIVE_DATE;
        this.materialFormFieldAppearance = MaterialFormFieldAppearance;
        this.buttonLabelEnum = ButtonLabelEnum;
        this.dateFormatEnum = DateFormatEnum;
        this.dateInputTypeEnum = DateInputTypeEnum;
        this.dateTypeEnum = DateTypeEnum;
        this.FormErrorEnum = FormErrorEnum;
        this.parameterList = [];
        this.showAlert = false;
        this.showLoader = false;
        this.entityDeviceM = [new DevicesWithEntities()];
        this.reportAlertObj = new Alert();
        this.meterFC = new FormControl();
        this.meterSearchUtil = new MatSelectSearchService(['name']);
    }
    ngOnInit() {
        this.orgID = this.storageService.getStorage('currentOrgID');
        this.timezone = this.storageService.getStorage('timezone');
        this.applicationKeyID = this.storageService.getStorage('applicationKeyID');
        if (this.applicationKeyID == ApplicationKeyID.ENERGY_KEY_ID) {
            this.paramMetric = "engEnergyUsed";
        }
        else if (this.applicationKeyID == ApplicationKeyID.WATER_KEY_ID) {
            this.paramMetric = "gwFlowTotalizer";
        }
        this.getDevicesWithEntitiesByParameter();
    }
    getDevicesWithEntitiesByParameter() {
        var _a, _b, _c, _d, _e, _f;
        return __awaiter(this, void 0, void 0, function* () {
            this.entityDeviceM = (yield this.entityDeviceService.getDevicesWithEntitiesByParameter(this.orgID, this.paramMetric));
            this.meterSearchUtil.entityArr = this.entityDeviceM;
            this.meterSearchUtil.createSubscription();
            if (this.entityDeviceM.length > 0 && ((_b = (_a = this.entityDeviceM) === null || _a === void 0 ? void 0 : _a[0]) === null || _b === void 0 ? void 0 : _b.id)) {
                const deviceID = (_f = (_e = (_d = (_c = this.entityDeviceM) === null || _c === void 0 ? void 0 : _c[0]) === null || _d === void 0 ? void 0 : _d['devices']) === null || _e === void 0 ? void 0 : _e[0]) === null || _f === void 0 ? void 0 : _f['id'];
                this.meterFC.patchValue(deviceID);
                this.entityID = this.getEntityIDByDeviceID(deviceID);
            }
        });
    }
    meterChange(selectedMeter) {
        var _a, _b;
        (_a = this.paramInput) === null || _a === void 0 ? void 0 : _a.parameterFC.reset();
        (_b = this.paramInput) === null || _b === void 0 ? void 0 : _b.parameterFC.updateValueAndValidity();
        this.meterFC.patchValue(selectedMeter);
        this.entityID = this.getEntityIDByDeviceID(selectedMeter);
    }
    getEntityIDByDeviceID(deviceID) {
        for (const entity of this.entityDeviceM) {
            for (const device of entity.devices) {
                if (device.id == deviceID) {
                    return entity.id;
                }
            }
        }
        return null;
    }
    dateInpChange() {
        this.startDate = this.customDateInput.startDateFC.value;
        this.endDate = this.customDateInput.endDateFC.value;
        this.alertService.resetAlertProperties(this.reportAlertObj);
    }
    aggDurationInpChange() {
        this.aggDuration = this.aggDurationInput.aggDurationFC.value;
        this.alertService.resetAlertProperties(this.reportAlertObj);
    }
    paramInpChange() {
        var _a;
        let paramMetric = (_a = this.paramInput) === null || _a === void 0 ? void 0 : _a.parameterFC.value;
        if (paramMetric.length > 0) {
            this.parameterList = this.tscCommonService.removeSelectAllID(paramMetric);
        }
        this.alertService.resetAlertProperties(this.reportAlertObj);
    }
    viewReport() {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            this.alertService.resetAlertProperties(this.reportAlertObj);
            if (this.isValidInputField()) {
                this.toastService.openToast(InvalidForm.INVALID_FORM_TITLE, InvalidForm.INVALID_FORM_MESSAGE, ToastrColor.ERROR);
                return;
            }
            if (this.startDate == this.endDate) {
                this.alertService.setAlertProperties(this.reportAlertObj, ReportErrorEnum.INVALID_DATE_LABEL, ReportErrorEnum.INVALID_DATE_MESSAGE, MessageAlertTypeEnum.INFO, MessageAlertIconEnum.INFO_ICON);
                return;
            }
            this.showLoader = true;
            try {
                const requestData = this.createDataRequest();
                this.reportData = yield this.aggregateDataService.getAggregateData(this.orgID, requestData);
                if (((_a = this.reportData) === null || _a === void 0 ? void 0 : _a.length) > 0 && !((_b = this.reportData) === null || _b === void 0 ? void 0 : _b.every(item => item.data.length == 0))) {
                    this.timestamp = this.reportService.extractTimestamp(this.reportData);
                    this.renderTable = this.reportService.populateTable(this.timestamp, this.reportData, this.dateFormatEnum.DATE_TIME);
                }
                else {
                    this.alertService.setAlertProperties(this.reportAlertObj, ReportErrorEnum.DATA_NOT_FOUND_LABEL, ReportErrorEnum.DATA_NOT_FOUND_MESSAGE, MessageAlertTypeEnum.WARNING, MessageAlertIconEnum.WARNING_ICON);
                }
            }
            catch (error) {
                console.error("Error in viewReport()", error);
                this.alertService.setAlertProperties(this.reportAlertObj, ReportErrorEnum.INVALID_ERROR_LABEL, ReportErrorEnum.INVALID_ERROR_MESSAGE, MessageAlertTypeEnum.DANGER, MessageAlertIconEnum.DANGER_ICON);
            }
            finally {
                this.showLoader = false;
            }
        });
    }
    downloadReport(format) {
        return __awaiter(this, void 0, void 0, function* () {
            this.alertService.resetAlertProperties(this.reportAlertObj);
            if (this.isValidInputField()) {
                this.toastService.openToast(InvalidForm.INVALID_FORM_TITLE, InvalidForm.INVALID_FORM_MESSAGE, ToastrColor.ERROR);
                return;
            }
            if (this.startDate == this.endDate) {
                this.alertService.setAlertProperties(this.reportAlertObj, ReportErrorEnum.INVALID_DATE_LABEL, ReportErrorEnum.INVALID_DATE_MESSAGE, MessageAlertTypeEnum.INFO, MessageAlertIconEnum.INFO_ICON);
                return;
            }
            this.showLoader = true;
            try {
                const requestData = new DownloadReportRequest();
                requestData.request = this.createDataRequest();
                requestData.reportName = 'Meter Report';
                requestData.reportFormat = format;
                yield this.reportService.downloadReport(this.orgID, requestData);
            }
            catch (error) {
                console.error("Error in downloadReport()", error);
            }
            finally {
                this.showLoader = false;
            }
        });
    }
    createDataRequest() {
        const requestData = new AggregateDataRequest();
        requestData.startTime = this.startDate;
        requestData.endTime = this.endDate;
        requestData.interval = this.aggDuration;
        requestData.entityID = [this.entityID];
        requestData.deviceID = [this.meterFC.value];
        requestData.params = [];
        for (const paramMetric of this.parameterList) {
            requestData.params.push({
                name: paramMetric,
                dsAgg: "avg",
                agg: "avg"
            });
        }
        requestData.nullifyParams();
        return requestData;
    }
    isValidInputField() {
        const controls = [
            this.customDateInput.startDateFC,
            this.aggDurationInput.aggDurationFC,
            this.meterFC,
            this.paramInput.parameterFC
        ];
        controls.forEach(control => control.markAsTouched());
        return controls.some(control => control.invalid);
    }
}
MeterReportComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: MeterReportComponent, deps: [{ token: i1.StorageService }, { token: i2.ToastrService }, { token: i3.TSCCommonService }, { token: i4.EntityDeviceService }, { token: i5.AggregateDataService }, { token: i6.ReportService }, { token: i7.AlertService }], target: i0.ɵɵFactoryTarget.Component });
MeterReportComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.17", type: MeterReportComponent, selector: "lib-meter", viewQueries: [{ propertyName: "customDateInput", first: true, predicate: ["customDateInput"], descendants: true }, { propertyName: "aggDurationInput", first: true, predicate: ["aggDurationInput"], descendants: true }, { propertyName: "paramInput", first: true, predicate: ["paramInput"], descendants: true }], ngImport: i0, template: "<div class=\"card main-card cardOverwrite h100\">\n    <div class=\"headerContainer\">\n        <div class=\"headerLeftContainer\">\n            <div class=\"pageTitle\">Meter Report</div>\n        </div>\n    </div>\n\n    <div class=\"card-body\">\n        <div class=\"row\">\n            <div class=\"col-sm-3\">\n                <lib-date-input #customDateInput (emitFilter)=\"dateInpChange()\" [materialFieldWidthInp]=\"true\"\n                    [materialFormFieldAppearanceInp]=\"materialFormFieldAppearance.FORM_FIELD_APPEARANCE\"\n                    [isMandatoryFieldInp]=\"true\" [dateInputTypeInp]=\"dateInputTypeEnum.CUSTOM_INPUT\"\n                    [dateTypeInp]=\"dateTypeEnum.EXCLUSIVE\" [showDefaultDurationInp]=\"true\" [showCdrRangeLabelInp]=\"true\"\n                    [labelInp]=\"'Select date'\" [timezoneInp]=\"timezone\" [rangeInp]=\"customRangeConstant\" [showTimeInCDRInp]=\"true\"\n                    [showRangeInp]=\"true\" [cdrFormatInp]=\"'YYYY-MM-DD HH:mm:ss'\"></lib-date-input>\n            </div>\n\n            <div class=\"col-sm-3\">\n                <lib-aggregation-duration #aggDurationInput\n                    (emitFilter)=\"aggDurationInpChange()\"></lib-aggregation-duration>\n            </div>\n\n            <div class=\"col-sm-3\">\n                <mat-form-field class=\"matFieldWidth100\" [appearance]=\"materialFormFieldAppearance.FORM_FIELD_APPEARANCE\">\n                    <mat-label>Select meter</mat-label>\n                    <mat-select (selectionChange)=\"meterChange($event.value)\" [formControl]=\"meterFC\" required>\n                        <ng-container *ngIf=\"entityDeviceM && entityDeviceM.length > 0 && entityDeviceM?.[0]?.id; else noDataFound\">\n                            <mat-option>\n                                <ngx-mat-select-search [formControl]=\"meterSearchUtil.filterFC\" placeholderLabel=\"Search by entity name\"\n                                    noEntriesFoundLabel=\"No matching name found.\">\n                                </ngx-mat-select-search>\n                            </mat-option>\n                            <mat-optgroup *ngFor=\"let entity of meterSearchUtil.filteredEntities | async\" [label]=\"entity.name\"\n                                [disabled]=\"entity.disabled\">\n                                <mat-option *ngFor=\"let device of entity.devices\" [value]=\"device.id\">\n                                    {{ device.name }}\n                                </mat-option>\n                            </mat-optgroup>\n                        </ng-container>\n                        <ng-template #noDataFound>\n                            <mat-option disabled>\n                                {{ commonConstant.NO_DATA_FOUND }}\n                            </mat-option>\n                        </ng-template>\n                    </mat-select>\n                    <mat-error *ngIf=\"meterFC.touched && meterFC.hasError('required')\">\n                        {{ FormErrorEnum.REQUIRED }}\n                    </mat-error>\n                </mat-form-field>\n            </div>\n\n            <div class=\"col-sm-3\">\n                <lib-param-metric #paramInput [deviceInp]=\"meterFC.value\" (emitFilter)=\"paramInpChange()\"></lib-param-metric>\n            </div>\n        </div>\n\n        <div class=\"row\">\n            <div class=\"col-sm-12\">\n                <div class=\"float-end\">\n                    <button class=\"btn btn-sm btn-primary\" type=\"button\" (click)=\"viewReport()\" matRipple\n                        [matRippleCentered]=\"materialConstant.MAT_RIPPLE_CENTER\">\n                        {{ buttonLabelEnum.READ_BTN_LABEL }}\n                    </button>\n                    <lib-download-report (fileTypeEmitted)=\"downloadReport($event)\"></lib-download-report>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"row\">\n            <div class=\"col-sm-12\">\n                <lib-message-alert *ngIf=\"reportAlertObj.showAlert\" [labelInp]=\"reportAlertObj.alertLabel\"\n                    [contentInp]=\"reportAlertObj.alertContent\" [messageAlertTypeInp]=\"reportAlertObj.messageAlertType\"\n                    [messageAlertIconInp]=\"reportAlertObj.messageAlertIcon\">\n                </lib-message-alert>\n            </div>\n        </div>\n\n        <div class=\"row\">\n            <div class=\"centerAlign\">\n                <lib-skeleton-loader *ngIf=\"showLoader\" [count]=\"3\" [appearance]=\"'circle'\"\n                    [theme]=\"{ height: '15px', width: '15px', 'background-color': '#e7ebf3' }\"></lib-skeleton-loader>\n            </div>\n        </div>\n\n        <div class=\"row mt-3\" *ngIf=\"renderTable && renderTable.length > 0\">\n            <div class=\"overflowX customScrollBar\">\n                <table class=\"table\">\n                    <tbody>\n                        <tr class=\"tableHeader\">\n                            <td class=\"fw-bold\"> Sr. No. </td>\n                            <td align=\"center\" class=\"fw-bold\"> Time </td>\n                            <ng-container *ngFor=\"let data of reportData; let i = index\">\n                                <td align=\"center\" class=\"fw-bold\">\n                                    {{ data.paramLabel }} ({{ data.unit }}) ({{ data.dsAgg }})\n                                </td>\n                            </ng-container>\n                        </tr>\n                    </tbody>\n                    <tbody>\n                        <tr *ngFor=\"let row of renderTable\">\n                            <td>{{ row.index }}</td>\n                            <td align=\"center\" class=\"colWidthContainingDateTime\">{{ row.time }}</td>\n                            <td align=\"center\" *ngFor=\"let value of row.data\">{{ value ? value : commonConstant.HYPHEN\n                                }}\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n</div>", components: [{ type: i8.DateInputComponent, selector: "lib-date-input", inputs: ["materialFormFieldAppearanceInp", "materialFieldWidthInp", "frequencyInp", "dateInputTypeInp", "dateTypeInp", "timezoneInp", "labelInp", "rangeInp", "cdrFormatInp", "isMandatoryFieldInp", "showRangeInp", "showCdrRangeLabelInp", "showDefaultDurationInp", "showTimeInCDRInp"], outputs: ["emitFilter"] }, { type: i9.AggregationDurationComponent, selector: "lib-aggregation-duration", outputs: ["emitFilter"] }, { type: i10.MatFormField, selector: "mat-form-field", inputs: ["color", "floatLabel", "appearance", "hideRequiredMarker", "hintLabel"], exportAs: ["matFormField"] }, { type: i11.MatSelect, selector: "mat-select", inputs: ["disabled", "disableRipple", "tabIndex"], exportAs: ["matSelect"] }, { type: i12.MatOption, selector: "mat-option", exportAs: ["matOption"] }, { type: i13.MatSelectSearchComponent, selector: "ngx-mat-select-search", inputs: ["placeholderLabel", "type", "closeIcon", "closeSvgIcon", "noEntriesFoundLabel", "indexAndLengthScreenReaderText", "clearSearchInput", "searching", "disableInitialFocus", "enableClearOnEscapePressed", "preventHomeEndKeyPropagation", "disableScrollToActiveOnOptionsChanged", "ariaLabel", "showToggleAllCheckbox", "toggleAllCheckboxChecked", "toggleAllCheckboxIndeterminate", "toggleAllCheckboxTooltipMessage", "toogleAllCheckboxTooltipPosition", "hideClearSearchButton", "alwaysRestoreSelectedOptionsMulti"], outputs: ["toggleAll"] }, { type: i12.MatOptgroup, selector: "mat-optgroup", inputs: ["disabled"], exportAs: ["matOptgroup"] }, { type: i14.ParamMetricComponent, selector: "lib-param-metric", inputs: ["deviceInp"], outputs: ["emitFilter"] }, { type: i15.DownloadReportComponent, selector: "lib-download-report", inputs: ["excludeFileTypeInp"], outputs: ["fileTypeEmitted"] }, { type: i3.MessageAlertComponent, selector: "lib-message-alert", inputs: ["messageAlertTypeInp", "messageAlertIconInp", "labelInp", "contentInp", "showCloseBtnInp"] }, { type: i3.SkeletonComponent, selector: "lib-skeleton-loader", inputs: ["count", "appearance", "theme"] }], directives: [{ type: i10.MatLabel, selector: "mat-label" }, { type: i16.RequiredValidator, selector: ":not([type=checkbox])[required][formControlName],:not([type=checkbox])[required][formControl],:not([type=checkbox])[required][ngModel]", inputs: ["required"] }, { type: i16.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { type: i16.FormControlDirective, selector: "[formControl]", inputs: ["disabled", "formControl", "ngModel"], outputs: ["ngModelChange"], exportAs: ["ngForm"] }, { type: i17.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i17.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i10.MatError, selector: "mat-error", inputs: ["id"] }, { type: i12.MatRipple, selector: "[mat-ripple], [matRipple]", inputs: ["matRippleRadius", "matRippleDisabled", "matRippleTrigger", "matRippleColor", "matRippleUnbounded", "matRippleCentered", "matRippleAnimation"], exportAs: ["matRipple"] }], pipes: { "async": i17.AsyncPipe } });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: MeterReportComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'lib-meter',
                    templateUrl: './meter.component.html',
                    styles: []
                }]
        }], ctorParameters: function () { return [{ type: i1.StorageService }, { type: i2.ToastrService }, { type: i3.TSCCommonService }, { type: i4.EntityDeviceService }, { type: i5.AggregateDataService }, { type: i6.ReportService }, { type: i7.AlertService }]; }, propDecorators: { customDateInput: [{
                type: ViewChild,
                args: ['customDateInput']
            }], aggDurationInput: [{
                type: ViewChild,
                args: ['aggDurationInput']
            }], paramInput: [{
                type: ViewChild,
                args: ['paramInput']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWV0ZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbGlicmFyeS90c2MtbGl0ZS9zcmMvbGliL3RzYy9jb21wb25lbnQvcmVwb3J0L21ldGVyL21ldGVyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2xpYnJhcnkvdHNjLWxpdGUvc3JjL2xpYi90c2MvY29tcG9uZW50L3JlcG9ydC9tZXRlci9tZXRlci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDN0QsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTdDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUUzRCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUMzRSxPQUFPLEVBQUUsbUJBQW1CLEVBQXdCLE1BQU0sNkJBQTZCLENBQUM7QUFDeEYsT0FBTyxFQUFFLEtBQUssRUFBVSxNQUFNLDRCQUE0QixDQUFDO0FBQzNELE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBVXBFLGNBQWM7QUFDZCxPQUFPLEVBQUUsb0NBQW9DLEVBQUUsY0FBYyxFQUFzQixpQkFBaUIsRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFMUksT0FBTyxFQUFFLFdBQVcsRUFBaUIsTUFBTSx5QkFBeUIsQ0FBQztBQUNyRSxPQUFPLEVBQUUsZUFBZSxFQUFFLGVBQWUsRUFBRSxhQUFhLEVBQUUsV0FBVyxFQUFFLGlCQUFpQixFQUFFLHNCQUFzQixFQUFFLDJCQUEyQixFQUFFLG9CQUFvQixFQUFFLG9CQUFvQixFQUFvQixNQUFNLHFCQUFxQixDQUFDO0FBQ3pPLE9BQU8sRUFB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QUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUM7UUFDckQsT0FBTyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3JELENBQUM7O2tIQTdOUSxvQkFBb0I7c0dBQXBCLG9CQUFvQix1V0NoQ2pDLDI4TEFnSE07NEZEaEZPLG9CQUFvQjtrQkFOaEMsU0FBUzttQkFBQztvQkFDUCxRQUFRLEVBQUUsV0FBVztvQkFDckIsV0FBVyxFQUFFLHdCQUF3QjtvQkFDckMsTUFBTSxFQUFFLEVBQ1A7aUJBQ0o7NFJBb0NpQyxlQUFlO3NCQUE1QyxTQUFTO3VCQUFDLGlCQUFpQjtnQkFDRyxnQkFBZ0I7c0JBQTlDLFNBQVM7dUJBQUMsa0JBQWtCO2dCQUNKLFVBQVU7c0JBQWxDLFNBQVM7dUJBQUMsWUFBWSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEZvcm1Db250cm9sIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuXG5pbXBvcnQgeyBSZXBvcnRFcnJvckVudW0gfSBmcm9tICcuLi8uLi8uLi9lbnVtL2Vycm9yLmVudW0nO1xuXG5pbXBvcnQgeyBBZ2dyZWdhdGVEYXRhUmVxdWVzdCB9IGZyb20gJy4uLy4uLy4uL21vZGVsL2FnZ3JlZ2F0ZS1kYXRhLm1vZGVsJztcbmltcG9ydCB7IERldmljZXNXaXRoRW50aXRpZXMsIERldmljZXNXaXRoRW50aXRpZXNNIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWwvZGV2aWNlLm1vZGVsJztcbmltcG9ydCB7IEFsZXJ0LCBBbGVydE0gfSBmcm9tICcuLi8uLi8uLi9tb2RlbC9hbGVydC5tb2RlbCc7XG5pbXBvcnQgeyBEb3dubG9hZFJlcG9ydFJlcXVlc3QgfSBmcm9tICcuLi8uLi8uLi9tb2RlbC9yZXBvcnQubW9kZWwnO1xuXG5pbXBvcnQgeyBBZ2dyZWdhdGlvbkR1cmF0aW9uQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vZHJvcGRvd24vYWdncmVnYXRpb24tZHVyYXRpb24vYWdncmVnYXRpb24tZHVyYXRpb24uY29tcG9uZW50JztcbmltcG9ydCB7IFBhcmFtTWV0cmljQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vZHJvcGRvd24vcGFyYW0tbWV0cmljL3BhcmFtLW1ldHJpYy5jb21wb25lbnQnO1xuXG5pbXBvcnQgeyBFbnRpdHlEZXZpY2VTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZS9lbnRpdHktZGV2aWNlLnNlcnZpY2UnO1xuaW1wb3J0IHsgQWdncmVnYXRlRGF0YVNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9zZXJ2aWNlL2FnZ3JlZ2F0ZS1kYXRhLnNlcnZpY2UnO1xuaW1wb3J0IHsgUmVwb3J0U2VydmljZSB9IGZyb20gJy4uLy4uLy4uL3NlcnZpY2UvcmVwb3J0LnNlcnZpY2UnO1xuaW1wb3J0IHsgQWxlcnRTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZS9hbGVydC5zZXJ2aWNlJztcblxuLy8gdHNjLWxpYnJhcnlcbmltcG9ydCB7IENVU1RPTV9SQU5HRV9DT05TVEFOVF9FWENMVVNJVkVfREFURSwgRGF0ZUZvcm1hdEVudW0sIERhdGVJbnB1dENvbXBvbmVudCwgRGF0ZUlucHV0VHlwZUVudW0sIERhdGVUeXBlRW51bSB9IGZyb20gJ0BsaWJyYXJ5L2RhdGUnO1xuaW1wb3J0IHsgU3RvcmFnZVNlcnZpY2UgfSBmcm9tICdAbGlicmFyeS9zdG9yYWdlLXNlcnZpY2UnO1xuaW1wb3J0IHsgVG9hc3RyQ29sb3IsIFRvYXN0clNlcnZpY2UgfSBmcm9tICdAbGlicmFyeS90b2FzdHItc2VydmljZSc7XG5pbXBvcnQgeyBCdXR0b25MYWJlbEVudW0sIENPTU1PTl9DT05TVEFOVCwgRm9ybUVycm9yRW51bSwgSW52YWxpZEZvcm0sIE1BVEVSSUFMX0NPTlNUQU5ULCBNYXRTZWxlY3RTZWFyY2hTZXJ2aWNlLCBNYXRlcmlhbEZvcm1GaWVsZEFwcGVhcmFuY2UsIE1lc3NhZ2VBbGVydEljb25FbnVtLCBNZXNzYWdlQWxlcnRUeXBlRW51bSwgVFNDQ29tbW9uU2VydmljZSB9IGZyb20gJ0BsaWJyYXJ5L3RzYy1jb21tb24nO1xuaW1wb3J0IHsgQXBwbGljYXRpb25LZXlJRCB9IGZyb20gJ0BsaWJyYXJ5L2FwcGxpY2F0aW9uLXNlcnZpY2UnO1xuLy8gL3RzYy1saWJyYXJ5L1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2xpYi1tZXRlcicsXG4gICAgdGVtcGxhdGVVcmw6ICcuL21ldGVyLmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZXM6IFtcbiAgICBdXG59KVxuZXhwb3J0IGNsYXNzIE1ldGVyUmVwb3J0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICAgIG1hdGVyaWFsQ29uc3RhbnQgPSBNQVRFUklBTF9DT05TVEFOVDtcbiAgICBjb21tb25Db25zdGFudCA9IENPTU1PTl9DT05TVEFOVDtcbiAgICBjdXN0b21SYW5nZUNvbnN0YW50ID0gQ1VTVE9NX1JBTkdFX0NPTlNUQU5UX0VYQ0xVU0lWRV9EQVRFO1xuXG4gICAgbWF0ZXJpYWxGb3JtRmllbGRBcHBlYXJhbmNlID0gTWF0ZXJpYWxGb3JtRmllbGRBcHBlYXJhbmNlO1xuICAgIGJ1dHRvbkxhYmVsRW51bSA9IEJ1dHRvbkxhYmVsRW51bTtcbiAgICBkYXRlRm9ybWF0RW51bSA9IERhdGVGb3JtYXRFbnVtO1xuICAgIGRhdGVJbnB1dFR5cGVFbnVtID0gRGF0ZUlucHV0VHlwZUVudW07XG4gICAgZGF0ZVR5cGVFbnVtID0gRGF0ZVR5cGVFbnVtO1xuICAgIEZvcm1FcnJvckVudW0gPSBGb3JtRXJyb3JFbnVtO1xuXG4gICAgb3JnSUQ6IGFueTtcbiAgICBhcHBsaWNhdGlvbktleUlEOiBhbnk7XG4gICAgcGFyYW1NZXRyaWM6IGFueTtcbiAgICB0aW1lem9uZTogc3RyaW5nO1xuICAgIHN0YXJ0RGF0ZTogc3RyaW5nO1xuICAgIGVuZERhdGU6IHN0cmluZztcbiAgICBhZ2dEdXJhdGlvbjogc3RyaW5nO1xuICAgIGVudGl0eUlEOiBhbnk7XG4gICAgcGFyYW1ldGVyTGlzdDogYW55W10gPSBbXTtcbiAgICB0aW1lc3RhbXA6IGFueTtcbiAgICByZW5kZXJUYWJsZTogYW55O1xuICAgIHJlcG9ydERhdGE6IGFueTtcbiAgICBzaG93QWxlcnQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBzaG93TG9hZGVyOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBlbnRpdHlEZXZpY2VNID0gW25ldyBEZXZpY2VzV2l0aEVudGl0aWVzKCldO1xuICAgIHJlcG9ydEFsZXJ0T2JqOiBBbGVydE0gPSBuZXcgQWxlcnQoKTtcblxuICAgIG1ldGVyRkM6IEZvcm1Db250cm9sID0gbmV3IEZvcm1Db250cm9sKCk7XG5cbiAgICBtZXRlclNlYXJjaFV0aWw6IE1hdFNlbGVjdFNlYXJjaFNlcnZpY2UgPSBuZXcgTWF0U2VsZWN0U2VhcmNoU2VydmljZShbJ25hbWUnXSk7XG5cbiAgICBAVmlld0NoaWxkKCdjdXN0b21EYXRlSW5wdXQnKSBjdXN0b21EYXRlSW5wdXQ6IERhdGVJbnB1dENvbXBvbmVudDtcbiAgICBAVmlld0NoaWxkKCdhZ2dEdXJhdGlvbklucHV0JykgYWdnRHVyYXRpb25JbnB1dDogQWdncmVnYXRpb25EdXJhdGlvbkNvbXBvbmVudDtcbiAgICBAVmlld0NoaWxkKCdwYXJhbUlucHV0JykgcGFyYW1JbnB1dDogUGFyYW1NZXRyaWNDb21wb25lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBzdG9yYWdlU2VydmljZTogU3RvcmFnZVNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgdG9hc3RTZXJ2aWNlOiBUb2FzdHJTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIHRzY0NvbW1vblNlcnZpY2U6IFRTQ0NvbW1vblNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgZW50aXR5RGV2aWNlU2VydmljZTogRW50aXR5RGV2aWNlU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBhZ2dyZWdhdGVEYXRhU2VydmljZTogQWdncmVnYXRlRGF0YVNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgcmVwb3J0U2VydmljZTogUmVwb3J0U2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBhbGVydFNlcnZpY2U6IEFsZXJ0U2VydmljZVxuICAgICkgeyB9XG5cbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vcmdJRCA9IHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0U3RvcmFnZSgnY3VycmVudE9yZ0lEJyk7XG4gICAgICAgIHRoaXMudGltZXpvbmUgPSB0aGlzLnN0b3JhZ2VTZXJ2aWNlLmdldFN0b3JhZ2UoJ3RpbWV6b25lJyk7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb25LZXlJRCA9IHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0U3RvcmFnZSgnYXBwbGljYXRpb25LZXlJRCcpO1xuXG4gICAgICAgIGlmICh0aGlzLmFwcGxpY2F0aW9uS2V5SUQgPT0gQXBwbGljYXRpb25LZXlJRC5FTkVSR1lfS0VZX0lEKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmFtTWV0cmljID0gXCJlbmdFbmVyZ3lVc2VkXCI7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5hcHBsaWNhdGlvbktleUlEID09IEFwcGxpY2F0aW9uS2V5SUQuV0FURVJfS0VZX0lEKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmFtTWV0cmljID0gXCJnd0Zsb3dUb3RhbGl6ZXJcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZ2V0RGV2aWNlc1dpdGhFbnRpdGllc0J5UGFyYW1ldGVyKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0RGV2aWNlc1dpdGhFbnRpdGllc0J5UGFyYW1ldGVyKCkge1xuICAgICAgICB0aGlzLmVudGl0eURldmljZU0gPSA8RGV2aWNlc1dpdGhFbnRpdGllc01bXT5hd2FpdCB0aGlzLmVudGl0eURldmljZVNlcnZpY2UuZ2V0RGV2aWNlc1dpdGhFbnRpdGllc0J5UGFyYW1ldGVyKHRoaXMub3JnSUQsIHRoaXMucGFyYW1NZXRyaWMpO1xuXG4gICAgICAgIHRoaXMubWV0ZXJTZWFyY2hVdGlsLmVudGl0eUFyciA9IHRoaXMuZW50aXR5RGV2aWNlTTtcbiAgICAgICAgdGhpcy5tZXRlclNlYXJjaFV0aWwuY3JlYXRlU3Vic2NyaXB0aW9uKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuZW50aXR5RGV2aWNlTS5sZW5ndGggPiAwICYmIHRoaXMuZW50aXR5RGV2aWNlTT8uWzBdPy5pZCkge1xuICAgICAgICAgICAgY29uc3QgZGV2aWNlSUQgPSB0aGlzLmVudGl0eURldmljZU0/LlswXT8uWydkZXZpY2VzJ10/LlswXT8uWydpZCddO1xuICAgICAgICAgICAgdGhpcy5tZXRlckZDLnBhdGNoVmFsdWUoZGV2aWNlSUQpO1xuICAgICAgICAgICAgdGhpcy5lbnRpdHlJRCA9IHRoaXMuZ2V0RW50aXR5SURCeURldmljZUlEKGRldmljZUlEKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1ldGVyQ2hhbmdlKHNlbGVjdGVkTWV0ZXIpIHtcbiAgICAgICAgdGhpcy5wYXJhbUlucHV0Py5wYXJhbWV0ZXJGQy5yZXNldCgpO1xuICAgICAgICB0aGlzLnBhcmFtSW5wdXQ/LnBhcmFtZXRlckZDLnVwZGF0ZVZhbHVlQW5kVmFsaWRpdHkoKTtcblxuICAgICAgICB0aGlzLm1ldGVyRkMucGF0Y2hWYWx1ZShzZWxlY3RlZE1ldGVyKTtcbiAgICAgICAgdGhpcy5lbnRpdHlJRCA9IHRoaXMuZ2V0RW50aXR5SURCeURldmljZUlEKHNlbGVjdGVkTWV0ZXIpO1xuICAgIH1cblxuICAgIGdldEVudGl0eUlEQnlEZXZpY2VJRChkZXZpY2VJRCkge1xuICAgICAgICBmb3IgKGNvbnN0IGVudGl0eSBvZiB0aGlzLmVudGl0eURldmljZU0pIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZGV2aWNlIG9mIGVudGl0eS5kZXZpY2VzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRldmljZS5pZCA9PSBkZXZpY2VJRCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZW50aXR5LmlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBkYXRlSW5wQ2hhbmdlKCkge1xuICAgICAgICB0aGlzLnN0YXJ0RGF0ZSA9IHRoaXMuY3VzdG9tRGF0ZUlucHV0LnN0YXJ0RGF0ZUZDLnZhbHVlO1xuICAgICAgICB0aGlzLmVuZERhdGUgPSB0aGlzLmN1c3RvbURhdGVJbnB1dC5lbmREYXRlRkMudmFsdWU7XG5cbiAgICAgICAgdGhpcy5hbGVydFNlcnZpY2UucmVzZXRBbGVydFByb3BlcnRpZXModGhpcy5yZXBvcnRBbGVydE9iaik7XG5cbiAgICB9XG5cbiAgICBhZ2dEdXJhdGlvbklucENoYW5nZSgpIHtcbiAgICAgICAgdGhpcy5hZ2dEdXJhdGlvbiA9IHRoaXMuYWdnRHVyYXRpb25JbnB1dC5hZ2dEdXJhdGlvbkZDLnZhbHVlO1xuXG4gICAgICAgIHRoaXMuYWxlcnRTZXJ2aWNlLnJlc2V0QWxlcnRQcm9wZXJ0aWVzKHRoaXMucmVwb3J0QWxlcnRPYmopO1xuXG4gICAgfVxuXG4gICAgcGFyYW1JbnBDaGFuZ2UoKSB7XG4gICAgICAgIGxldCBwYXJhbU1ldHJpYyA9IHRoaXMucGFyYW1JbnB1dD8ucGFyYW1ldGVyRkMudmFsdWU7XG5cbiAgICAgICAgaWYgKHBhcmFtTWV0cmljLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMucGFyYW1ldGVyTGlzdCA9IHRoaXMudHNjQ29tbW9uU2VydmljZS5yZW1vdmVTZWxlY3RBbGxJRChwYXJhbU1ldHJpYyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmFsZXJ0U2VydmljZS5yZXNldEFsZXJ0UHJvcGVydGllcyh0aGlzLnJlcG9ydEFsZXJ0T2JqKTtcblxuICAgIH1cblxuICAgIGFzeW5jIHZpZXdSZXBvcnQoKSB7XG5cbiAgICAgICAgdGhpcy5hbGVydFNlcnZpY2UucmVzZXRBbGVydFByb3BlcnRpZXModGhpcy5yZXBvcnRBbGVydE9iaik7XG5cbiAgICAgICAgaWYgKHRoaXMuaXNWYWxpZElucHV0RmllbGQoKSkge1xuICAgICAgICAgICAgdGhpcy50b2FzdFNlcnZpY2Uub3BlblRvYXN0KEludmFsaWRGb3JtLklOVkFMSURfRk9STV9USVRMRSwgSW52YWxpZEZvcm0uSU5WQUxJRF9GT1JNX01FU1NBR0UsIFRvYXN0ckNvbG9yLkVSUk9SKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnN0YXJ0RGF0ZSA9PSB0aGlzLmVuZERhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuYWxlcnRTZXJ2aWNlLnNldEFsZXJ0UHJvcGVydGllcyh0aGlzLnJlcG9ydEFsZXJ0T2JqLCBSZXBvcnRFcnJvckVudW0uSU5WQUxJRF9EQVRFX0xBQkVMLCBSZXBvcnRFcnJvckVudW0uSU5WQUxJRF9EQVRFX01FU1NBR0UsIE1lc3NhZ2VBbGVydFR5cGVFbnVtLklORk8sIE1lc3NhZ2VBbGVydEljb25FbnVtLklORk9fSUNPTik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNob3dMb2FkZXIgPSB0cnVlO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0RGF0YSA9IHRoaXMuY3JlYXRlRGF0YVJlcXVlc3QoKTtcblxuICAgICAgICAgICAgdGhpcy5yZXBvcnREYXRhID0gYXdhaXQgdGhpcy5hZ2dyZWdhdGVEYXRhU2VydmljZS5nZXRBZ2dyZWdhdGVEYXRhKHRoaXMub3JnSUQsIHJlcXVlc3REYXRhKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMucmVwb3J0RGF0YT8ubGVuZ3RoID4gMCAmJiAhdGhpcy5yZXBvcnREYXRhPy5ldmVyeShpdGVtID0+IGl0ZW0uZGF0YS5sZW5ndGggPT0gMCkgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aGlzLnJlcG9ydFNlcnZpY2UuZXh0cmFjdFRpbWVzdGFtcCh0aGlzLnJlcG9ydERhdGEpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyVGFibGUgPSB0aGlzLnJlcG9ydFNlcnZpY2UucG9wdWxhdGVUYWJsZSh0aGlzLnRpbWVzdGFtcCwgdGhpcy5yZXBvcnREYXRhLCB0aGlzLmRhdGVGb3JtYXRFbnVtLkRBVEVfVElNRSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuYWxlcnRTZXJ2aWNlLnNldEFsZXJ0UHJvcGVydGllcyh0aGlzLnJlcG9ydEFsZXJ0T2JqLCBSZXBvcnRFcnJvckVudW0uREFUQV9OT1RfRk9VTkRfTEFCRUwsIFJlcG9ydEVycm9yRW51bS5EQVRBX05PVF9GT1VORF9NRVNTQUdFLCBNZXNzYWdlQWxlcnRUeXBlRW51bS5XQVJOSU5HLCBNZXNzYWdlQWxlcnRJY29uRW51bS5XQVJOSU5HX0lDT04pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaW4gdmlld1JlcG9ydCgpXCIsIGVycm9yKTtcbiAgICAgICAgICAgIHRoaXMuYWxlcnRTZXJ2aWNlLnNldEFsZXJ0UHJvcGVydGllcyh0aGlzLnJlcG9ydEFsZXJ0T2JqLCBSZXBvcnRFcnJvckVudW0uSU5WQUxJRF9FUlJPUl9MQUJFTCwgUmVwb3J0RXJyb3JFbnVtLklOVkFMSURfRVJST1JfTUVTU0FHRSwgTWVzc2FnZUFsZXJ0VHlwZUVudW0uREFOR0VSLCBNZXNzYWdlQWxlcnRJY29uRW51bS5EQU5HRVJfSUNPTik7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLnNob3dMb2FkZXIgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGRvd25sb2FkUmVwb3J0KGZvcm1hdDogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuYWxlcnRTZXJ2aWNlLnJlc2V0QWxlcnRQcm9wZXJ0aWVzKHRoaXMucmVwb3J0QWxlcnRPYmopO1xuXG4gICAgICAgIGlmICh0aGlzLmlzVmFsaWRJbnB1dEZpZWxkKCkpIHtcbiAgICAgICAgICAgIHRoaXMudG9hc3RTZXJ2aWNlLm9wZW5Ub2FzdChJbnZhbGlkRm9ybS5JTlZBTElEX0ZPUk1fVElUTEUsIEludmFsaWRGb3JtLklOVkFMSURfRk9STV9NRVNTQUdFLCBUb2FzdHJDb2xvci5FUlJPUik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zdGFydERhdGUgPT0gdGhpcy5lbmREYXRlKSB7XG4gICAgICAgICAgICB0aGlzLmFsZXJ0U2VydmljZS5zZXRBbGVydFByb3BlcnRpZXModGhpcy5yZXBvcnRBbGVydE9iaiwgUmVwb3J0RXJyb3JFbnVtLklOVkFMSURfREFURV9MQUJFTCwgUmVwb3J0RXJyb3JFbnVtLklOVkFMSURfREFURV9NRVNTQUdFLCBNZXNzYWdlQWxlcnRUeXBlRW51bS5JTkZPLCBNZXNzYWdlQWxlcnRJY29uRW51bS5JTkZPX0lDT04pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zaG93TG9hZGVyID0gdHJ1ZTtcblxuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0RGF0YSA9IG5ldyBEb3dubG9hZFJlcG9ydFJlcXVlc3QoKTtcblxuICAgICAgICAgICAgcmVxdWVzdERhdGEucmVxdWVzdCA9IHRoaXMuY3JlYXRlRGF0YVJlcXVlc3QoKTtcbiAgICAgICAgICAgIHJlcXVlc3REYXRhLnJlcG9ydE5hbWUgPSAnTWV0ZXIgUmVwb3J0JztcbiAgICAgICAgICAgIHJlcXVlc3REYXRhLnJlcG9ydEZvcm1hdCA9IGZvcm1hdDtcblxuICAgICAgICAgICAgYXdhaXQgdGhpcy5yZXBvcnRTZXJ2aWNlLmRvd25sb2FkUmVwb3J0KHRoaXMub3JnSUQsIHJlcXVlc3REYXRhKTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGluIGRvd25sb2FkUmVwb3J0KClcIiwgZXJyb3IpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5zaG93TG9hZGVyID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjcmVhdGVEYXRhUmVxdWVzdCgpIHtcblxuICAgICAgICBjb25zdCByZXF1ZXN0RGF0YSA9IG5ldyBBZ2dyZWdhdGVEYXRhUmVxdWVzdCgpO1xuXG4gICAgICAgIHJlcXVlc3REYXRhLnN0YXJ0VGltZSA9IHRoaXMuc3RhcnREYXRlO1xuICAgICAgICByZXF1ZXN0RGF0YS5lbmRUaW1lID0gdGhpcy5lbmREYXRlO1xuICAgICAgICByZXF1ZXN0RGF0YS5pbnRlcnZhbCA9IHRoaXMuYWdnRHVyYXRpb247XG4gICAgICAgIHJlcXVlc3REYXRhLmVudGl0eUlEID0gW3RoaXMuZW50aXR5SURdO1xuICAgICAgICByZXF1ZXN0RGF0YS5kZXZpY2VJRCA9IFt0aGlzLm1ldGVyRkMudmFsdWVdO1xuICAgICAgICByZXF1ZXN0RGF0YS5wYXJhbXMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBwYXJhbU1ldHJpYyBvZiB0aGlzLnBhcmFtZXRlckxpc3QpIHtcbiAgICAgICAgICAgIHJlcXVlc3REYXRhLnBhcmFtcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBuYW1lOiBwYXJhbU1ldHJpYyxcbiAgICAgICAgICAgICAgICBkc0FnZzogXCJhdmdcIixcbiAgICAgICAgICAgICAgICBhZ2c6IFwiYXZnXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJlcXVlc3REYXRhLm51bGxpZnlQYXJhbXMoKTtcblxuICAgICAgICByZXR1cm4gcmVxdWVzdERhdGE7XG4gICAgfVxuXG4gICAgaXNWYWxpZElucHV0RmllbGQoKSB7XG4gICAgICAgIGNvbnN0IGNvbnRyb2xzID0gW1xuICAgICAgICAgICAgdGhpcy5jdXN0b21EYXRlSW5wdXQuc3RhcnREYXRlRkMsXG4gICAgICAgICAgICB0aGlzLmFnZ0R1cmF0aW9uSW5wdXQuYWdnRHVyYXRpb25GQyxcbiAgICAgICAgICAgIHRoaXMubWV0ZXJGQyxcbiAgICAgICAgICAgIHRoaXMucGFyYW1JbnB1dC5wYXJhbWV0ZXJGQ1xuICAgICAgICBdO1xuXG4gICAgICAgIGNvbnRyb2xzLmZvckVhY2goY29udHJvbCA9PiBjb250cm9sLm1hcmtBc1RvdWNoZWQoKSk7XG4gICAgICAgIHJldHVybiBjb250cm9scy5zb21lKGNvbnRyb2wgPT4gY29udHJvbC5pbnZhbGlkKTtcbiAgICB9XG5cbn1cbiIsIjxkaXYgY2xhc3M9XCJjYXJkIG1haW4tY2FyZCBjYXJkT3ZlcndyaXRlIGgxMDBcIj5cbiAgICA8ZGl2IGNsYXNzPVwiaGVhZGVyQ29udGFpbmVyXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXJMZWZ0Q29udGFpbmVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwicGFnZVRpdGxlXCI+TWV0ZXIgUmVwb3J0PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuXG4gICAgPGRpdiBjbGFzcz1cImNhcmQtYm9keVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwicm93XCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNtLTNcIj5cbiAgICAgICAgICAgICAgICA8bGliLWRhdGUtaW5wdXQgI2N1c3RvbURhdGVJbnB1dCAoZW1pdEZpbHRlcik9XCJkYXRlSW5wQ2hhbmdlKClcIiBbbWF0ZXJpYWxGaWVsZFdpZHRoSW5wXT1cInRydWVcIlxuICAgICAgICAgICAgICAgICAgICBbbWF0ZXJpYWxGb3JtRmllbGRBcHBlYXJhbmNlSW5wXT1cIm1hdGVyaWFsRm9ybUZpZWxkQXBwZWFyYW5jZS5GT1JNX0ZJRUxEX0FQUEVBUkFOQ0VcIlxuICAgICAgICAgICAgICAgICAgICBbaXNNYW5kYXRvcnlGaWVsZElucF09XCJ0cnVlXCIgW2RhdGVJbnB1dFR5cGVJbnBdPVwiZGF0ZUlucHV0VHlwZUVudW0uQ1VTVE9NX0lOUFVUXCJcbiAgICAgICAgICAgICAgICAgICAgW2RhdGVUeXBlSW5wXT1cImRhdGVUeXBlRW51bS5FWENMVVNJVkVcIiBbc2hvd0RlZmF1bHREdXJhdGlvbklucF09XCJ0cnVlXCIgW3Nob3dDZHJSYW5nZUxhYmVsSW5wXT1cInRydWVcIlxuICAgICAgICAgICAgICAgICAgICBbbGFiZWxJbnBdPVwiJ1NlbGVjdCBkYXRlJ1wiIFt0aW1lem9uZUlucF09XCJ0aW1lem9uZVwiIFtyYW5nZUlucF09XCJjdXN0b21SYW5nZUNvbnN0YW50XCIgW3Nob3dUaW1lSW5DRFJJbnBdPVwidHJ1ZVwiXG4gICAgICAgICAgICAgICAgICAgIFtzaG93UmFuZ2VJbnBdPVwidHJ1ZVwiIFtjZHJGb3JtYXRJbnBdPVwiJ1lZWVktTU0tREQgSEg6bW06c3MnXCI+PC9saWItZGF0ZS1pbnB1dD5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNtLTNcIj5cbiAgICAgICAgICAgICAgICA8bGliLWFnZ3JlZ2F0aW9uLWR1cmF0aW9uICNhZ2dEdXJhdGlvbklucHV0XG4gICAgICAgICAgICAgICAgICAgIChlbWl0RmlsdGVyKT1cImFnZ0R1cmF0aW9uSW5wQ2hhbmdlKClcIj48L2xpYi1hZ2dyZWdhdGlvbi1kdXJhdGlvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNtLTNcIj5cbiAgICAgICAgICAgICAgICA8bWF0LWZvcm0tZmllbGQgY2xhc3M9XCJtYXRGaWVsZFdpZHRoMTAwXCIgW2FwcGVhcmFuY2VdPVwibWF0ZXJpYWxGb3JtRmllbGRBcHBlYXJhbmNlLkZPUk1fRklFTERfQVBQRUFSQU5DRVwiPlxuICAgICAgICAgICAgICAgICAgICA8bWF0LWxhYmVsPlNlbGVjdCBtZXRlcjwvbWF0LWxhYmVsPlxuICAgICAgICAgICAgICAgICAgICA8bWF0LXNlbGVjdCAoc2VsZWN0aW9uQ2hhbmdlKT1cIm1ldGVyQ2hhbmdlKCRldmVudC52YWx1ZSlcIiBbZm9ybUNvbnRyb2xdPVwibWV0ZXJGQ1wiIHJlcXVpcmVkPlxuICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImVudGl0eURldmljZU0gJiYgZW50aXR5RGV2aWNlTS5sZW5ndGggPiAwICYmIGVudGl0eURldmljZU0/LlswXT8uaWQ7IGVsc2Ugbm9EYXRhRm91bmRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bWF0LW9wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5neC1tYXQtc2VsZWN0LXNlYXJjaCBbZm9ybUNvbnRyb2xdPVwibWV0ZXJTZWFyY2hVdGlsLmZpbHRlckZDXCIgcGxhY2Vob2xkZXJMYWJlbD1cIlNlYXJjaCBieSBlbnRpdHkgbmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub0VudHJpZXNGb3VuZExhYmVsPVwiTm8gbWF0Y2hpbmcgbmFtZSBmb3VuZC5cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZ3gtbWF0LXNlbGVjdC1zZWFyY2g+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9tYXQtb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxtYXQtb3B0Z3JvdXAgKm5nRm9yPVwibGV0IGVudGl0eSBvZiBtZXRlclNlYXJjaFV0aWwuZmlsdGVyZWRFbnRpdGllcyB8IGFzeW5jXCIgW2xhYmVsXT1cImVudGl0eS5uYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2Rpc2FibGVkXT1cImVudGl0eS5kaXNhYmxlZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bWF0LW9wdGlvbiAqbmdGb3I9XCJsZXQgZGV2aWNlIG9mIGVudGl0eS5kZXZpY2VzXCIgW3ZhbHVlXT1cImRldmljZS5pZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgZGV2aWNlLm5hbWUgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9tYXQtb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbWF0LW9wdGdyb3VwPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgI25vRGF0YUZvdW5kPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxtYXQtb3B0aW9uIGRpc2FibGVkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyBjb21tb25Db25zdGFudC5OT19EQVRBX0ZPVU5EIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9tYXQtb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgPC9tYXQtc2VsZWN0PlxuICAgICAgICAgICAgICAgICAgICA8bWF0LWVycm9yICpuZ0lmPVwibWV0ZXJGQy50b3VjaGVkICYmIG1ldGVyRkMuaGFzRXJyb3IoJ3JlcXVpcmVkJylcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt7IEZvcm1FcnJvckVudW0uUkVRVUlSRUQgfX1cbiAgICAgICAgICAgICAgICAgICAgPC9tYXQtZXJyb3I+XG4gICAgICAgICAgICAgICAgPC9tYXQtZm9ybS1maWVsZD5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNtLTNcIj5cbiAgICAgICAgICAgICAgICA8bGliLXBhcmFtLW1ldHJpYyAjcGFyYW1JbnB1dCBbZGV2aWNlSW5wXT1cIm1ldGVyRkMudmFsdWVcIiAoZW1pdEZpbHRlcik9XCJwYXJhbUlucENoYW5nZSgpXCI+PC9saWItcGFyYW0tbWV0cmljPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxkaXYgY2xhc3M9XCJyb3dcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtc20tMTJcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxvYXQtZW5kXCI+XG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5XCIgdHlwZT1cImJ1dHRvblwiIChjbGljayk9XCJ2aWV3UmVwb3J0KClcIiBtYXRSaXBwbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIFttYXRSaXBwbGVDZW50ZXJlZF09XCJtYXRlcmlhbENvbnN0YW50Lk1BVF9SSVBQTEVfQ0VOVEVSXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7eyBidXR0b25MYWJlbEVudW0uUkVBRF9CVE5fTEFCRUwgfX1cbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICAgIDxsaWItZG93bmxvYWQtcmVwb3J0IChmaWxlVHlwZUVtaXR0ZWQpPVwiZG93bmxvYWRSZXBvcnQoJGV2ZW50KVwiPjwvbGliLWRvd25sb2FkLXJlcG9ydD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8ZGl2IGNsYXNzPVwicm93XCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNtLTEyXCI+XG4gICAgICAgICAgICAgICAgPGxpYi1tZXNzYWdlLWFsZXJ0ICpuZ0lmPVwicmVwb3J0QWxlcnRPYmouc2hvd0FsZXJ0XCIgW2xhYmVsSW5wXT1cInJlcG9ydEFsZXJ0T2JqLmFsZXJ0TGFiZWxcIlxuICAgICAgICAgICAgICAgICAgICBbY29udGVudElucF09XCJyZXBvcnRBbGVydE9iai5hbGVydENvbnRlbnRcIiBbbWVzc2FnZUFsZXJ0VHlwZUlucF09XCJyZXBvcnRBbGVydE9iai5tZXNzYWdlQWxlcnRUeXBlXCJcbiAgICAgICAgICAgICAgICAgICAgW21lc3NhZ2VBbGVydEljb25JbnBdPVwicmVwb3J0QWxlcnRPYmoubWVzc2FnZUFsZXJ0SWNvblwiPlxuICAgICAgICAgICAgICAgIDwvbGliLW1lc3NhZ2UtYWxlcnQ+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPGRpdiBjbGFzcz1cInJvd1wiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNlbnRlckFsaWduXCI+XG4gICAgICAgICAgICAgICAgPGxpYi1za2VsZXRvbi1sb2FkZXIgKm5nSWY9XCJzaG93TG9hZGVyXCIgW2NvdW50XT1cIjNcIiBbYXBwZWFyYW5jZV09XCInY2lyY2xlJ1wiXG4gICAgICAgICAgICAgICAgICAgIFt0aGVtZV09XCJ7IGhlaWdodDogJzE1cHgnLCB3aWR0aDogJzE1cHgnLCAnYmFja2dyb3VuZC1jb2xvcic6ICcjZTdlYmYzJyB9XCI+PC9saWItc2tlbGV0b24tbG9hZGVyPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxkaXYgY2xhc3M9XCJyb3cgbXQtM1wiICpuZ0lmPVwicmVuZGVyVGFibGUgJiYgcmVuZGVyVGFibGUubGVuZ3RoID4gMFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm92ZXJmbG93WCBjdXN0b21TY3JvbGxCYXJcIj5cbiAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XCJ0YWJsZVwiPlxuICAgICAgICAgICAgICAgICAgICA8dGJvZHk+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dHIgY2xhc3M9XCJ0YWJsZUhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cImZ3LWJvbGRcIj4gU3IuIE5vLiA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBhbGlnbj1cImNlbnRlclwiIGNsYXNzPVwiZnctYm9sZFwiPiBUaW1lIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgZGF0YSBvZiByZXBvcnREYXRhOyBsZXQgaSA9IGluZGV4XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBhbGlnbj1cImNlbnRlclwiIGNsYXNzPVwiZnctYm9sZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgZGF0YS5wYXJhbUxhYmVsIH19ICh7eyBkYXRhLnVuaXQgfX0pICh7eyBkYXRhLmRzQWdnIH19KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgPC90Ym9keT5cbiAgICAgICAgICAgICAgICAgICAgPHRib2R5PlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRyICpuZ0Zvcj1cImxldCByb3cgb2YgcmVuZGVyVGFibGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+e3sgcm93LmluZGV4IH19PC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgYWxpZ249XCJjZW50ZXJcIiBjbGFzcz1cImNvbFdpZHRoQ29udGFpbmluZ0RhdGVUaW1lXCI+e3sgcm93LnRpbWUgfX08L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBhbGlnbj1cImNlbnRlclwiICpuZ0Zvcj1cImxldCB2YWx1ZSBvZiByb3cuZGF0YVwiPnt7IHZhbHVlID8gdmFsdWUgOiBjb21tb25Db25zdGFudC5IWVBIRU5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgPC90Ym9keT5cbiAgICAgICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuPC9kaXY+Il19