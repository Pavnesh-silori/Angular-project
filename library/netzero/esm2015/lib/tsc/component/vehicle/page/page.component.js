import { __awaiter } from "tslib";
import { Component, ViewChild } from '@angular/core';
import { MatPaginator } from '@angular/material/paginator';
import { FormControl } from '@angular/forms';
import { merge, fromEvent, of as observableOf } from 'rxjs';
import { catchError, map, startWith, switchMap } from 'rxjs/operators';
import { faPlus, faEllipsisV } from '@fortawesome/free-solid-svg-icons';
import { CreateUpdateComponent } from '../create-update/create-update.component';
import { UnitTypeKeyID } from '@library/unit-service';
import { ToastrTitle } from '@library/toastr-service';
import { COMMON_CONSTANT, TABLE_CONSTANT, FormAction, BulkUploadDialogLib, DialogOneComponent, DialogOneEnum, ComponentSourceEnum, DialogEnum } from "@library/tsc-common";
import * as i0 from "@angular/core";
import * as i1 from "@angular/material/dialog";
import * as i2 from "../../../controller/vehicle.controller";
import * as i3 from "@library/storage-service";
import * as i4 from "../../../service/vehicle.service";
import * as i5 from "@library/unit-service";
import * as i6 from "@library/toastr-service";
import * as i7 from "@library/tsc-common";
import * as i8 from "@fortawesome/angular-fontawesome";
import * as i9 from "@angular/material/table";
import * as i10 from "@angular/material/paginator";
import * as i11 from "@ng-bootstrap/ng-bootstrap";
// /tsc-library/
export class PageComponent {
    constructor(dialog, vehicleController, storageService, vehicleService, unitService, toastrService) {
        this.dialog = dialog;
        this.vehicleController = vehicleController;
        this.storageService = storageService;
        this.vehicleService = vehicleService;
        this.unitService = unitService;
        this.toastrService = toastrService;
        this.COMMON_CONSTANT = COMMON_CONSTANT;
        this.TABLE_CONSTANT = TABLE_CONSTANT;
        this.FormAction = FormAction;
        this.faPlus = faPlus;
        this.faEllipsisV = faEllipsisV;
        this.displayedColumns = ['vehicleNumber', 'vehicleName', 'vehicleType', 'vehicleCategory', 'engineStroke', 'year', 'odometer', 'actions'];
        this.searchFlag = false;
        this.error = false;
        this.vehicleTypeList = [];
        this.vehicleTypeFc = new FormControl();
        this.vehicleTypeFlag = false;
        this.vehicleCategoryList = [];
        this.vehicleCategoryFc = new FormControl();
        this.vehicleCategoryFlag = false;
        this.odometerList = [];
        this.odometerFc = new FormControl();
        this.odometerFlag = false;
        this.filterArr = [];
    }
    ngOnInit() {
        this.currentOrgID = this.storageService.getStorage('currentOrgID');
        this.getVehicleType();
        this.getVehicleCategory();
        this.getUnit();
    }
    SearchFn($event) {
        this.searchValue = $event;
        if (this.searchValue.length > 0) {
            this.searchFlag = true;
        }
        else {
            this.searchFlag = false;
        }
        this.vehicleCategoryFlag = false;
        this.vehicleTypeFlag = false;
        this.refreshBtn.nativeElement.click();
    }
    getVehicleCategory() {
        return __awaiter(this, void 0, void 0, function* () {
            this.vehicleCategoryList = yield this.vehicleService.getVehicleCategory();
            this.vehicleCategoryList.unshift({ id: 'all', name: 'All', keyID: 'all' });
        });
    }
    getVehicleType() {
        return __awaiter(this, void 0, void 0, function* () {
            this.vehicleTypeList = yield this.vehicleService.getVehicleType();
            this.vehicleTypeList.unshift({ id: 'all', name: 'All', keyID: 'all' });
        });
    }
    getUnit() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                this.odometerList = yield this.unitService.getUnitUsingPublicUrl([`type:${UnitTypeKeyID.LENGTH}`]);
            }
            catch (error) {
                console.error(error);
            }
        });
    }
    ngAfterViewInit() {
        merge(this.paginator.page, this.vehicleType.mono, this.vehicleCategory.mono, this.odometer.mono, fromEvent(this.refreshBtn.nativeElement, 'click')).pipe(startWith({}), switchMap(() => {
            this.filterArr = [];
            if (this.vehicleTypeFlag) {
                if (this.vehicleTypeFc.value == 'all') {
                    this.vehicleTypeFlag = false;
                }
                else {
                    this.filterArr.push('vehicleType:' + this.vehicleTypeFc.value);
                }
            }
            if (this.vehicleCategoryFlag) {
                if (this.vehicleCategoryFc.value == 'all') {
                    this.vehicleCategoryFlag = false;
                }
                else {
                    this.filterArr.push('vehicleCategory:' + this.vehicleCategoryFc.value);
                }
            }
            if (this.odometerFlag) {
                if (this.odometerFc.value == 'Select none') {
                    this.odometerFlag = false;
                }
                else {
                    this.filterArr.push('vehicleOdoMeterUnit:' + this.odometerFc.value);
                }
            }
            if (this.searchFlag) {
                this.filterArr.push('searchVehicleName:' + this.searchValue);
            }
            return this.vehicleController.getVehicleByPage(this.paginator.pageIndex, this.paginator.pageSize, this.currentOrgID, this.filterArr).pipe(catchError(() => observableOf(null)));
        }), map((dataSource) => {
            if (dataSource === null) {
                return [];
            }
            this.resultLength = dataSource.totalCount;
            return dataSource.vehicle;
        })).subscribe((dataSource) => (this.dataSource = dataSource));
    }
    bulkUpload() {
        const dialogRef = this.dialog.open(BulkUploadDialogLib, {
            data: { source: "assets/files/vehicle-upload.xlsx" },
            minWidth: "600px",
            maxWidth: "600px",
        });
        dialogRef.afterClosed().subscribe((response) => {
            this.bulkUploadResponse = response;
            if (response) {
                this.vehicleBulkUpload();
            }
        });
    }
    toFormData() {
        const formData = new FormData();
        formData.append('file', this.bulkUploadResponse);
        return formData;
    }
    vehicleBulkUpload() {
        this.vehicleController.vehicleBulkUpload(this.currentOrgID, this.toFormData())
            .subscribe((bulkUploadRes) => {
            if (bulkUploadRes['title'] == 'Success') {
                this.toastrService.openToast(ToastrTitle.SUCCESS, bulkUploadRes['message'], bulkUploadRes['result']);
            }
            else if (bulkUploadRes['title'] == 'Error') {
                this.error = true;
                this.title = bulkUploadRes['title'];
                this.message = bulkUploadRes['message'];
                this.response = bulkUploadRes['response'];
                this.errorDialog(this.title, this.message, this.response);
                this.getErrorData();
            }
        });
    }
    errorDialog(title, message, response) {
        const dialogRef = this.dialog.open(DialogOneComponent, {
            minWidth: '450px',
            maxWidth: '700px',
            data: {
                type: DialogOneEnum.CONFIRMATION,
                icon: 'warning',
                header: title,
                body: message,
                buttonOne: 'Cancel',
                buttonTwo: 'Try again'
            }
        });
        dialogRef.afterClosed()
            .subscribe((result) => {
            if (result) {
                this.bulkUpload();
            }
            else { }
        });
    }
    getErrorData() {
        if (this.response['duplicateDataInRows'].length != 0) {
            let dupDataInRows = this.response['duplicateDataInRows'];
            this.duplicateData = [dupDataInRows.slice(0, -1).join(', '), dupDataInRows.slice(-1)[0]].join(dupDataInRows.length < 2 ? '' : ' and ');
        }
        if (this.response['mandatoryDataMissingInRows'].length != 0) {
            let manDataMissingInRows = this.response['mandatoryDataMissingInRows'];
            this.mandatoryData = [manDataMissingInRows.slice(0, -1).join(', '), manDataMissingInRows.slice(-1)[0]].join(manDataMissingInRows.length < 2 ? '' : ' and ');
        }
    }
    refreshFn() {
        this.vehicleTypeFlag = false;
        this.vehicleCategoryFlag = false;
        this.odometerFlag = false;
        this.refreshBtn.nativeElement.click();
    }
    createUpdateVehicle(actionP, row) {
        let action = actionP;
        let dialogRef;
        let data;
        if (action == FormAction.CREATE) {
            data = {
                action: FormAction.CREATE,
                source: ComponentSourceEnum.DIALOG
            };
        }
        else if (action == FormAction.UPDATE) {
            data = {
                action: FormAction.UPDATE,
                source: ComponentSourceEnum.DIALOG,
                vehicleID: row.id
            };
        }
        dialogRef = this.dialog.open(CreateUpdateComponent, {
            data: data,
            minWidth: '600px',
            maxWidth: '600px',
            height: '100%',
            position: { right: '-2px', top: '0px' },
            panelClass: 'matDialogContainerOverride'
        });
        dialogRef.afterClosed()
            .subscribe((result) => {
            if (result.status == DialogEnum.SUCCESS_DR) {
                this.refreshBtn.nativeElement.click();
            }
        });
    }
}
PageComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: PageComponent, deps: [{ token: i1.MatDialog }, { token: i2.VehicleController }, { token: i3.StorageService }, { token: i4.VehicleService }, { token: i5.UnitService }, { token: i6.ToastrService }], target: i0.ɵɵFactoryTarget.Component });
PageComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.17", type: PageComponent, selector: "app-page", viewQueries: [{ propertyName: "paginator", first: true, predicate: MatPaginator, descendants: true, static: true }, { propertyName: "searchBar", first: true, predicate: ["searchBar"], descendants: true, static: true }, { propertyName: "refreshBtn", first: true, predicate: ["refreshBtn"], descendants: true, static: true }, { propertyName: "vehicleType", first: true, predicate: ["vehicleType"], descendants: true }, { propertyName: "vehicleCategory", first: true, predicate: ["vehicleCategory"], descendants: true }, { propertyName: "odometer", first: true, predicate: ["odometer"], descendants: true }], ngImport: i0, template: "<div class=\"card main-card cardOverwrite h100\">\n    <div class=\"headerContainer\">\n        <div class=\"headerLeftContainer\">\n            <div class=\"pageTitle\">Vehicles</div>\n            <div class=\"pageSubtitle\">Create company owned vehicles to track their emissions.</div>\n        </div>\n        <div class=\"headerRightContainer\">\n            <div class=\"headerRightContainerInner\">\n                <lib-search-bar-one #searchBar [searchBy]=\"'vehicle name'\" (emitSearch)=\"SearchFn($event)\"></lib-search-bar-one>\n            </div>\n            <div class=\"float-end\">\n                <button type=\"button\" class=\"button ms-4 btn btn-success\" (click)=\"createUpdateVehicle(FormAction.CREATE, '')\">\n                    <fa-icon [icon]=\"faPlus\" class=\"me-2\"></fa-icon>Vehicle\n                </button>\n                <div class=\"ms-1 btn-group\" ngbDropdown placement=\"bottom-right\">\n                    <button type=\"button\" ngbDropdownToggle class=\"btn btn-success\">\n                    </button>\n                    <div ngbDropdownMenu>\n                        <button class=\"dropdown-item\" (click)=\"bulkUpload()\">\n                            Import\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <button type=\"button\" class=\"d-none\" #refreshBtn>refresh</button>\n\n    <table mat-table [dataSource]=\"dataSource\" #sort matSort matSortActive=\"employeeID\" matSortDirection=\"desc\"\n        matSortDisableClear>\n\n        <ng-container matColumnDef=\"vehicleNumber\">\n            <th mat-header-cell class=\"col-sm-2 \" *matHeaderCellDef disableClear> Vehicle Number </th>\n            <td mat-cell *matCellDef=\"let row\"> {{ row.vehicleNumber ? row.vehicleNumber : COMMON_CONSTANT.HYPHEN}}\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"vehicleName\">\n            <th mat-header-cell class=\"col-sm-2\" *matHeaderCellDef> Vehicle Name </th>\n            <td mat-cell *matCellDef=\"let row\"> {{row.vehicleName ? row.vehicleName : COMMON_CONSTANT.HYPHEN}}</td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"vehicleType\">\n            <th mat-header-cell class=\"vehicleType\" *matHeaderCellDef disableClear>\n                <funnel-filter #vehicleType header=\"Vehicle Type\" type=\"mono\" value=\"id\" \n                    [entityList]=\"vehicleTypeList\" [selectFC]=\"vehicleTypeFc\" [active]=\"vehicleTypeFlag\"\n                    (mono)=\"vehicleTypeFlag = true;\">\n                </funnel-filter>\n            </th>\n            <td mat-cell *matCellDef=\"let row\"> {{row.vehicleType.name ? row.vehicleType.name : COMMON_CONSTANT.HYPHEN}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"vehicleCategory\">\n            <th mat-header-cell class=\"vehicleCategory\" *matHeaderCellDef disableClear>\n                <funnel-filter #vehicleCategory\n                    header=\"Vehicle Category\" value=\"id\" type=\"mono\" [entityList]=\"vehicleCategoryList\"\n                    [selectFC]=\"vehicleCategoryFc\" [active]=\"vehicleCategoryFlag\"\n                    (mono)=\"vehicleCategoryFlag = true;\"></funnel-filter></th>\n            <td mat-cell *matCellDef=\"let row\"> {{row.vehicleCategory.name ? row.vehicleCategory.name : COMMON_CONSTANT.HYPHEN}}\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"engineStroke\">\n            <th mat-header-cell class=\"col-sm-1\" *matHeaderCellDef> Engine Stroke </th>\n            <td mat-cell *matCellDef=\"let row\"> \n                {{ row.engineStroke ? row.engineStroke.name : COMMON_CONSTANT.HYPHEN }}\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"year\">\n            <th mat-header-cell class=\"col-sm-1\" *matHeaderCellDef> Year </th>\n            <td mat-cell *matCellDef=\"let row;\">\n                {{row.year ? row.year : COMMON_CONSTANT.HYPHEN}}\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"odometer\">\n            <th mat-header-cell class=\"col-sm-1\" *matHeaderCellDef> <funnel-filter #odometer header=\"Odometer\"\n                    type=\"mono\" value=\"id\" view=\"name\" [entityList]=\"odometerList\" [selectFC]=\"odometerFc\"\n                    [active]=\"odometerFlag\" (mono)=\"odometerFlag = true;\"></funnel-filter></th>\n            <td mat-cell *matCellDef=\"let row;\">\n                {{row.odoMeterUnit.uomCode ? row.odoMeterUnit.uomCode : COMMON_CONSTANT.HYPHEN}}\n            </td>\n            <td mat-cell *matCellDef=\"let row;\">\n                {{ row.odoMeterUnit.uomCode ? row.odoMeterUnit.uomName + \" (\" + row.odoMeterUnit.uomCode + \")\" : COMMON_CONSTANT.HYPHEN }}\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"actions\">\n            <th mat-header-cell *matHeaderCellDef></th>\n            <td class=\"text-center\" mat-cell *matCellDef=\"let row\">\n                <div class=\"mt-2 btn-group\" ngbDropdown placement=\"left\">\n                    <button type=\"button\" ngbDropdownToggle class=\"dropdown-after dropdownAfter btn\">\n                        <fa-icon [icon]=\"faEllipsisV\" class=\"me-2\"></fa-icon>\n                    </button>\n                    <div ngbDropdownMenu>\n                        <button class=\"dropdown-item\" (click)=\"createUpdateVehicle(FormAction.UPDATE, row)\">\n                            Edit\n                        </button>\n                    </div>\n                </div>\n            </td>\n        </ng-container>\n\n        <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n        <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n        <tr class=\"mat-row\" *matNoDataRow>\n            <td class=\"mat-cell text-center\" [attr.colspan]=\"displayedColumns.length\">\n                {{ TABLE_CONSTANT.TABLE_NO_DATA }}\n            </td>\n        </tr>\n    </table>\n\n    <mat-paginator class=\"roundedBorder\" #paginator [length]=\"resultLength\"\n        [pageSizeOptions]=\"TABLE_CONSTANT.PAGE_SIZE_OPTION\" [pageSize]=\"TABLE_CONSTANT.DEFAULT_PAGE_SIZE\"\n        showFirstLastButtons>\n    </mat-paginator>\n</div>", styles: [".vehicleType{width:155px}.vehicleCategory{width:150px}\n"], components: [{ type: i7.SearchBarOneComponent, selector: "lib-search-bar-one", inputs: ["type", "searchBy", "clear"], outputs: ["emitSearch"] }, { type: i8.FaIconComponent, selector: "fa-icon", inputs: ["classes", "icon", "title", "spin", "pulse", "mask", "styles", "flip", "size", "pull", "border", "inverse", "symbol", "rotate", "fixedWidth", "transform", "a11yRole"] }, { type: i9.MatTable, selector: "mat-table, table[mat-table]", exportAs: ["matTable"] }, { type: i7.FunnelFilterComponent, selector: "funnel-filter", inputs: ["view", "value", "type", "entityList", "selectFC", "header", "headerWidth", "width", "active"], outputs: ["mono", "multi", "selected"] }, { type: i9.MatHeaderRow, selector: "mat-header-row, tr[mat-header-row]", exportAs: ["matHeaderRow"] }, { type: i9.MatRow, selector: "mat-row, tr[mat-row]", exportAs: ["matRow"] }, { type: i10.MatPaginator, selector: "mat-paginator", inputs: ["disabled"], exportAs: ["matPaginator"] }], directives: [{ type: i11.NgbDropdown, selector: "[ngbDropdown]", inputs: ["autoClose", "dropdownClass", "open", "placement", "container", "display"], outputs: ["openChange"], exportAs: ["ngbDropdown"] }, { type: i11.NgbDropdownToggle, selector: "[ngbDropdownToggle]" }, { type: i11.NgbDropdownMenu, selector: "[ngbDropdownMenu]" }, { type: i9.MatColumnDef, selector: "[matColumnDef]", inputs: ["sticky", "matColumnDef"] }, { type: i9.MatHeaderCellDef, selector: "[matHeaderCellDef]" }, { type: i9.MatHeaderCell, selector: "mat-header-cell, th[mat-header-cell]" }, { type: i9.MatCellDef, selector: "[matCellDef]" }, { type: i9.MatCell, selector: "mat-cell, td[mat-cell]" }, { type: i9.MatHeaderRowDef, selector: "[matHeaderRowDef]", inputs: ["matHeaderRowDef", "matHeaderRowDefSticky"] }, { type: i9.MatRowDef, selector: "[matRowDef]", inputs: ["matRowDefColumns", "matRowDefWhen"] }, { type: i9.MatNoDataRow, selector: "ng-template[matNoDataRow]" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: PageComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'app-page',
                    templateUrl: './page.component.html',
                    styleUrls: ['./page.component.scss']
                }]
        }], ctorParameters: function () { return [{ type: i1.MatDialog }, { type: i2.VehicleController }, { type: i3.StorageService }, { type: i4.VehicleService }, { type: i5.UnitService }, { type: i6.ToastrService }]; }, propDecorators: { paginator: [{
                type: ViewChild,
                args: [MatPaginator, { static: true }]
            }], searchBar: [{
                type: ViewChild,
                args: ['searchBar', { static: true }]
            }], refreshBtn: [{
                type: ViewChild,
                args: ['refreshBtn', { static: true }]
            }], vehicleType: [{
                type: ViewChild,
                args: ['vehicleType']
            }], vehicleCategory: [{
                type: ViewChild,
                args: ['vehicleCategory']
            }], odometer: [{
                type: ViewChild,
                args: ['odometer']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9saWJyYXJ5L25ldHplcm8vc3JjL2xpYi90c2MvY29tcG9uZW50L3ZlaGljbGUvcGFnZS9wYWdlLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2xpYnJhcnkvbmV0emVyby9zcmMvbGliL3RzYy9jb21wb25lbnQvdmVoaWNsZS9wYWdlL3BhZ2UuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQXNCLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN6RSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFM0QsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTdDLE9BQU8sRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLEVBQUUsSUFBSSxZQUFZLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDNUQsT0FBTyxFQUFFLFVBQVUsRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRXZFLE9BQU8sRUFBRSxNQUFNLEVBQVksV0FBVyxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFLbEYsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sMENBQTBDLENBQUM7QUFJakYsT0FBTyxFQUE0QixhQUFhLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUNoRixPQUFPLEVBQWlCLFdBQVcsRUFBZSxNQUFNLHlCQUF5QixDQUFDO0FBQ2xGLE9BQU8sRUFDSCxlQUFlLEVBQ2YsY0FBYyxFQUNkLFVBQVUsRUFDVixtQkFBbUIsRUFDbkIsa0JBQWtCLEVBQ2xCLGFBQWEsRUFFYixtQkFBbUIsRUFDbkIsVUFBVSxFQUNiLE1BQU0scUJBQXFCLENBQUM7Ozs7Ozs7Ozs7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QUFZLHVpQkNyRjNCLDJyTUFzSE07NEZEakZPLGFBQWE7a0JBTHpCLFNBQVM7bUJBQUM7b0JBQ1AsUUFBUSxFQUFFLFVBQVU7b0JBQ3BCLFdBQVcsRUFBRSx1QkFBdUI7b0JBQ3BDLFNBQVMsRUFBRSxDQUFDLHVCQUF1QixDQUFDO2lCQUN2QztnUEFpRDhDLFNBQVM7c0JBQW5ELFNBQVM7dUJBQUMsWUFBWSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtnQkFDQyxTQUFTO3NCQUFsRCxTQUFTO3VCQUFDLFdBQVcsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7Z0JBQ0csVUFBVTtzQkFBcEQsU0FBUzt1QkFBQyxZQUFZLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO2dCQUNmLFdBQVc7c0JBQXBDLFNBQVM7dUJBQUMsYUFBYTtnQkFDTSxlQUFlO3NCQUE1QyxTQUFTO3VCQUFDLGlCQUFpQjtnQkFDTCxRQUFRO3NCQUE5QixTQUFTO3VCQUFDLFVBQVUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEVsZW1lbnRSZWYsIE9uSW5pdCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBNYXRQYWdpbmF0b3IgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9wYWdpbmF0b3InO1xuaW1wb3J0IHsgTWF0RGlhbG9nIH0gZnJvbSBcIkBhbmd1bGFyL21hdGVyaWFsL2RpYWxvZ1wiO1xuaW1wb3J0IHsgRm9ybUNvbnRyb2wgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5cbmltcG9ydCB7IG1lcmdlLCBmcm9tRXZlbnQsIG9mIGFzIG9ic2VydmFibGVPZiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgY2F0Y2hFcnJvciwgbWFwLCBzdGFydFdpdGgsIHN3aXRjaE1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgZmFQbHVzLCBmYVNlYXJjaCwgZmFFbGxpcHNpc1YgfSBmcm9tICdAZm9ydGF3ZXNvbWUvZnJlZS1zb2xpZC1zdmctaWNvbnMnO1xuXG5pbXBvcnQgeyBWZWhpY2xlTSwgVmVoaWNsZVBhZ2VNIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWwvdmVoaWNsZS5tb2RlbCc7XG5pbXBvcnQgeyBWZWhpY2xlQ29udHJvbGxlciB9IGZyb20gJy4uLy4uLy4uL2NvbnRyb2xsZXIvdmVoaWNsZS5jb250cm9sbGVyJztcbmltcG9ydCB7IFZlaGljbGVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZS92ZWhpY2xlLnNlcnZpY2UnO1xuaW1wb3J0IHsgQ3JlYXRlVXBkYXRlQ29tcG9uZW50IH0gZnJvbSAnLi4vY3JlYXRlLXVwZGF0ZS9jcmVhdGUtdXBkYXRlLmNvbXBvbmVudCc7XG5cbi8vdHNjLWxpYnJhcnlcbmltcG9ydCB7IFN0b3JhZ2VTZXJ2aWNlIH0gZnJvbSAnQGxpYnJhcnkvc3RvcmFnZS1zZXJ2aWNlJztcbmltcG9ydCB7IFVuaXRNLCBVbml0LCBVbml0U2VydmljZSwgVW5pdFR5cGVLZXlJRCB9IGZyb20gJ0BsaWJyYXJ5L3VuaXQtc2VydmljZSc7XG5pbXBvcnQgeyBUb2FzdHJTZXJ2aWNlLCBUb2FzdHJUaXRsZSwgVG9hc3RyQ29sb3IgfSBmcm9tICdAbGlicmFyeS90b2FzdHItc2VydmljZSc7XG5pbXBvcnQge1xuICAgIENPTU1PTl9DT05TVEFOVCxcbiAgICBUQUJMRV9DT05TVEFOVCxcbiAgICBGb3JtQWN0aW9uLFxuICAgIEJ1bGtVcGxvYWREaWFsb2dMaWIsXG4gICAgRGlhbG9nT25lQ29tcG9uZW50LFxuICAgIERpYWxvZ09uZUVudW0sXG4gICAgRnVubmVsRmlsdGVyQ29tcG9uZW50LFxuICAgIENvbXBvbmVudFNvdXJjZUVudW0sXG4gICAgRGlhbG9nRW51bVxufSBmcm9tIFwiQGxpYnJhcnkvdHNjLWNvbW1vblwiO1xuLy8gL3RzYy1saWJyYXJ5L1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2FwcC1wYWdlJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vcGFnZS5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vcGFnZS5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIFBhZ2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICAgIENPTU1PTl9DT05TVEFOVCA9IENPTU1PTl9DT05TVEFOVDtcbiAgICBUQUJMRV9DT05TVEFOVCA9IFRBQkxFX0NPTlNUQU5UO1xuICAgIEZvcm1BY3Rpb24gPSBGb3JtQWN0aW9uO1xuXG4gICAgZmFQbHVzID0gZmFQbHVzO1xuICAgIGZhRWxsaXBzaXNWID0gZmFFbGxpcHNpc1Y7XG5cbiAgICBjdXJyZW50T3JnSUQ6IGFueTtcbiAgICBkYXRhU291cmNlOiBhbnk7XG4gICAgcmVzdWx0TGVuZ3RoOiBudW1iZXI7XG4gICAgc2VhcmNoVmFsdWU6IGFueTtcbiAgICBkaXNwbGF5ZWRDb2x1bW5zOiBzdHJpbmdbXSA9IFsndmVoaWNsZU51bWJlcicsICd2ZWhpY2xlTmFtZScsICd2ZWhpY2xlVHlwZScsICd2ZWhpY2xlQ2F0ZWdvcnknLCAnZW5naW5lU3Ryb2tlJywgJ3llYXInLCAnb2RvbWV0ZXInLCAnYWN0aW9ucyddO1xuICAgIHNlYXJjaEZsYWc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGJ1bGtVcGxvYWRSZXNwb25zZTogYW55O1xuICAgIHRpdGxlOiBhbnk7XG4gICAgcmVzcG9uc2U6IGFueTtcbiAgICBtZXNzYWdlOiBhbnk7XG4gICAgZXJyb3I6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBkdXBsaWNhdGVEYXRhOiBzdHJpbmc7XG4gICAgbWFuZGF0b3J5RGF0YTogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgZGlhbG9nOiBNYXREaWFsb2csXG4gICAgICAgIHByaXZhdGUgdmVoaWNsZUNvbnRyb2xsZXI6IFZlaGljbGVDb250cm9sbGVyLFxuICAgICAgICBwcml2YXRlIHN0b3JhZ2VTZXJ2aWNlOiBTdG9yYWdlU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSB2ZWhpY2xlU2VydmljZTogVmVoaWNsZVNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgdW5pdFNlcnZpY2U6IFVuaXRTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIHRvYXN0clNlcnZpY2U6IFRvYXN0clNlcnZpY2VcblxuICAgICkgeyB9XG5cbiAgICB2ZWhpY2xlVHlwZUxpc3Q6IGFueSA9IFtdO1xuICAgIHZlaGljbGVUeXBlRmMgPSBuZXcgRm9ybUNvbnRyb2woKTtcbiAgICB2ZWhpY2xlVHlwZUZsYWcgPSBmYWxzZTtcblxuICAgIHZlaGljbGVDYXRlZ29yeUxpc3Q6IGFueSA9IFtdO1xuICAgIHZlaGljbGVDYXRlZ29yeUZjID0gbmV3IEZvcm1Db250cm9sKCk7XG4gICAgdmVoaWNsZUNhdGVnb3J5RmxhZyA9IGZhbHNlO1xuXG4gICAgb2RvbWV0ZXJMaXN0OiBVbml0TVtdID0gW107XG5cbiAgICBvZG9tZXRlckZjID0gbmV3IEZvcm1Db250cm9sKCk7XG4gICAgb2RvbWV0ZXJGbGFnID0gZmFsc2U7XG5cbiAgICBmaWx0ZXJBcnI6IEFycmF5PHN0cmluZz4gPSBbXTtcblxuICAgIEBWaWV3Q2hpbGQoTWF0UGFnaW5hdG9yLCB7IHN0YXRpYzogdHJ1ZSB9KSBwYWdpbmF0b3I6IE1hdFBhZ2luYXRvcjtcbiAgICBAVmlld0NoaWxkKCdzZWFyY2hCYXInLCB7IHN0YXRpYzogdHJ1ZSB9KSBzZWFyY2hCYXI6IEVsZW1lbnRSZWY7XG4gICAgQFZpZXdDaGlsZCgncmVmcmVzaEJ0bicsIHsgc3RhdGljOiB0cnVlIH0pIHJlZnJlc2hCdG46IEVsZW1lbnRSZWY7XG4gICAgQFZpZXdDaGlsZCgndmVoaWNsZVR5cGUnKSB2ZWhpY2xlVHlwZTogRnVubmVsRmlsdGVyQ29tcG9uZW50O1xuICAgIEBWaWV3Q2hpbGQoJ3ZlaGljbGVDYXRlZ29yeScpIHZlaGljbGVDYXRlZ29yeTogRnVubmVsRmlsdGVyQ29tcG9uZW50O1xuICAgIEBWaWV3Q2hpbGQoJ29kb21ldGVyJykgb2RvbWV0ZXI6IEZ1bm5lbEZpbHRlckNvbXBvbmVudDtcblxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMuY3VycmVudE9yZ0lEID0gdGhpcy5zdG9yYWdlU2VydmljZS5nZXRTdG9yYWdlKCdjdXJyZW50T3JnSUQnKTtcblxuICAgICAgICB0aGlzLmdldFZlaGljbGVUeXBlKCk7XG4gICAgICAgIHRoaXMuZ2V0VmVoaWNsZUNhdGVnb3J5KCk7XG4gICAgICAgIHRoaXMuZ2V0VW5pdCgpO1xuICAgIH1cblxuICAgIFNlYXJjaEZuKCRldmVudCkge1xuICAgICAgICB0aGlzLnNlYXJjaFZhbHVlID0gJGV2ZW50O1xuICAgICAgICBpZiAodGhpcy5zZWFyY2hWYWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaEZsYWcgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZWFyY2hGbGFnID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52ZWhpY2xlQ2F0ZWdvcnlGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMudmVoaWNsZVR5cGVGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMucmVmcmVzaEJ0bi5uYXRpdmVFbGVtZW50LmNsaWNrKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0VmVoaWNsZUNhdGVnb3J5KCkge1xuICAgICAgICB0aGlzLnZlaGljbGVDYXRlZ29yeUxpc3QgPSBhd2FpdCB0aGlzLnZlaGljbGVTZXJ2aWNlLmdldFZlaGljbGVDYXRlZ29yeSgpO1xuICAgICAgICB0aGlzLnZlaGljbGVDYXRlZ29yeUxpc3QudW5zaGlmdCh7IGlkOiAnYWxsJywgbmFtZTogJ0FsbCcsIGtleUlEOiAnYWxsJyB9KVxuICAgIH1cblxuICAgIGFzeW5jIGdldFZlaGljbGVUeXBlKCkge1xuICAgICAgICB0aGlzLnZlaGljbGVUeXBlTGlzdCA9IGF3YWl0IHRoaXMudmVoaWNsZVNlcnZpY2UuZ2V0VmVoaWNsZVR5cGUoKTtcbiAgICAgICAgdGhpcy52ZWhpY2xlVHlwZUxpc3QudW5zaGlmdCh7IGlkOiAnYWxsJywgbmFtZTogJ0FsbCcsIGtleUlEOiAnYWxsJyB9KVxuICAgIH1cblxuICAgIGFzeW5jIGdldFVuaXQoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLm9kb21ldGVyTGlzdCA9IGF3YWl0IHRoaXMudW5pdFNlcnZpY2UuZ2V0VW5pdFVzaW5nUHVibGljVXJsKFtgdHlwZToke1VuaXRUeXBlS2V5SUQuTEVOR1RIfWBdKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgICAgICBtZXJnZShcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdG9yLnBhZ2UsXG4gICAgICAgICAgICB0aGlzLnZlaGljbGVUeXBlLm1vbm8sXG4gICAgICAgICAgICB0aGlzLnZlaGljbGVDYXRlZ29yeS5tb25vLFxuICAgICAgICAgICAgdGhpcy5vZG9tZXRlci5tb25vLFxuICAgICAgICAgICAgZnJvbUV2ZW50KHRoaXMucmVmcmVzaEJ0bi5uYXRpdmVFbGVtZW50LCAnY2xpY2snKVxuICAgICAgICApLnBpcGUoXG4gICAgICAgICAgICBzdGFydFdpdGgoe30pLFxuICAgICAgICAgICAgc3dpdGNoTWFwKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlckFyciA9IFtdO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmVoaWNsZVR5cGVGbGFnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnZlaGljbGVUeXBlRmMudmFsdWUgPT0gJ2FsbCcpIHsgdGhpcy52ZWhpY2xlVHlwZUZsYWcgPSBmYWxzZTsgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHsgdGhpcy5maWx0ZXJBcnIucHVzaCgndmVoaWNsZVR5cGU6JyArIHRoaXMudmVoaWNsZVR5cGVGYy52YWx1ZSk7IH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmVoaWNsZUNhdGVnb3J5RmxhZykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52ZWhpY2xlQ2F0ZWdvcnlGYy52YWx1ZSA9PSAnYWxsJykgeyB0aGlzLnZlaGljbGVDYXRlZ29yeUZsYWcgPSBmYWxzZTsgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHsgdGhpcy5maWx0ZXJBcnIucHVzaCgndmVoaWNsZUNhdGVnb3J5OicgKyB0aGlzLnZlaGljbGVDYXRlZ29yeUZjLnZhbHVlKSB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9kb21ldGVyRmxhZykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vZG9tZXRlckZjLnZhbHVlID09ICdTZWxlY3Qgbm9uZScpIHsgdGhpcy5vZG9tZXRlckZsYWcgPSBmYWxzZTsgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHsgdGhpcy5maWx0ZXJBcnIucHVzaCgndmVoaWNsZU9kb01ldGVyVW5pdDonICsgdGhpcy5vZG9tZXRlckZjLnZhbHVlKSB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlYXJjaEZsYWcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJBcnIucHVzaCgnc2VhcmNoVmVoaWNsZU5hbWU6JyArIHRoaXMuc2VhcmNoVmFsdWUpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmVoaWNsZUNvbnRyb2xsZXIuZ2V0VmVoaWNsZUJ5UGFnZShcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdpbmF0b3IucGFnZUluZGV4LFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2luYXRvci5wYWdlU2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50T3JnSUQsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVyQXJyLFxuICAgICAgICAgICAgICAgICkucGlwZShjYXRjaEVycm9yKCgpID0+IG9ic2VydmFibGVPZihudWxsKSkpO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBtYXAoKGRhdGFTb3VyY2U6IFZlaGljbGVQYWdlTSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhU291cmNlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRMZW5ndGggPSBkYXRhU291cmNlLnRvdGFsQ291bnQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFTb3VyY2UudmVoaWNsZTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICkuc3Vic2NyaWJlKChkYXRhU291cmNlOiBWZWhpY2xlTVtdKSA9PiAodGhpcy5kYXRhU291cmNlID0gZGF0YVNvdXJjZSkpO1xuICAgIH1cblxuICAgIGJ1bGtVcGxvYWQoKSB7XG4gICAgICAgIGNvbnN0IGRpYWxvZ1JlZiA9IHRoaXMuZGlhbG9nLm9wZW4oQnVsa1VwbG9hZERpYWxvZ0xpYiwge1xuICAgICAgICAgICAgZGF0YTogeyBzb3VyY2U6IFwiYXNzZXRzL2ZpbGVzL3ZlaGljbGUtdXBsb2FkLnhsc3hcIiB9LFxuICAgICAgICAgICAgbWluV2lkdGg6IFwiNjAwcHhcIixcbiAgICAgICAgICAgIG1heFdpZHRoOiBcIjYwMHB4XCIsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRpYWxvZ1JlZi5hZnRlckNsb3NlZCgpLnN1YnNjcmliZSgocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgIHRoaXMuYnVsa1VwbG9hZFJlc3BvbnNlID0gcmVzcG9uc2U7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZSkgeyB0aGlzLnZlaGljbGVCdWxrVXBsb2FkKCk7IH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdG9Gb3JtRGF0YSgpOiBGb3JtRGF0YSB7XG4gICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIHRoaXMuYnVsa1VwbG9hZFJlc3BvbnNlKTtcblxuICAgICAgICByZXR1cm4gZm9ybURhdGE7XG4gICAgfVxuXG5cbiAgICB2ZWhpY2xlQnVsa1VwbG9hZCgpIHtcbiAgICAgICAgdGhpcy52ZWhpY2xlQ29udHJvbGxlci52ZWhpY2xlQnVsa1VwbG9hZCh0aGlzLmN1cnJlbnRPcmdJRCwgdGhpcy50b0Zvcm1EYXRhKCkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChidWxrVXBsb2FkUmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGJ1bGtVcGxvYWRSZXNbJ3RpdGxlJ10gPT0gJ1N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9hc3RyU2VydmljZS5vcGVuVG9hc3QoVG9hc3RyVGl0bGUuU1VDQ0VTUywgYnVsa1VwbG9hZFJlc1snbWVzc2FnZSddLCBidWxrVXBsb2FkUmVzWydyZXN1bHQnXSk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJ1bGtVcGxvYWRSZXNbJ3RpdGxlJ10gPT0gJ0Vycm9yJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aXRsZSA9IGJ1bGtVcGxvYWRSZXNbJ3RpdGxlJ11cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gYnVsa1VwbG9hZFJlc1snbWVzc2FnZSddO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3BvbnNlID0gYnVsa1VwbG9hZFJlc1sncmVzcG9uc2UnXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvckRpYWxvZyh0aGlzLnRpdGxlLCB0aGlzLm1lc3NhZ2UsIHRoaXMucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEVycm9yRGF0YSgpO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZXJyb3JEaWFsb2codGl0bGUsIG1lc3NhZ2UsIHJlc3BvbnNlKSB7XG4gICAgICAgIGNvbnN0IGRpYWxvZ1JlZiA9IHRoaXMuZGlhbG9nLm9wZW4oRGlhbG9nT25lQ29tcG9uZW50LCB7XG4gICAgICAgICAgICBtaW5XaWR0aDogJzQ1MHB4JyxcbiAgICAgICAgICAgIG1heFdpZHRoOiAnNzAwcHgnLFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHR5cGU6IERpYWxvZ09uZUVudW0uQ09ORklSTUFUSU9OLFxuICAgICAgICAgICAgICAgIGljb246ICd3YXJuaW5nJyxcbiAgICAgICAgICAgICAgICBoZWFkZXI6IHRpdGxlLFxuICAgICAgICAgICAgICAgIGJvZHk6IG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgYnV0dG9uT25lOiAnQ2FuY2VsJyxcbiAgICAgICAgICAgICAgICBidXR0b25Ud286ICdUcnkgYWdhaW4nXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRpYWxvZ1JlZi5hZnRlckNsb3NlZCgpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnVsa1VwbG9hZCgpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgeyB9XG4gICAgICAgICAgICB9KVxuICAgIH1cblxuICAgIGdldEVycm9yRGF0YSgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVzcG9uc2VbJ2R1cGxpY2F0ZURhdGFJblJvd3MnXS5sZW5ndGggIT0gMCkge1xuICAgICAgICAgICAgbGV0IGR1cERhdGFJblJvd3MgPSB0aGlzLnJlc3BvbnNlWydkdXBsaWNhdGVEYXRhSW5Sb3dzJ107XG4gICAgICAgICAgICB0aGlzLmR1cGxpY2F0ZURhdGEgPSBbZHVwRGF0YUluUm93cy5zbGljZSgwLCAtMSkuam9pbignLCAnKSwgZHVwRGF0YUluUm93cy5zbGljZSgtMSlbMF1dLmpvaW4oZHVwRGF0YUluUm93cy5sZW5ndGggPCAyID8gJycgOiAnIGFuZCAnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZXNwb25zZVsnbWFuZGF0b3J5RGF0YU1pc3NpbmdJblJvd3MnXS5sZW5ndGggIT0gMCkge1xuICAgICAgICAgICAgbGV0IG1hbkRhdGFNaXNzaW5nSW5Sb3dzID0gdGhpcy5yZXNwb25zZVsnbWFuZGF0b3J5RGF0YU1pc3NpbmdJblJvd3MnXTtcbiAgICAgICAgICAgIHRoaXMubWFuZGF0b3J5RGF0YSA9IFttYW5EYXRhTWlzc2luZ0luUm93cy5zbGljZSgwLCAtMSkuam9pbignLCAnKSwgbWFuRGF0YU1pc3NpbmdJblJvd3Muc2xpY2UoLTEpWzBdXS5qb2luKG1hbkRhdGFNaXNzaW5nSW5Sb3dzLmxlbmd0aCA8IDIgPyAnJyA6ICcgYW5kICcpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVmcmVzaEZuKCkge1xuICAgICAgICB0aGlzLnZlaGljbGVUeXBlRmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnZlaGljbGVDYXRlZ29yeUZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5vZG9tZXRlckZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5yZWZyZXNoQnRuLm5hdGl2ZUVsZW1lbnQuY2xpY2soKTtcbiAgICB9XG5cbiAgICBjcmVhdGVVcGRhdGVWZWhpY2xlKGFjdGlvblAsIHJvdykge1xuICAgICAgICBsZXQgYWN0aW9uOiBzdHJpbmcgPSBhY3Rpb25QO1xuICAgICAgICBsZXQgZGlhbG9nUmVmO1xuICAgICAgICBsZXQgZGF0YTogYW55O1xuXG4gICAgICAgIGlmIChhY3Rpb24gPT0gRm9ybUFjdGlvbi5DUkVBVEUpIHtcbiAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiBGb3JtQWN0aW9uLkNSRUFURSxcbiAgICAgICAgICAgICAgICBzb3VyY2U6IENvbXBvbmVudFNvdXJjZUVudW0uRElBTE9HXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09IEZvcm1BY3Rpb24uVVBEQVRFKSB7XG4gICAgICAgICAgICBkYXRhID0ge1xuICAgICAgICAgICAgICAgIGFjdGlvbjogRm9ybUFjdGlvbi5VUERBVEUsXG4gICAgICAgICAgICAgICAgc291cmNlOiBDb21wb25lbnRTb3VyY2VFbnVtLkRJQUxPRyxcbiAgICAgICAgICAgICAgICB2ZWhpY2xlSUQ6IHJvdy5pZFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZGlhbG9nUmVmID0gdGhpcy5kaWFsb2cub3BlbihDcmVhdGVVcGRhdGVDb21wb25lbnQsIHtcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICBtaW5XaWR0aDogJzYwMHB4JyxcbiAgICAgICAgICAgIG1heFdpZHRoOiAnNjAwcHgnLFxuICAgICAgICAgICAgaGVpZ2h0OiAnMTAwJScsXG4gICAgICAgICAgICBwb3NpdGlvbjogeyByaWdodDogJy0ycHgnLCB0b3A6ICcwcHgnIH0sXG4gICAgICAgICAgICBwYW5lbENsYXNzOiAnbWF0RGlhbG9nQ29udGFpbmVyT3ZlcnJpZGUnXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRpYWxvZ1JlZi5hZnRlckNsb3NlZCgpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChyZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09IERpYWxvZ0VudW0uU1VDQ0VTU19EUikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hCdG4ubmF0aXZlRWxlbWVudC5jbGljaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJjYXJkIG1haW4tY2FyZCBjYXJkT3ZlcndyaXRlIGgxMDBcIj5cbiAgICA8ZGl2IGNsYXNzPVwiaGVhZGVyQ29udGFpbmVyXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXJMZWZ0Q29udGFpbmVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwicGFnZVRpdGxlXCI+VmVoaWNsZXM8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwYWdlU3VidGl0bGVcIj5DcmVhdGUgY29tcGFueSBvd25lZCB2ZWhpY2xlcyB0byB0cmFjayB0aGVpciBlbWlzc2lvbnMuPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaGVhZGVyUmlnaHRDb250YWluZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXJSaWdodENvbnRhaW5lcklubmVyXCI+XG4gICAgICAgICAgICAgICAgPGxpYi1zZWFyY2gtYmFyLW9uZSAjc2VhcmNoQmFyIFtzZWFyY2hCeV09XCIndmVoaWNsZSBuYW1lJ1wiIChlbWl0U2VhcmNoKT1cIlNlYXJjaEZuKCRldmVudClcIj48L2xpYi1zZWFyY2gtYmFyLW9uZT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZsb2F0LWVuZFwiPlxuICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnV0dG9uIG1zLTQgYnRuIGJ0bi1zdWNjZXNzXCIgKGNsaWNrKT1cImNyZWF0ZVVwZGF0ZVZlaGljbGUoRm9ybUFjdGlvbi5DUkVBVEUsICcnKVwiPlxuICAgICAgICAgICAgICAgICAgICA8ZmEtaWNvbiBbaWNvbl09XCJmYVBsdXNcIiBjbGFzcz1cIm1lLTJcIj48L2ZhLWljb24+VmVoaWNsZVxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtcy0xIGJ0bi1ncm91cFwiIG5nYkRyb3Bkb3duIHBsYWNlbWVudD1cImJvdHRvbS1yaWdodFwiPlxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBuZ2JEcm9wZG93blRvZ2dsZSBjbGFzcz1cImJ0biBidG4tc3VjY2Vzc1wiPlxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBuZ2JEcm9wZG93bk1lbnU+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiZHJvcGRvd24taXRlbVwiIChjbGljayk9XCJidWxrVXBsb2FkKClcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbXBvcnRcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cblxuICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiZC1ub25lXCIgI3JlZnJlc2hCdG4+cmVmcmVzaDwvYnV0dG9uPlxuXG4gICAgPHRhYmxlIG1hdC10YWJsZSBbZGF0YVNvdXJjZV09XCJkYXRhU291cmNlXCIgI3NvcnQgbWF0U29ydCBtYXRTb3J0QWN0aXZlPVwiZW1wbG95ZWVJRFwiIG1hdFNvcnREaXJlY3Rpb249XCJkZXNjXCJcbiAgICAgICAgbWF0U29ydERpc2FibGVDbGVhcj5cblxuICAgICAgICA8bmctY29udGFpbmVyIG1hdENvbHVtbkRlZj1cInZlaGljbGVOdW1iZXJcIj5cbiAgICAgICAgICAgIDx0aCBtYXQtaGVhZGVyLWNlbGwgY2xhc3M9XCJjb2wtc20tMiBcIiAqbWF0SGVhZGVyQ2VsbERlZiBkaXNhYmxlQ2xlYXI+IFZlaGljbGUgTnVtYmVyIDwvdGg+XG4gICAgICAgICAgICA8dGQgbWF0LWNlbGwgKm1hdENlbGxEZWY9XCJsZXQgcm93XCI+IHt7IHJvdy52ZWhpY2xlTnVtYmVyID8gcm93LnZlaGljbGVOdW1iZXIgOiBDT01NT05fQ09OU1RBTlQuSFlQSEVOfX1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICAgIDxuZy1jb250YWluZXIgbWF0Q29sdW1uRGVmPVwidmVoaWNsZU5hbWVcIj5cbiAgICAgICAgICAgIDx0aCBtYXQtaGVhZGVyLWNlbGwgY2xhc3M9XCJjb2wtc20tMlwiICptYXRIZWFkZXJDZWxsRGVmPiBWZWhpY2xlIE5hbWUgPC90aD5cbiAgICAgICAgICAgIDx0ZCBtYXQtY2VsbCAqbWF0Q2VsbERlZj1cImxldCByb3dcIj4ge3tyb3cudmVoaWNsZU5hbWUgPyByb3cudmVoaWNsZU5hbWUgOiBDT01NT05fQ09OU1RBTlQuSFlQSEVOfX08L3RkPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgICAgICA8bmctY29udGFpbmVyIG1hdENvbHVtbkRlZj1cInZlaGljbGVUeXBlXCI+XG4gICAgICAgICAgICA8dGggbWF0LWhlYWRlci1jZWxsIGNsYXNzPVwidmVoaWNsZVR5cGVcIiAqbWF0SGVhZGVyQ2VsbERlZiBkaXNhYmxlQ2xlYXI+XG4gICAgICAgICAgICAgICAgPGZ1bm5lbC1maWx0ZXIgI3ZlaGljbGVUeXBlIGhlYWRlcj1cIlZlaGljbGUgVHlwZVwiIHR5cGU9XCJtb25vXCIgdmFsdWU9XCJpZFwiIFxuICAgICAgICAgICAgICAgICAgICBbZW50aXR5TGlzdF09XCJ2ZWhpY2xlVHlwZUxpc3RcIiBbc2VsZWN0RkNdPVwidmVoaWNsZVR5cGVGY1wiIFthY3RpdmVdPVwidmVoaWNsZVR5cGVGbGFnXCJcbiAgICAgICAgICAgICAgICAgICAgKG1vbm8pPVwidmVoaWNsZVR5cGVGbGFnID0gdHJ1ZTtcIj5cbiAgICAgICAgICAgICAgICA8L2Z1bm5lbC1maWx0ZXI+XG4gICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgPHRkIG1hdC1jZWxsICptYXRDZWxsRGVmPVwibGV0IHJvd1wiPiB7e3Jvdy52ZWhpY2xlVHlwZS5uYW1lID8gcm93LnZlaGljbGVUeXBlLm5hbWUgOiBDT01NT05fQ09OU1RBTlQuSFlQSEVOfX0gPC90ZD5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgPG5nLWNvbnRhaW5lciBtYXRDb2x1bW5EZWY9XCJ2ZWhpY2xlQ2F0ZWdvcnlcIj5cbiAgICAgICAgICAgIDx0aCBtYXQtaGVhZGVyLWNlbGwgY2xhc3M9XCJ2ZWhpY2xlQ2F0ZWdvcnlcIiAqbWF0SGVhZGVyQ2VsbERlZiBkaXNhYmxlQ2xlYXI+XG4gICAgICAgICAgICAgICAgPGZ1bm5lbC1maWx0ZXIgI3ZlaGljbGVDYXRlZ29yeVxuICAgICAgICAgICAgICAgICAgICBoZWFkZXI9XCJWZWhpY2xlIENhdGVnb3J5XCIgdmFsdWU9XCJpZFwiIHR5cGU9XCJtb25vXCIgW2VudGl0eUxpc3RdPVwidmVoaWNsZUNhdGVnb3J5TGlzdFwiXG4gICAgICAgICAgICAgICAgICAgIFtzZWxlY3RGQ109XCJ2ZWhpY2xlQ2F0ZWdvcnlGY1wiIFthY3RpdmVdPVwidmVoaWNsZUNhdGVnb3J5RmxhZ1wiXG4gICAgICAgICAgICAgICAgICAgIChtb25vKT1cInZlaGljbGVDYXRlZ29yeUZsYWcgPSB0cnVlO1wiPjwvZnVubmVsLWZpbHRlcj48L3RoPlxuICAgICAgICAgICAgPHRkIG1hdC1jZWxsICptYXRDZWxsRGVmPVwibGV0IHJvd1wiPiB7e3Jvdy52ZWhpY2xlQ2F0ZWdvcnkubmFtZSA/IHJvdy52ZWhpY2xlQ2F0ZWdvcnkubmFtZSA6IENPTU1PTl9DT05TVEFOVC5IWVBIRU59fVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgPG5nLWNvbnRhaW5lciBtYXRDb2x1bW5EZWY9XCJlbmdpbmVTdHJva2VcIj5cbiAgICAgICAgICAgIDx0aCBtYXQtaGVhZGVyLWNlbGwgY2xhc3M9XCJjb2wtc20tMVwiICptYXRIZWFkZXJDZWxsRGVmPiBFbmdpbmUgU3Ryb2tlIDwvdGg+XG4gICAgICAgICAgICA8dGQgbWF0LWNlbGwgKm1hdENlbGxEZWY9XCJsZXQgcm93XCI+IFxuICAgICAgICAgICAgICAgIHt7IHJvdy5lbmdpbmVTdHJva2UgPyByb3cuZW5naW5lU3Ryb2tlLm5hbWUgOiBDT01NT05fQ09OU1RBTlQuSFlQSEVOIH19XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgICAgICA8bmctY29udGFpbmVyIG1hdENvbHVtbkRlZj1cInllYXJcIj5cbiAgICAgICAgICAgIDx0aCBtYXQtaGVhZGVyLWNlbGwgY2xhc3M9XCJjb2wtc20tMVwiICptYXRIZWFkZXJDZWxsRGVmPiBZZWFyIDwvdGg+XG4gICAgICAgICAgICA8dGQgbWF0LWNlbGwgKm1hdENlbGxEZWY9XCJsZXQgcm93O1wiPlxuICAgICAgICAgICAgICAgIHt7cm93LnllYXIgPyByb3cueWVhciA6IENPTU1PTl9DT05TVEFOVC5IWVBIRU59fVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgPG5nLWNvbnRhaW5lciBtYXRDb2x1bW5EZWY9XCJvZG9tZXRlclwiPlxuICAgICAgICAgICAgPHRoIG1hdC1oZWFkZXItY2VsbCBjbGFzcz1cImNvbC1zbS0xXCIgKm1hdEhlYWRlckNlbGxEZWY+IDxmdW5uZWwtZmlsdGVyICNvZG9tZXRlciBoZWFkZXI9XCJPZG9tZXRlclwiXG4gICAgICAgICAgICAgICAgICAgIHR5cGU9XCJtb25vXCIgdmFsdWU9XCJpZFwiIHZpZXc9XCJuYW1lXCIgW2VudGl0eUxpc3RdPVwib2RvbWV0ZXJMaXN0XCIgW3NlbGVjdEZDXT1cIm9kb21ldGVyRmNcIlxuICAgICAgICAgICAgICAgICAgICBbYWN0aXZlXT1cIm9kb21ldGVyRmxhZ1wiIChtb25vKT1cIm9kb21ldGVyRmxhZyA9IHRydWU7XCI+PC9mdW5uZWwtZmlsdGVyPjwvdGg+XG4gICAgICAgICAgICA8dGQgbWF0LWNlbGwgKm1hdENlbGxEZWY9XCJsZXQgcm93O1wiPlxuICAgICAgICAgICAgICAgIHt7cm93Lm9kb01ldGVyVW5pdC51b21Db2RlID8gcm93Lm9kb01ldGVyVW5pdC51b21Db2RlIDogQ09NTU9OX0NPTlNUQU5ULkhZUEhFTn19XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIG1hdC1jZWxsICptYXRDZWxsRGVmPVwibGV0IHJvdztcIj5cbiAgICAgICAgICAgICAgICB7eyByb3cub2RvTWV0ZXJVbml0LnVvbUNvZGUgPyByb3cub2RvTWV0ZXJVbml0LnVvbU5hbWUgKyBcIiAoXCIgKyByb3cub2RvTWV0ZXJVbml0LnVvbUNvZGUgKyBcIilcIiA6IENPTU1PTl9DT05TVEFOVC5IWVBIRU4gfX1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICAgIDxuZy1jb250YWluZXIgbWF0Q29sdW1uRGVmPVwiYWN0aW9uc1wiPlxuICAgICAgICAgICAgPHRoIG1hdC1oZWFkZXItY2VsbCAqbWF0SGVhZGVyQ2VsbERlZj48L3RoPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwidGV4dC1jZW50ZXJcIiBtYXQtY2VsbCAqbWF0Q2VsbERlZj1cImxldCByb3dcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibXQtMiBidG4tZ3JvdXBcIiBuZ2JEcm9wZG93biBwbGFjZW1lbnQ9XCJsZWZ0XCI+XG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIG5nYkRyb3Bkb3duVG9nZ2xlIGNsYXNzPVwiZHJvcGRvd24tYWZ0ZXIgZHJvcGRvd25BZnRlciBidG5cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxmYS1pY29uIFtpY29uXT1cImZhRWxsaXBzaXNWXCIgY2xhc3M9XCJtZS0yXCI+PC9mYS1pY29uPlxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBuZ2JEcm9wZG93bk1lbnU+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiZHJvcGRvd24taXRlbVwiIChjbGljayk9XCJjcmVhdGVVcGRhdGVWZWhpY2xlKEZvcm1BY3Rpb24uVVBEQVRFLCByb3cpXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRWRpdFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgPHRyIG1hdC1oZWFkZXItcm93ICptYXRIZWFkZXJSb3dEZWY9XCJkaXNwbGF5ZWRDb2x1bW5zXCI+PC90cj5cbiAgICAgICAgPHRyIG1hdC1yb3cgKm1hdFJvd0RlZj1cImxldCByb3c7IGNvbHVtbnM6IGRpc3BsYXllZENvbHVtbnM7XCI+PC90cj5cbiAgICAgICAgPHRyIGNsYXNzPVwibWF0LXJvd1wiICptYXROb0RhdGFSb3c+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJtYXQtY2VsbCB0ZXh0LWNlbnRlclwiIFthdHRyLmNvbHNwYW5dPVwiZGlzcGxheWVkQ29sdW1ucy5sZW5ndGhcIj5cbiAgICAgICAgICAgICAgICB7eyBUQUJMRV9DT05TVEFOVC5UQUJMRV9OT19EQVRBIH19XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICA8L3RyPlxuICAgIDwvdGFibGU+XG5cbiAgICA8bWF0LXBhZ2luYXRvciBjbGFzcz1cInJvdW5kZWRCb3JkZXJcIiAjcGFnaW5hdG9yIFtsZW5ndGhdPVwicmVzdWx0TGVuZ3RoXCJcbiAgICAgICAgW3BhZ2VTaXplT3B0aW9uc109XCJUQUJMRV9DT05TVEFOVC5QQUdFX1NJWkVfT1BUSU9OXCIgW3BhZ2VTaXplXT1cIlRBQkxFX0NPTlNUQU5ULkRFRkFVTFRfUEFHRV9TSVpFXCJcbiAgICAgICAgc2hvd0ZpcnN0TGFzdEJ1dHRvbnM+XG4gICAgPC9tYXQtcGFnaW5hdG9yPlxuPC9kaXY+Il19