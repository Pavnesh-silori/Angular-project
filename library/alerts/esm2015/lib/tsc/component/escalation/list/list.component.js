import { Component } from '@angular/core';
import { EscalationLevelCount, EscalationLevelInfo } from '../../../model/escalation.model';
import { CreateUpdateEscalationComponent } from '../../escalation/create-update/create-update.component';
import { ButtonLabelEnum, COMMON_CONSTANT, DialogEnum, DialogOneComponent, DialogOneEnum, MATERIAL_CONSTANT, PageTitleEnum } from '@library/tsc-common';
import * as i0 from "@angular/core";
import * as i1 from "@angular/material/dialog";
import * as i2 from "@angular/router";
import * as i3 from "../../../controller/escalation.controller";
import * as i4 from "@library/storage-service";
import * as i5 from "@library/toastr-service";
import * as i6 from "@angular/material/card";
import * as i7 from "@angular/common";
import * as i8 from "@angular/flex-layout/flex";
import * as i9 from "@angular/material/tooltip";
// /tsc-library/
export class ListComponent {
    constructor(dialog, activatedRoute, escalationController, 
    // tsc-library
    storageService, toastrService
    // /tsc-library/
    ) {
        this.dialog = dialog;
        this.activatedRoute = activatedRoute;
        this.escalationController = escalationController;
        this.storageService = storageService;
        this.toastrService = toastrService;
        this.COMMON_CONSTANT = COMMON_CONSTANT;
        this.MATERIAL_CONSTANT = MATERIAL_CONSTANT;
        this.ButtonLabelEnum = ButtonLabelEnum;
        this.PageTitleEnum = PageTitleEnum;
        this.DialogEnum = DialogEnum;
        this.escalationLevelJSON = [];
        this.escalationLevelCountM = new EscalationLevelCount();
        this.escalationLevelInfoM = [new EscalationLevelInfo()];
    }
    ngOnInit() {
        this.orgID = this.storageService.getStorage('currentOrgID');
        this.getEscalationLevelCount();
        this.activatedRoute.params.subscribe((pathParam) => {
            if (pathParam.alertID != null) {
                this.alertRuleID = pathParam.alertID;
            }
        });
        this.getAllLevelEscalation();
    }
    getEscalationLevelCount() {
        this.escalationController.getEscalationLevelCount(this.orgID).subscribe((escalationLevelCountRes) => {
            this.escalationLevelCountM = escalationLevelCountRes;
            if (this.escalationLevelCountM.level && this.escalationLevelCountM != null) {
                this.escalationLevelJSON = this.getEscalationLevelJSON(this.escalationLevelCountM);
            }
        }, error => {
            console.log('error in getEscalationLevelCount() -', error);
        });
    }
    getAllLevelEscalation() {
        this.escalationController.getAllLevelEscalation(this.orgID, this.alertRuleID).subscribe((escalationLevelRes) => {
            this.escalationLevelInfoM = escalationLevelRes;
        }, error => {
            console.log('error in getAllLevelEscalation() -', error);
        });
    }
    getEscalationLevelJSON(escalationLevel) {
        const levelsArray = [];
        for (let i = 1; i <= escalationLevel.level; i++) {
            levelsArray.push({
                id: i,
                name: `Level ${i}`
            });
        }
        return levelsArray;
    }
    isLevelConfigured(levelId) {
        var _a;
        return (_a = this.escalationLevelInfoM) === null || _a === void 0 ? void 0 : _a.some(level => level.level == levelId);
    }
    getCorresondingEscLevelConfig(levelId) {
        var _a;
        return (_a = this.escalationLevelInfoM) === null || _a === void 0 ? void 0 : _a.find(level => level.level == levelId);
    }
    hasEscalationDataForPreviousLevel(levelId) {
        return levelId > 1 && this.hasEscalationDataForLevel(levelId - 1);
    }
    hasEscalationDataForLevel(levelId) {
        var _a;
        const escalationData = (_a = this.escalationLevelInfoM) === null || _a === void 0 ? void 0 : _a.find(level => level.level == levelId);
        return !!escalationData;
    }
    createUpdateEscalationRuleDialog(levelID, action, escLevelConfig) {
        const dialog = this.dialog.open(CreateUpdateEscalationComponent, {
            data: {
                alertRuleID: this.alertRuleID,
                levelID: levelID,
                action: action,
                escLevelConfig: escLevelConfig
            },
            minWidth: '50vw',
            maxWidth: '50vw',
            height: '100%',
            position: { right: '-2px', top: '0px' }
        });
        dialog.afterClosed().subscribe((result) => {
            if (result == DialogEnum.SUCCESS_DR) {
                this.getAllLevelEscalation();
            }
        });
    }
    openDeleteEscRuleDialog(levelID, escLevelConfig) {
        const escalationRuleID = escLevelConfig.escalationRuleID;
        const dialog = this.dialog.open(DialogOneComponent, {
            minWidth: '500px',
            maxWidth: '500px',
            data: {
                type: DialogOneEnum.DELETE,
                icon: 'dangerous',
                header: 'Delete escalation ?',
                body: 'Escalation configuration for level ' + '<b>' + levelID + '</b>' + ' will be deleted permanently.</br></br>Are you sure you want to continue?',
                buttonOne: ButtonLabelEnum.CANCEL_BTN_LABEL,
                buttonTwo: ButtonLabelEnum.DELETE_BTN_LABEL
            }
        });
        dialog.afterClosed().subscribe(res => {
            if (res) {
                this.deleteEscalationRuleDialog(escalationRuleID);
            }
        });
    }
    deleteEscalationRuleDialog(escalationRuleID) {
        this.escalationController.deleteEsclationByLevelID(this.orgID, escalationRuleID).subscribe((deleteRes) => {
            window.location.reload();
            let toast = this.toastrService.getToastStatus(deleteRes.status);
            this.toastrService.openToast(toast.title, deleteRes.message, toast.color);
        });
    }
}
ListComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: ListComponent, deps: [{ token: i1.MatDialog }, { token: i2.ActivatedRoute }, { token: i3.EscalationController }, { token: i4.StorageService }, { token: i5.ToastrService }], target: i0.ɵɵFactoryTarget.Component });
ListComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.17", type: ListComponent, selector: "lib-list", ngImport: i0, template: "<div class=\"card main-card cardOverwrite h100\">\n    <div class=\"headerContainer\">\n        <div class=\"headerLeftContainer\">\n            <div class=\"pageTitle\">Escalation Rule</div>\n        </div>\n    </div>\n\n    <div class=\"card-body\">\n        <div class=\"row mb-3\" *ngFor=\"let level of escalationLevelJSON\">\n            <div class=\"col-sm-12\">\n                <mat-card class=\"border cardOverwrite\">\n                    <div class=\"row\">\n                        <div class=\"col-sm-8\">\n                            <div class=\"cardTitle\">\n                                {{ level.name }}\n                            </div>\n                            <div class=\"col-sm-12\">\n                                <span class=\"text-danger\" *ngIf=\"!isLevelConfigured(level.id)\">\n                                    Not configured.\n                                </span>\n                                <span *ngIf=\"isLevelConfigured(level.id)\">\n                                    <div fxLayout=\"row wrap\">\n                                        <div class=\"col-sm-3\">\n                                            <div>Escalations:</div>\n                                            <div></div>\n                                        </div>\n                                        <div class=\"col-sm-4\">\n                                            <div>Interval</div>\n                                            <div class=\"fw-bold\">{{\n                                                getCorresondingEscLevelConfig(level.id)?.intervalValue}} - {{\n                                                getCorresondingEscLevelConfig(level.id)?.intervalFrequencyName}}</div>\n                                        </div>\n                                        <div class=\"col-sm-4\">\n                                            <div>Notification frequency</div>\n                                            <div class=\"fw-bold\">{{\n                                                getCorresondingEscLevelConfig(level.id)?.notificationPrefValue}}\n                                                - {{ getCorresondingEscLevelConfig(level.id)?.notificationPrefName}}\n                                            </div>\n                                        </div>\n                                    </div>\n                                </span>\n                            </div>\n                        </div>\n                        <div class=\"col-sm-4 centerAlignVertical justify-content-end\">\n                            <button class=\"btn btn-sm btn-success\" type=\"button\"\n                                (click)=\"createUpdateEscalationRuleDialog(level.id, PageTitleEnum.CREATE)\"\n                                *ngIf=\"!isLevelConfigured(level.id) && (level.id == 1 || (hasEscalationDataForPreviousLevel(level.id) && !hasEscalationDataForLevel(level.id)))\">\n                                {{ ButtonLabelEnum.CREATE_BTN_LABEL }}\n                            </button>\n                            <button class=\"btn btn-sm btn-secondary disableButton\" matTooltipPosition=\"above\"\n                                [matTooltip]=\"'Setting up a previous level is mandatory before creating the escalation metric for the current level'\"\n                                *ngIf=\"!isLevelConfigured(level.id) && level.id != 1 && (hasEscalationDataForLevel(level.id) || !hasEscalationDataForPreviousLevel(level.id))\">\n                                {{ ButtonLabelEnum.CREATE_BTN_LABEL }}\n                            </button>\n                            <button class=\"btn btn-sm btn-primary me-2\" type=\"button\"\n                                (click)=\"createUpdateEscalationRuleDialog(level.id, PageTitleEnum.UPDATE, getCorresondingEscLevelConfig(level.id))\"\n                                *ngIf=\"isLevelConfigured(level.id)\">\n                                {{ ButtonLabelEnum.UPDATE_BTN_LABEL }}\n                            </button>\n                            <button class=\"btn btn-sm btn-danger\" type=\"button\"\n                                (click)=\"openDeleteEscRuleDialog(level.id, getCorresondingEscLevelConfig(level.id))\"\n                                *ngIf=\"isLevelConfigured(level.id)\">\n                                {{ ButtonLabelEnum.DELETE_BTN_LABEL }}\n                            </button>\n                        </div>\n                    </div>\n                </mat-card>\n            </div>\n        </div>\n    </div>\n</div>", styles: [".disableButton{cursor:not-allowed;background-color:#b5b2b2;border-color:#b5b2b2;color:#fff}\n"], components: [{ type: i6.MatCard, selector: "mat-card", exportAs: ["matCard"] }], directives: [{ type: i7.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i7.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i8.DefaultLayoutDirective, selector: "  [fxLayout], [fxLayout.xs], [fxLayout.sm], [fxLayout.md],  [fxLayout.lg], [fxLayout.xl], [fxLayout.lt-sm], [fxLayout.lt-md],  [fxLayout.lt-lg], [fxLayout.lt-xl], [fxLayout.gt-xs], [fxLayout.gt-sm],  [fxLayout.gt-md], [fxLayout.gt-lg]", inputs: ["fxLayout", "fxLayout.xs", "fxLayout.sm", "fxLayout.md", "fxLayout.lg", "fxLayout.xl", "fxLayout.lt-sm", "fxLayout.lt-md", "fxLayout.lt-lg", "fxLayout.lt-xl", "fxLayout.gt-xs", "fxLayout.gt-sm", "fxLayout.gt-md", "fxLayout.gt-lg"] }, { type: i9.MatTooltip, selector: "[matTooltip]", exportAs: ["matTooltip"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: ListComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'lib-list',
                    templateUrl: './list.component.html',
                    styleUrls: ['./list.component.scss']
                }]
        }], ctorParameters: function () { return [{ type: i1.MatDialog }, { type: i2.ActivatedRoute }, { type: i3.EscalationController }, { type: i4.StorageService }, { type: i5.ToastrService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9saWJyYXJ5L2FsZXJ0cy9zcmMvbGliL3RzYy9jb21wb25lbnQvZXNjYWxhdGlvbi9saXN0L2xpc3QuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbGlicmFyeS9hbGVydHMvc3JjL2xpYi90c2MvY29tcG9uZW50L2VzY2FsYXRpb24vbGlzdC9saXN0LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsTUFBTSxlQUFlLENBQUM7QUFLbEQsT0FBTyxFQUFFLG9CQUFvQixFQUF5QixtQkFBbUIsRUFBd0IsTUFBTSxpQ0FBaUMsQ0FBQztBQUl6SSxPQUFPLEVBQUUsK0JBQStCLEVBQUUsTUFBTSx3REFBd0QsQ0FBQztBQUt6RyxPQUFPLEVBQUUsZUFBZSxFQUFFLGVBQWUsRUFBRSxVQUFVLEVBQUUsa0JBQWtCLEVBQUUsYUFBYSxFQUFFLGlCQUFpQixFQUFFLGFBQWEsRUFBYSxNQUFNLHFCQUFxQixDQUFDOzs7Ozs7Ozs7OztBQUNuSyxnQkFBZ0I7QUFRaEIsTUFBTSxPQUFPLGFBQWE7SUFpQnRCLFlBQ1ksTUFBaUIsRUFDakIsY0FBOEIsRUFDOUIsb0JBQTBDO0lBRWxELGNBQWM7SUFDTixjQUE4QixFQUM5QixhQUE0QjtJQUNwQyxnQkFBZ0I7O1FBUFIsV0FBTSxHQUFOLE1BQU0sQ0FBVztRQUNqQixtQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFDOUIseUJBQW9CLEdBQXBCLG9CQUFvQixDQUFzQjtRQUcxQyxtQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFDOUIsa0JBQWEsR0FBYixhQUFhLENBQWU7UUF0QnhDLG9CQUFlLEdBQUcsZUFBZSxDQUFDO1FBQ2xDLHNCQUFpQixHQUFHLGlCQUFpQixDQUFDO1FBRXRDLG9CQUFl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QiwyOUlBc0VNOzRGRC9DTyxhQUFhO2tCQU56QixTQUFTO21CQUFDO29CQUNQLFFBQVEsRUFBRSxVQUFVO29CQUNwQixXQUFXLEVBQUUsdUJBQXVCO29CQUNwQyxTQUFTLEVBQUUsQ0FBQyx1QkFBdUIsQ0FBQztpQkFDdkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQWN0aXZhdGVkUm91dGUgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuXG5pbXBvcnQgeyBNYXREaWFsb2cgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9kaWFsb2cnO1xuXG5pbXBvcnQgeyBFc2NhbGF0aW9uTGV2ZWxDb3VudCwgRXNjYWxhdGlvbkxldmVsQ291bnRNLCBFc2NhbGF0aW9uTGV2ZWxJbmZvLCBFc2NhbGF0aW9uTGV2ZWxJbmZvTSB9IGZyb20gJy4uLy4uLy4uL21vZGVsL2VzY2FsYXRpb24ubW9kZWwnO1xuXG5pbXBvcnQgeyBFc2NhbGF0aW9uQ29udHJvbGxlciB9IGZyb20gJy4uLy4uLy4uL2NvbnRyb2xsZXIvZXNjYWxhdGlvbi5jb250cm9sbGVyJztcblxuaW1wb3J0IHsgQ3JlYXRlVXBkYXRlRXNjYWxhdGlvbkNvbXBvbmVudCB9IGZyb20gJy4uLy4uL2VzY2FsYXRpb24vY3JlYXRlLXVwZGF0ZS9jcmVhdGUtdXBkYXRlLmNvbXBvbmVudCc7XG5cbi8vIHRzYy1saWJyYXJ5XG5pbXBvcnQgeyBTdG9yYWdlU2VydmljZSB9IGZyb20gJ0BsaWJyYXJ5L3N0b3JhZ2Utc2VydmljZSc7XG5pbXBvcnQgeyBUb2FzdHJTZXJ2aWNlIH0gZnJvbSAnQGxpYnJhcnkvdG9hc3RyLXNlcnZpY2UnO1xuaW1wb3J0IHsgQnV0dG9uTGFiZWxFbnVtLCBDT01NT05fQ09OU1RBTlQsIERpYWxvZ0VudW0sIERpYWxvZ09uZUNvbXBvbmVudCwgRGlhbG9nT25lRW51bSwgTUFURVJJQUxfQ09OU1RBTlQsIFBhZ2VUaXRsZUVudW0sIFJlc3BvbnNlTSB9IGZyb20gJ0BsaWJyYXJ5L3RzYy1jb21tb24nO1xuLy8gL3RzYy1saWJyYXJ5L1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2xpYi1saXN0JyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vbGlzdC5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vbGlzdC5jb21wb25lbnQuc2NzcyddXG59KVxuXG5leHBvcnQgY2xhc3MgTGlzdENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG5cbiAgICBDT01NT05fQ09OU1RBTlQgPSBDT01NT05fQ09OU1RBTlQ7XG4gICAgTUFURVJJQUxfQ09OU1RBTlQgPSBNQVRFUklBTF9DT05TVEFOVDtcblxuICAgIEJ1dHRvbkxhYmVsRW51bSA9IEJ1dHRvbkxhYmVsRW51bTtcbiAgICBQYWdlVGl0bGVFbnVtID0gUGFnZVRpdGxlRW51bTtcbiAgICBEaWFsb2dFbnVtID0gRGlhbG9nRW51bTtcblxuICAgIG9yZ0lEOiBhbnk7XG4gICAgYWxlcnRSdWxlSUQ6IGFueTtcblxuICAgIGVzY2FsYXRpb25MZXZlbEpTT046IGFueVtdID0gW107XG5cbiAgICBlc2NhbGF0aW9uTGV2ZWxDb3VudE0gPSBuZXcgRXNjYWxhdGlvbkxldmVsQ291bnQoKTtcbiAgICBlc2NhbGF0aW9uTGV2ZWxJbmZvTSA9IFtuZXcgRXNjYWxhdGlvbkxldmVsSW5mbygpXTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGRpYWxvZzogTWF0RGlhbG9nLFxuICAgICAgICBwcml2YXRlIGFjdGl2YXRlZFJvdXRlOiBBY3RpdmF0ZWRSb3V0ZSxcbiAgICAgICAgcHJpdmF0ZSBlc2NhbGF0aW9uQ29udHJvbGxlcjogRXNjYWxhdGlvbkNvbnRyb2xsZXIsXG5cbiAgICAgICAgLy8gdHNjLWxpYnJhcnlcbiAgICAgICAgcHJpdmF0ZSBzdG9yYWdlU2VydmljZTogU3RvcmFnZVNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgdG9hc3RyU2VydmljZTogVG9hc3RyU2VydmljZVxuICAgICAgICAvLyAvdHNjLWxpYnJhcnkvXG4gICAgKSB7IH1cblxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLm9yZ0lEID0gdGhpcy5zdG9yYWdlU2VydmljZS5nZXRTdG9yYWdlKCdjdXJyZW50T3JnSUQnKTtcblxuICAgICAgICB0aGlzLmdldEVzY2FsYXRpb25MZXZlbENvdW50KCk7XG5cbiAgICAgICAgdGhpcy5hY3RpdmF0ZWRSb3V0ZS5wYXJhbXMuc3Vic2NyaWJlKChwYXRoUGFyYW0pID0+IHtcbiAgICAgICAgICAgIGlmIChwYXRoUGFyYW0uYWxlcnRJRCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbGVydFJ1bGVJRCA9IHBhdGhQYXJhbS5hbGVydElEO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICB0aGlzLmdldEFsbExldmVsRXNjYWxhdGlvbigpO1xuICAgIH1cblxuICAgIGdldEVzY2FsYXRpb25MZXZlbENvdW50KCkge1xuICAgICAgICB0aGlzLmVzY2FsYXRpb25Db250cm9sbGVyLmdldEVzY2FsYXRpb25MZXZlbENvdW50KHRoaXMub3JnSUQpLnN1YnNjcmliZSgoZXNjYWxhdGlvbkxldmVsQ291bnRSZXM6IEVzY2FsYXRpb25MZXZlbENvdW50TSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lc2NhbGF0aW9uTGV2ZWxDb3VudE0gPSBlc2NhbGF0aW9uTGV2ZWxDb3VudFJlcztcblxuICAgICAgICAgICAgaWYgKHRoaXMuZXNjYWxhdGlvbkxldmVsQ291bnRNLmxldmVsICYmIHRoaXMuZXNjYWxhdGlvbkxldmVsQ291bnRNICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVzY2FsYXRpb25MZXZlbEpTT04gPSB0aGlzLmdldEVzY2FsYXRpb25MZXZlbEpTT04odGhpcy5lc2NhbGF0aW9uTGV2ZWxDb3VudE0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sIGVycm9yID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvciBpbiBnZXRFc2NhbGF0aW9uTGV2ZWxDb3VudCgpIC0nLCBlcnJvcik7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZ2V0QWxsTGV2ZWxFc2NhbGF0aW9uKCkge1xuICAgICAgICB0aGlzLmVzY2FsYXRpb25Db250cm9sbGVyLmdldEFsbExldmVsRXNjYWxhdGlvbih0aGlzLm9yZ0lELCB0aGlzLmFsZXJ0UnVsZUlEKS5zdWJzY3JpYmUoKGVzY2FsYXRpb25MZXZlbFJlczogRXNjYWxhdGlvbkxldmVsSW5mb01bXSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lc2NhbGF0aW9uTGV2ZWxJbmZvTSA9IGVzY2FsYXRpb25MZXZlbFJlcztcbiAgICAgICAgfSwgZXJyb3IgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yIGluIGdldEFsbExldmVsRXNjYWxhdGlvbigpIC0nLCBlcnJvcik7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZ2V0RXNjYWxhdGlvbkxldmVsSlNPTihlc2NhbGF0aW9uTGV2ZWwpIHtcbiAgICAgICAgY29uc3QgbGV2ZWxzQXJyYXkgPSBbXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBlc2NhbGF0aW9uTGV2ZWwubGV2ZWw7IGkrKykge1xuICAgICAgICAgICAgbGV2ZWxzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGksXG4gICAgICAgICAgICAgICAgbmFtZTogYExldmVsICR7aX1gXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBsZXZlbHNBcnJheTtcbiAgICB9XG5cbiAgICBpc0xldmVsQ29uZmlndXJlZChsZXZlbElkOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXNjYWxhdGlvbkxldmVsSW5mb00/LnNvbWUobGV2ZWwgPT4gbGV2ZWwubGV2ZWwgPT0gbGV2ZWxJZCk7XG4gICAgfVxuXG4gICAgZ2V0Q29ycmVzb25kaW5nRXNjTGV2ZWxDb25maWcobGV2ZWxJZDogbnVtYmVyKTogYW55IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXNjYWxhdGlvbkxldmVsSW5mb00/LmZpbmQobGV2ZWwgPT4gbGV2ZWwubGV2ZWwgPT0gbGV2ZWxJZCk7XG4gICAgfVxuXG4gICAgaGFzRXNjYWxhdGlvbkRhdGFGb3JQcmV2aW91c0xldmVsKGxldmVsSWQ6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gbGV2ZWxJZCA+IDEgJiYgdGhpcy5oYXNFc2NhbGF0aW9uRGF0YUZvckxldmVsKGxldmVsSWQgLSAxKTtcbiAgICB9XG5cbiAgICBoYXNFc2NhbGF0aW9uRGF0YUZvckxldmVsKGxldmVsSWQ6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBlc2NhbGF0aW9uRGF0YSA9IHRoaXMuZXNjYWxhdGlvbkxldmVsSW5mb00/LmZpbmQobGV2ZWwgPT4gbGV2ZWwubGV2ZWwgPT0gbGV2ZWxJZCk7XG4gICAgICAgIHJldHVybiAhIWVzY2FsYXRpb25EYXRhO1xuICAgIH1cbiAgICBcblxuICAgIGNyZWF0ZVVwZGF0ZUVzY2FsYXRpb25SdWxlRGlhbG9nKGxldmVsSUQ6IG51bWJlciwgYWN0aW9uOiBQYWdlVGl0bGVFbnVtLCBlc2NMZXZlbENvbmZpZz86IGFueSkge1xuICAgICAgICBjb25zdCBkaWFsb2cgPSB0aGlzLmRpYWxvZy5vcGVuKENyZWF0ZVVwZGF0ZUVzY2FsYXRpb25Db21wb25lbnQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBhbGVydFJ1bGVJRDogdGhpcy5hbGVydFJ1bGVJRCxcbiAgICAgICAgICAgICAgICAgICAgbGV2ZWxJRDogbGV2ZWxJRCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgIGVzY0xldmVsQ29uZmlnOiBlc2NMZXZlbENvbmZpZ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWluV2lkdGg6ICc1MHZ3JyxcbiAgICAgICAgICAgICAgICBtYXhXaWR0aDogJzUwdncnLFxuICAgICAgICAgICAgICAgIGhlaWdodDogJzEwMCUnLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7IHJpZ2h0OiAnLTJweCcsIHRvcDogJzBweCcgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIGRpYWxvZy5hZnRlckNsb3NlZCgpLnN1YnNjcmliZSgocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBpZiAocmVzdWx0ID09IERpYWxvZ0VudW0uU1VDQ0VTU19EUikge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0QWxsTGV2ZWxFc2NhbGF0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgb3BlbkRlbGV0ZUVzY1J1bGVEaWFsb2cobGV2ZWxJRCwgZXNjTGV2ZWxDb25maWcpIHtcblxuICAgICAgICBjb25zdCBlc2NhbGF0aW9uUnVsZUlEID0gZXNjTGV2ZWxDb25maWcuZXNjYWxhdGlvblJ1bGVJRDtcblxuICAgICAgICBjb25zdCBkaWFsb2cgPSB0aGlzLmRpYWxvZy5vcGVuKERpYWxvZ09uZUNvbXBvbmVudCwge1xuICAgICAgICAgICAgbWluV2lkdGg6ICc1MDBweCcsXG4gICAgICAgICAgICBtYXhXaWR0aDogJzUwMHB4JyxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBEaWFsb2dPbmVFbnVtLkRFTEVURSxcbiAgICAgICAgICAgICAgICBpY29uOiAnZGFuZ2Vyb3VzJyxcbiAgICAgICAgICAgICAgICBoZWFkZXI6ICdEZWxldGUgZXNjYWxhdGlvbiA/JyxcbiAgICAgICAgICAgICAgICBib2R5OiAnRXNjYWxhdGlvbiBjb25maWd1cmF0aW9uIGZvciBsZXZlbCAnICsgJzxiPicgKyBsZXZlbElEICsgJzwvYj4nICsgJyB3aWxsIGJlIGRlbGV0ZWQgcGVybWFuZW50bHkuPC9icj48L2JyPkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjb250aW51ZT8nLFxuICAgICAgICAgICAgICAgIGJ1dHRvbk9uZTogQnV0dG9uTGFiZWxFbnVtLkNBTkNFTF9CVE5fTEFCRUwsXG4gICAgICAgICAgICAgICAgYnV0dG9uVHdvOiBCdXR0b25MYWJlbEVudW0uREVMRVRFX0JUTl9MQUJFTFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgZGlhbG9nLmFmdGVyQ2xvc2VkKCkuc3Vic2NyaWJlKHJlcyA9PiB7XG4gICAgICAgICAgICBpZiAocmVzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWxldGVFc2NhbGF0aW9uUnVsZURpYWxvZyhlc2NhbGF0aW9uUnVsZUlEKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBkZWxldGVFc2NhbGF0aW9uUnVsZURpYWxvZyhlc2NhbGF0aW9uUnVsZUlEKSB7XG4gICAgICAgIHRoaXMuZXNjYWxhdGlvbkNvbnRyb2xsZXIuZGVsZXRlRXNjbGF0aW9uQnlMZXZlbElEKHRoaXMub3JnSUQsIGVzY2FsYXRpb25SdWxlSUQpLnN1YnNjcmliZSgoZGVsZXRlUmVzOiBSZXNwb25zZU0pID0+IHtcblxuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuXG4gICAgICAgICAgICBsZXQgdG9hc3QgPSB0aGlzLnRvYXN0clNlcnZpY2UuZ2V0VG9hc3RTdGF0dXMoZGVsZXRlUmVzLnN0YXR1cyk7XG4gICAgICAgICAgICB0aGlzLnRvYXN0clNlcnZpY2Uub3BlblRvYXN0KHRvYXN0LnRpdGxlLCBkZWxldGVSZXMubWVzc2FnZSwgdG9hc3QuY29sb3IpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbn0iLCI8ZGl2IGNsYXNzPVwiY2FyZCBtYWluLWNhcmQgY2FyZE92ZXJ3cml0ZSBoMTAwXCI+XG4gICAgPGRpdiBjbGFzcz1cImhlYWRlckNvbnRhaW5lclwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaGVhZGVyTGVmdENvbnRhaW5lclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInBhZ2VUaXRsZVwiPkVzY2FsYXRpb24gUnVsZTwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJjYXJkLWJvZHlcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInJvdyBtYi0zXCIgKm5nRm9yPVwibGV0IGxldmVsIG9mIGVzY2FsYXRpb25MZXZlbEpTT05cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtc20tMTJcIj5cbiAgICAgICAgICAgICAgICA8bWF0LWNhcmQgY2xhc3M9XCJib3JkZXIgY2FyZE92ZXJ3cml0ZVwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicm93XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNtLThcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2FyZFRpdGxlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7IGxldmVsLm5hbWUgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNtLTEyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwidGV4dC1kYW5nZXJcIiAqbmdJZj1cIiFpc0xldmVsQ29uZmlndXJlZChsZXZlbC5pZClcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5vdCBjb25maWd1cmVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwiaXNMZXZlbENvbmZpZ3VyZWQobGV2ZWwuaWQpXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGZ4TGF5b3V0PVwicm93IHdyYXBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNtLTNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5Fc2NhbGF0aW9uczo8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNtLTRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5JbnRlcnZhbDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZnctYm9sZFwiPnt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRDb3JyZXNvbmRpbmdFc2NMZXZlbENvbmZpZyhsZXZlbC5pZCk/LmludGVydmFsVmFsdWV9fSAtIHt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRDb3JyZXNvbmRpbmdFc2NMZXZlbENvbmZpZyhsZXZlbC5pZCk/LmludGVydmFsRnJlcXVlbmN5TmFtZX19PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbC1zbS00XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+Tm90aWZpY2F0aW9uIGZyZXF1ZW5jeTwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZnctYm9sZFwiPnt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRDb3JyZXNvbmRpbmdFc2NMZXZlbENvbmZpZyhsZXZlbC5pZCk/Lm5vdGlmaWNhdGlvblByZWZWYWx1ZX19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIHt7IGdldENvcnJlc29uZGluZ0VzY0xldmVsQ29uZmlnKGxldmVsLmlkKT8ubm90aWZpY2F0aW9uUHJlZk5hbWV9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtc20tNCBjZW50ZXJBbGlnblZlcnRpY2FsIGp1c3RpZnktY29udGVudC1lbmRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1zbSBidG4tc3VjY2Vzc1wiIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY2xpY2spPVwiY3JlYXRlVXBkYXRlRXNjYWxhdGlvblJ1bGVEaWFsb2cobGV2ZWwuaWQsIFBhZ2VUaXRsZUVudW0uQ1JFQVRFKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpuZ0lmPVwiIWlzTGV2ZWxDb25maWd1cmVkKGxldmVsLmlkKSAmJiAobGV2ZWwuaWQgPT0gMSB8fCAoaGFzRXNjYWxhdGlvbkRhdGFGb3JQcmV2aW91c0xldmVsKGxldmVsLmlkKSAmJiAhaGFzRXNjYWxhdGlvbkRhdGFGb3JMZXZlbChsZXZlbC5pZCkpKVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyBCdXR0b25MYWJlbEVudW0uQ1JFQVRFX0JUTl9MQUJFTCB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLXNtIGJ0bi1zZWNvbmRhcnkgZGlzYWJsZUJ1dHRvblwiIG1hdFRvb2x0aXBQb3NpdGlvbj1cImFib3ZlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW21hdFRvb2x0aXBdPVwiJ1NldHRpbmcgdXAgYSBwcmV2aW91cyBsZXZlbCBpcyBtYW5kYXRvcnkgYmVmb3JlIGNyZWF0aW5nIHRoZSBlc2NhbGF0aW9uIG1ldHJpYyBmb3IgdGhlIGN1cnJlbnQgbGV2ZWwnXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKm5nSWY9XCIhaXNMZXZlbENvbmZpZ3VyZWQobGV2ZWwuaWQpICYmIGxldmVsLmlkICE9IDEgJiYgKGhhc0VzY2FsYXRpb25EYXRhRm9yTGV2ZWwobGV2ZWwuaWQpIHx8ICFoYXNFc2NhbGF0aW9uRGF0YUZvclByZXZpb3VzTGV2ZWwobGV2ZWwuaWQpKVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyBCdXR0b25MYWJlbEVudW0uQ1JFQVRFX0JUTl9MQUJFTCB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5IG1lLTJcIiB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNsaWNrKT1cImNyZWF0ZVVwZGF0ZUVzY2FsYXRpb25SdWxlRGlhbG9nKGxldmVsLmlkLCBQYWdlVGl0bGVFbnVtLlVQREFURSwgZ2V0Q29ycmVzb25kaW5nRXNjTGV2ZWxDb25maWcobGV2ZWwuaWQpKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpuZ0lmPVwiaXNMZXZlbENvbmZpZ3VyZWQobGV2ZWwuaWQpXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7IEJ1dHRvbkxhYmVsRW51bS5VUERBVEVfQlROX0xBQkVMIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tc20gYnRuLWRhbmdlclwiIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY2xpY2spPVwib3BlbkRlbGV0ZUVzY1J1bGVEaWFsb2cobGV2ZWwuaWQsIGdldENvcnJlc29uZGluZ0VzY0xldmVsQ29uZmlnKGxldmVsLmlkKSlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqbmdJZj1cImlzTGV2ZWxDb25maWd1cmVkKGxldmVsLmlkKVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyBCdXR0b25MYWJlbEVudW0uREVMRVRFX0JUTl9MQUJFTCB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvbWF0LWNhcmQ+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG48L2Rpdj4iXX0=