import { Component, ViewChild } from '@angular/core';
import { merge, fromEvent, of as observableOf } from 'rxjs';
import { map, startWith, switchMap, catchError } from "rxjs/operators";
import { AlertPageLabelEnum, AlertTypeEnum } from '../../../../enum/alert.enum';
import { TABLE_CONSTANT, COMMON_CONSTANT, StatusEnum } from '@library/tsc-common';
import * as i0 from "@angular/core";
import * as i1 from "@library/storage-service";
import * as i2 from "../../../../controller/alert.controller";
import * as i3 from "@library/tsc-common";
import * as i4 from "@angular/material/table";
import * as i5 from "@angular/material/sort";
import * as i6 from "@angular/material/paginator";
import * as i7 from "@angular/material/tooltip";
import * as i8 from "@angular/common";
// /tsc-library/
export class ConfiguredAlarmPageComponent {
    constructor(storageService, alertController) {
        this.storageService = storageService;
        this.alertController = alertController;
        this.TABLE_CONSTANT = TABLE_CONSTANT;
        this.COMMON_CONSTANT = COMMON_CONSTANT;
        this.AlertTypeEnum = AlertTypeEnum;
        this.AlertPageLabelEnum = AlertPageLabelEnum;
        this.StatusEnum = StatusEnum;
        this.displayedColumn = ['id', 'name', 'associatedWith', 'ruleDescription', 'type', 'status'];
        this.resultLength = 0;
        this.dataSource = [];
        this.searchFlag = false;
        this.searchArr = [];
    }
    ngOnInit() {
        this.orgID = this.storageService.getStorage('currentOrgID');
    }
    ngAfterViewInit() {
        merge(this.paginator.page, this.sort.sortChange, fromEvent(this.refreshBtn.nativeElement, 'click')).pipe(startWith({}), switchMap(() => {
            this.searchArr = [];
            if (this.searchFlag) {
                this.searchArr.push('name:' + this.searchValue);
            }
            const alertType = AlertTypeEnum.ALL;
            return this.alertController.getAlertRuleByPage(this.paginator.pageIndex, this.paginator.pageSize, this.sort.active, this.sort.direction, this.searchArr, alertType, this.orgID).pipe(catchError(() => observableOf(null)));
        }), map((response) => {
            if (response == null) {
                this.resultLength = 0;
                return [];
            }
            this.resultLength = response["totalCount"];
            return response["records"];
        })).subscribe((dataSource) => {
            this.dataSource = dataSource;
        });
    }
    searchFn(value) {
        this.searchFlag = true;
        this.searchValue = value;
        if (value.length == 0) {
            this.resetSearch();
        }
        else {
            this.paginator.pageIndex = 0;
        }
        this.refreshBtn.nativeElement.click();
    }
    resetSearch() {
        this.searchFlag = false;
        this.searchBar.searchClear();
    }
}
ConfiguredAlarmPageComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: ConfiguredAlarmPageComponent, deps: [{ token: i1.StorageService }, { token: i2.AlertRuleController }], target: i0.ɵɵFactoryTarget.Component });
ConfiguredAlarmPageComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.17", type: ConfiguredAlarmPageComponent, selector: "lib-page", viewQueries: [{ propertyName: "sort", first: true, predicate: ["sort"], descendants: true }, { propertyName: "paginator", first: true, predicate: ["paginator"], descendants: true }, { propertyName: "refreshBtn", first: true, predicate: ["refreshBtn"], descendants: true }, { propertyName: "searchBar", first: true, predicate: ["searchBar"], descendants: true }], ngImport: i0, template: "<div class=\"card main-card cardOverwrite h100\">\n    <div class=\"headerContainer\">\n        <div class=\"headerLeftContainer\">\n            <div class=\"pageTitle\">Configured Alarms</div>\n        </div>\n        <div class=\"headerRightContainer\">\n            <div class=\"headerRightContainerInner\">\n                <lib-search-bar-one class=\"me-3\" #searchBar searchBy=\"name\" (emitSearch)=\"searchFn($event)\">\n                </lib-search-bar-one>\n            </div>\n        </div>\n    </div>\n\n    <button #refreshBtn class=\"d-none\"></button>\n\n    <div class=\"overflowX customScrollBar\">\n        <table class=\"w-100\" mat-table [dataSource]=\"dataSource\" #sort=\"matSort\" matSort matSortActive=\"id\"\n            matSortDirection=\"asc\" matSortDisableClear>\n\n            <ng-container matColumnDef=\"id\">\n                <th class=\"px-3 columnWidth1\" mat-header-cell *matHeaderCellDef mat-sort-header disableClear>\n                    ID\n                </th>\n                <td class=\"px-3 columnWidth1\" mat-cell *matCellDef=\"let row\">\n                    {{ row['id'] ? row['id']: COMMON_CONSTANT.HYPHEN }}\n                </td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"name\">\n                <th class=\"px-3 columnWidth2\" mat-header-cell *matHeaderCellDef> Name </th>\n                <td class=\"px-3 columnWidth2\" mat-cell *matCellDef=\"let row\"\n                    [matTooltip]=\"row?.['name']?.length>25? row['name']: ''\" matTooltipPosition=\"above\"\n                    matTooltipClass=\"nameTooltip\">\n                    {{ (row['name'] ? row['name']: COMMON_CONSTANT.HYPHEN) | dotdotdot:25}}\n                </td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"associatedWith\">\n                <th class=\"px-3 columnWidth3\" mat-header-cell *matHeaderCellDef> Associated with </th>\n                <td class=\"px-3 columnWidth3\" mat-cell *matCellDef=\"let row\"\n                    [matTooltip]=\"row?.['associatedWith']?.length>30? row['associatedWith']: ''\"\n                    matTooltipPosition=\"above\" matTooltipClass=\"nameTooltip\">\n                    {{ (row['associatedWith'] ? row['associatedWith']: COMMON_CONSTANT.HYPHEN) | dotdotdot:30}}\n                </td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"ruleDescription\">\n                <th class=\"px-3 columnWidth3\" mat-header-cell *matHeaderCellDef> Rule </th>\n                <td class=\"px-3 columnWidth3\" mat-cell *matCellDef=\"let row\"\n                    [matTooltip]=\"row?.['ruleDescription']?.length>30? row['ruleDescription']: ''\"\n                    matTooltipPosition=\"above\" matTooltipClass=\"nameTooltip\">\n                    {{ (row['ruleDescription'] ? row['ruleDescription']: COMMON_CONSTANT.HYPHEN) | dotdotdot:30}}\n                </td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"type\">\n                <th class=\"px-3 columnWidth1\" mat-header-cell *matHeaderCellDef> Type </th>\n                <td class=\"px-3 columnWidth1\" mat-cell *matCellDef=\"let row\">\n                    <span class=\"badge rounded-pill bg-light text-dark\" [ngSwitch]=\"row?.type\">\n                        <ng-container *ngSwitchCase=\"AlertTypeEnum.INSTANTANEOUS\">{{\n                            AlertPageLabelEnum.INSTANTANEOUS_LABEL\n                            }}</ng-container>\n                        <ng-container *ngSwitchCase=\"AlertTypeEnum.PERIODIC\">{{ AlertPageLabelEnum.PERIODIC_LABEL\n                            }}</ng-container>\n                    </span>\n                </td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"status\">\n                <th class=\"px-3 columnWidth1\" mat-header-cell *matHeaderCellDef> Status </th>\n                <td class=\"px-3 columnWidth1\" mat-cell *matCellDef=\"let row\">\n                    <span class=\"badge rounded-pill\" [ngClass]=\"{'bg-success': row?.status, 'bg-danger': !row?.status}\">\n                        {{ row?.status ? StatusEnum.ACTIVE_STATUS : StatusEnum.INACTIVE_STATUS }}\n                    </span>\n                </td>\n            </ng-container>\n\n            <tr mat-header-row *matHeaderRowDef=\"displayedColumn\"></tr>\n            <tr mat-row *matRowDef=\"let task; columns: displayedColumn;\"></tr>\n\n            <tr class=\"mat-row\" *matNoDataRow>\n                <td class=\"mat-cell text-center\" [attr.colspan]=\"displayedColumn.length\">\n                    {{ TABLE_CONSTANT.TABLE_NO_DATA }}\n                </td>\n            </tr>\n        </table>\n    </div>\n    <mat-paginator #paginator class=\"roundedBorder\" showFirstLastButtons [length]=\"resultLength\"\n        [pageSize]=\"TABLE_CONSTANT.DEFAULT_PAGE_SIZE\" [pageSizeOptions]=\"TABLE_CONSTANT.PAGE_SIZE_OPTION\">\n    </mat-paginator>\n</div>", styles: [".columnWidth1{min-width:120px}.columnWidth2{min-width:250px}.columnWidth3{min-width:300px}.badge{text-transform:none}\n"], components: [{ type: i3.SearchBarOneComponent, selector: "lib-search-bar-one", inputs: ["type", "searchBy", "clear"], outputs: ["emitSearch"] }, { type: i4.MatTable, selector: "mat-table, table[mat-table]", exportAs: ["matTable"] }, { type: i5.MatSortHeader, selector: "[mat-sort-header]", inputs: ["disabled", "arrowPosition", "sortActionDescription", "disableClear", "mat-sort-header", "start"], exportAs: ["matSortHeader"] }, { type: i4.MatHeaderRow, selector: "mat-header-row, tr[mat-header-row]", exportAs: ["matHeaderRow"] }, { type: i4.MatRow, selector: "mat-row, tr[mat-row]", exportAs: ["matRow"] }, { type: i6.MatPaginator, selector: "mat-paginator", inputs: ["disabled"], exportAs: ["matPaginator"] }], directives: [{ type: i5.MatSort, selector: "[matSort]", inputs: ["matSortDisabled", "matSortStart", "matSortDirection", "matSortDisableClear", "matSortActive"], outputs: ["matSortChange"], exportAs: ["matSort"] }, { type: i4.MatColumnDef, selector: "[matColumnDef]", inputs: ["sticky", "matColumnDef"] }, { type: i4.MatHeaderCellDef, selector: "[matHeaderCellDef]" }, { type: i4.MatHeaderCell, selector: "mat-header-cell, th[mat-header-cell]" }, { type: i4.MatCellDef, selector: "[matCellDef]" }, { type: i4.MatCell, selector: "mat-cell, td[mat-cell]" }, { type: i7.MatTooltip, selector: "[matTooltip]", exportAs: ["matTooltip"] }, { type: i8.NgSwitch, selector: "[ngSwitch]", inputs: ["ngSwitch"] }, { type: i8.NgSwitchCase, selector: "[ngSwitchCase]", inputs: ["ngSwitchCase"] }, { type: i8.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i4.MatHeaderRowDef, selector: "[matHeaderRowDef]", inputs: ["matHeaderRowDef", "matHeaderRowDefSticky"] }, { type: i4.MatRowDef, selector: "[matRowDef]", inputs: ["matRowDefColumns", "matRowDefWhen"] }, { type: i4.MatNoDataRow, selector: "ng-template[matNoDataRow]" }], pipes: { "dotdotdot": i3.EllipsisPipeService } });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: ConfiguredAlarmPageComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'lib-page',
                    templateUrl: './page.component.html',
                    styleUrls: ['./page.component.scss']
                }]
        }], ctorParameters: function () { return [{ type: i1.StorageService }, { type: i2.AlertRuleController }]; }, propDecorators: { sort: [{
                type: ViewChild,
                args: ['sort']
            }], paginator: [{
                type: ViewChild,
                args: ['paginator']
            }], refreshBtn: [{
                type: ViewChild,
                args: ['refreshBtn']
            }], searchBar: [{
                type: ViewChild,
                args: ['searchBar']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9saWJyYXJ5L2FsZXJ0cy9zcmMvbGliL3RzYy9jb21wb25lbnQvYWxhcm0vY29uZmlndXJlZC9wYWdlL3BhZ2UuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbGlicmFyeS9hbGVydHMvc3JjL2xpYi90c2MvY29tcG9uZW50L2FsYXJtL2NvbmZpZ3VyZWQvcGFnZS9wYWdlLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQXNCLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUt6RSxPQUFPLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxFQUFFLElBQUksWUFBWSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzVELE9BQU8sRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV2RSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsYUFBYSxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFRaEYsT0FBTyxFQUFFLGNBQWMsRUFBRSxlQUFlLEVBQUUsVUFBVSxFQUFnQyxNQUFNLHFCQUFxQixDQUFDOzs7Ozs7Ozs7O0FBQ2hILGdCQUFnQjtBQVFoQixNQUFNLE9BQU8sNEJBQTRCO0lBd0JyQyxZQUNZLGNBQThCLEVBQzlCLGVBQW9DO1FBRHBDLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM5QixvQkFBZSxHQUFmLGVBQWUsQ0FBcUI7UUF4QmhELG1CQUFjLEdBQUcsY0FBYyxDQUFDO1FBQ2hDLG9CQUFlLEdBQUcsZUFBZSxDQUFDO1FBRWxDLGtCQUFhLEdBQUcsYUFBYSxDQUFDO1FBQzlCLHVCQUFrQixHQUFHLGtCQUFrQixDQUFDO1FBQ3hDLGVBQVUsR0FBRyxVQUFV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QztvQkFDUCxRQUFRLEVBQUUsVUFBVTtvQkFDcEIsV0FBVyxFQUFFLHVCQUF1QjtvQkFDcEMsU0FBUyxFQUFFLENBQUMsdUJBQXVCLENBQUM7aUJBQ3ZDO3VJQXFCc0IsSUFBSTtzQkFBdEIsU0FBUzt1QkFBQyxNQUFNO2dCQUNPLFNBQVM7c0JBQWhDLFNBQVM7dUJBQUMsV0FBVztnQkFDRyxVQUFVO3NCQUFsQyxTQUFTO3VCQUFDLFlBQVk7Z0JBQ0MsU0FBUztzQkFBaEMsU0FBUzt1QkFBQyxXQUFXIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBPbkluaXQsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBNYXRTb3J0IH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvc29ydCc7XG5pbXBvcnQgeyBNYXRQYWdpbmF0b3IgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9wYWdpbmF0b3InO1xuXG5pbXBvcnQgeyBtZXJnZSwgZnJvbUV2ZW50LCBvZiBhcyBvYnNlcnZhYmxlT2YgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IG1hcCwgc3RhcnRXaXRoLCBzd2l0Y2hNYXAsIGNhdGNoRXJyb3IgfSBmcm9tIFwicnhqcy9vcGVyYXRvcnNcIjtcblxuaW1wb3J0IHsgQWxlcnRQYWdlTGFiZWxFbnVtLCBBbGVydFR5cGVFbnVtIH0gZnJvbSAnLi4vLi4vLi4vLi4vZW51bS9hbGVydC5lbnVtJztcblxuaW1wb3J0IHsgQWxlcnRQYWdlTSB9IGZyb20gJy4uLy4uLy4uLy4uL21vZGVsL2FsZXJ0Lm1vZGVsJztcblxuaW1wb3J0IHsgQWxlcnRSdWxlQ29udHJvbGxlciB9IGZyb20gJy4uLy4uLy4uLy4uL2NvbnRyb2xsZXIvYWxlcnQuY29udHJvbGxlcic7XG5cbi8vIHRzYy1saWJyYXJ5XG5pbXBvcnQgeyBTdG9yYWdlU2VydmljZSB9IGZyb20gJ0BsaWJyYXJ5L3N0b3JhZ2Utc2VydmljZSc7XG5pbXBvcnQgeyBUQUJMRV9DT05TVEFOVCwgQ09NTU9OX0NPTlNUQU5ULCBTdGF0dXNFbnVtLCBQYWdlTSwgU2VhcmNoQmFyT25lQ29tcG9uZW50IH0gZnJvbSAnQGxpYnJhcnkvdHNjLWNvbW1vbic7XG4vLyAvdHNjLWxpYnJhcnkvXG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnbGliLXBhZ2UnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9wYWdlLmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHM6IFsnLi9wYWdlLmNvbXBvbmVudC5zY3NzJ11cbn0pXG5cbmV4cG9ydCBjbGFzcyBDb25maWd1cmVkQWxhcm1QYWdlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICAgIFRBQkxFX0NPTlNUQU5UID0gVEFCTEVfQ09OU1RBTlQ7XG4gICAgQ09NTU9OX0NPTlNUQU5UID0gQ09NTU9OX0NPTlNUQU5UO1xuXG4gICAgQWxlcnRUeXBlRW51bSA9IEFsZXJ0VHlwZUVudW07XG4gICAgQWxlcnRQYWdlTGFiZWxFbnVtID0gQWxlcnRQYWdlTGFiZWxFbnVtO1xuICAgIFN0YXR1c0VudW0gPSBTdGF0dXNFbnVtO1xuXG4gICAgb3JnSUQ6IGFueTtcblxuICAgIGRpc3BsYXllZENvbHVtbjogc3RyaW5nW10gPSBbJ2lkJywgJ25hbWUnLCAnYXNzb2NpYXRlZFdpdGgnLCAncnVsZURlc2NyaXB0aW9uJywgJ3R5cGUnLCAnc3RhdHVzJ107XG4gICAgcmVzdWx0TGVuZ3RoOiBudW1iZXIgPSAwO1xuICAgIGRhdGFTb3VyY2U6IGFueVtdID0gW107XG5cbiAgICBzZWFyY2hGbGFnOiBib29sZWFuID0gZmFsc2U7XG4gICAgc2VhcmNoVmFsdWU6IHN0cmluZztcbiAgICBzZWFyY2hBcnI6IGFueVtdID0gW107XG5cbiAgICBAVmlld0NoaWxkKCdzb3J0Jykgc29ydDogTWF0U29ydDtcbiAgICBAVmlld0NoaWxkKCdwYWdpbmF0b3InKSBwYWdpbmF0b3I6IE1hdFBhZ2luYXRvcjtcbiAgICBAVmlld0NoaWxkKCdyZWZyZXNoQnRuJykgcmVmcmVzaEJ0bjogRWxlbWVudFJlZjtcbiAgICBAVmlld0NoaWxkKCdzZWFyY2hCYXInKSBzZWFyY2hCYXI6IFNlYXJjaEJhck9uZUNvbXBvbmVudDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHN0b3JhZ2VTZXJ2aWNlOiBTdG9yYWdlU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBhbGVydENvbnRyb2xsZXI6IEFsZXJ0UnVsZUNvbnRyb2xsZXIsXG4gICAgKSB7IH1cblxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLm9yZ0lEID0gdGhpcy5zdG9yYWdlU2VydmljZS5nZXRTdG9yYWdlKCdjdXJyZW50T3JnSUQnKTtcbiAgICB9XG5cbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgICAgIG1lcmdlKFxuICAgICAgICAgICAgdGhpcy5wYWdpbmF0b3IucGFnZSxcbiAgICAgICAgICAgIHRoaXMuc29ydC5zb3J0Q2hhbmdlLFxuICAgICAgICAgICAgZnJvbUV2ZW50KHRoaXMucmVmcmVzaEJ0bi5uYXRpdmVFbGVtZW50LCAnY2xpY2snKVxuICAgICAgICApLnBpcGUoXG4gICAgICAgICAgICBzdGFydFdpdGgoe30pLFxuICAgICAgICAgICAgc3dpdGNoTWFwKCgpOiBhbnkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoQXJyID0gW107XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VhcmNoRmxhZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaEFyci5wdXNoKCduYW1lOicgKyB0aGlzLnNlYXJjaFZhbHVlKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IGFsZXJ0VHlwZSA9IEFsZXJ0VHlwZUVudW0uQUxMO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWxlcnRDb250cm9sbGVyLmdldEFsZXJ0UnVsZUJ5UGFnZShcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdpbmF0b3IucGFnZUluZGV4LFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2luYXRvci5wYWdlU2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zb3J0LmFjdGl2ZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zb3J0LmRpcmVjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hBcnIsXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0VHlwZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmdJRFxuICAgICAgICAgICAgICAgICkucGlwZShjYXRjaEVycm9yKCgpID0+IG9ic2VydmFibGVPZihudWxsKSkpO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBtYXAoKHJlc3BvbnNlOiBQYWdlTTxBbGVydFBhZ2VNPik6IGFueSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRMZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0TGVuZ3RoID0gcmVzcG9uc2VbXCJ0b3RhbENvdW50XCJdO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZVtcInJlY29yZHNcIl07XG4gICAgICAgICAgICB9KVxuICAgICAgICApLnN1YnNjcmliZSgoZGF0YVNvdXJjZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2VhcmNoRm4odmFsdWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLnNlYXJjaEZsYWcgPSB0cnVlO1xuICAgICAgICB0aGlzLnNlYXJjaFZhbHVlID0gdmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5yZXNldFNlYXJjaCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wYWdpbmF0b3IucGFnZUluZGV4ID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZnJlc2hCdG4ubmF0aXZlRWxlbWVudC5jbGljaygpO1xuICAgIH1cblxuICAgIHJlc2V0U2VhcmNoKCkge1xuICAgICAgICB0aGlzLnNlYXJjaEZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZWFyY2hCYXIuc2VhcmNoQ2xlYXIoKTtcbiAgICB9XG5cbn1cbiIsIjxkaXYgY2xhc3M9XCJjYXJkIG1haW4tY2FyZCBjYXJkT3ZlcndyaXRlIGgxMDBcIj5cbiAgICA8ZGl2IGNsYXNzPVwiaGVhZGVyQ29udGFpbmVyXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXJMZWZ0Q29udGFpbmVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwicGFnZVRpdGxlXCI+Q29uZmlndXJlZCBBbGFybXM8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXJSaWdodENvbnRhaW5lclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImhlYWRlclJpZ2h0Q29udGFpbmVySW5uZXJcIj5cbiAgICAgICAgICAgICAgICA8bGliLXNlYXJjaC1iYXItb25lIGNsYXNzPVwibWUtM1wiICNzZWFyY2hCYXIgc2VhcmNoQnk9XCJuYW1lXCIgKGVtaXRTZWFyY2gpPVwic2VhcmNoRm4oJGV2ZW50KVwiPlxuICAgICAgICAgICAgICAgIDwvbGliLXNlYXJjaC1iYXItb25lPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuXG4gICAgPGJ1dHRvbiAjcmVmcmVzaEJ0biBjbGFzcz1cImQtbm9uZVwiPjwvYnV0dG9uPlxuXG4gICAgPGRpdiBjbGFzcz1cIm92ZXJmbG93WCBjdXN0b21TY3JvbGxCYXJcIj5cbiAgICAgICAgPHRhYmxlIGNsYXNzPVwidy0xMDBcIiBtYXQtdGFibGUgW2RhdGFTb3VyY2VdPVwiZGF0YVNvdXJjZVwiICNzb3J0PVwibWF0U29ydFwiIG1hdFNvcnQgbWF0U29ydEFjdGl2ZT1cImlkXCJcbiAgICAgICAgICAgIG1hdFNvcnREaXJlY3Rpb249XCJhc2NcIiBtYXRTb3J0RGlzYWJsZUNsZWFyPlxuXG4gICAgICAgICAgICA8bmctY29udGFpbmVyIG1hdENvbHVtbkRlZj1cImlkXCI+XG4gICAgICAgICAgICAgICAgPHRoIGNsYXNzPVwicHgtMyBjb2x1bW5XaWR0aDFcIiBtYXQtaGVhZGVyLWNlbGwgKm1hdEhlYWRlckNlbGxEZWYgbWF0LXNvcnQtaGVhZGVyIGRpc2FibGVDbGVhcj5cbiAgICAgICAgICAgICAgICAgICAgSURcbiAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cInB4LTMgY29sdW1uV2lkdGgxXCIgbWF0LWNlbGwgKm1hdENlbGxEZWY9XCJsZXQgcm93XCI+XG4gICAgICAgICAgICAgICAgICAgIHt7IHJvd1snaWQnXSA/IHJvd1snaWQnXTogQ09NTU9OX0NPTlNUQU5ULkhZUEhFTiB9fVxuICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lciBtYXRDb2x1bW5EZWY9XCJuYW1lXCI+XG4gICAgICAgICAgICAgICAgPHRoIGNsYXNzPVwicHgtMyBjb2x1bW5XaWR0aDJcIiBtYXQtaGVhZGVyLWNlbGwgKm1hdEhlYWRlckNlbGxEZWY+IE5hbWUgPC90aD5cbiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XCJweC0zIGNvbHVtbldpZHRoMlwiIG1hdC1jZWxsICptYXRDZWxsRGVmPVwibGV0IHJvd1wiXG4gICAgICAgICAgICAgICAgICAgIFttYXRUb29sdGlwXT1cInJvdz8uWyduYW1lJ10/Lmxlbmd0aD4yNT8gcm93WyduYW1lJ106ICcnXCIgbWF0VG9vbHRpcFBvc2l0aW9uPVwiYWJvdmVcIlxuICAgICAgICAgICAgICAgICAgICBtYXRUb29sdGlwQ2xhc3M9XCJuYW1lVG9vbHRpcFwiPlxuICAgICAgICAgICAgICAgICAgICB7eyAocm93WyduYW1lJ10gPyByb3dbJ25hbWUnXTogQ09NTU9OX0NPTlNUQU5ULkhZUEhFTikgfCBkb3Rkb3Rkb3Q6MjV9fVxuICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lciBtYXRDb2x1bW5EZWY9XCJhc3NvY2lhdGVkV2l0aFwiPlxuICAgICAgICAgICAgICAgIDx0aCBjbGFzcz1cInB4LTMgY29sdW1uV2lkdGgzXCIgbWF0LWhlYWRlci1jZWxsICptYXRIZWFkZXJDZWxsRGVmPiBBc3NvY2lhdGVkIHdpdGggPC90aD5cbiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XCJweC0zIGNvbHVtbldpZHRoM1wiIG1hdC1jZWxsICptYXRDZWxsRGVmPVwibGV0IHJvd1wiXG4gICAgICAgICAgICAgICAgICAgIFttYXRUb29sdGlwXT1cInJvdz8uWydhc3NvY2lhdGVkV2l0aCddPy5sZW5ndGg+MzA/IHJvd1snYXNzb2NpYXRlZFdpdGgnXTogJydcIlxuICAgICAgICAgICAgICAgICAgICBtYXRUb29sdGlwUG9zaXRpb249XCJhYm92ZVwiIG1hdFRvb2x0aXBDbGFzcz1cIm5hbWVUb29sdGlwXCI+XG4gICAgICAgICAgICAgICAgICAgIHt7IChyb3dbJ2Fzc29jaWF0ZWRXaXRoJ10gPyByb3dbJ2Fzc29jaWF0ZWRXaXRoJ106IENPTU1PTl9DT05TVEFOVC5IWVBIRU4pIHwgZG90ZG90ZG90OjMwfX1cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgbWF0Q29sdW1uRGVmPVwicnVsZURlc2NyaXB0aW9uXCI+XG4gICAgICAgICAgICAgICAgPHRoIGNsYXNzPVwicHgtMyBjb2x1bW5XaWR0aDNcIiBtYXQtaGVhZGVyLWNlbGwgKm1hdEhlYWRlckNlbGxEZWY+IFJ1bGUgPC90aD5cbiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XCJweC0zIGNvbHVtbldpZHRoM1wiIG1hdC1jZWxsICptYXRDZWxsRGVmPVwibGV0IHJvd1wiXG4gICAgICAgICAgICAgICAgICAgIFttYXRUb29sdGlwXT1cInJvdz8uWydydWxlRGVzY3JpcHRpb24nXT8ubGVuZ3RoPjMwPyByb3dbJ3J1bGVEZXNjcmlwdGlvbiddOiAnJ1wiXG4gICAgICAgICAgICAgICAgICAgIG1hdFRvb2x0aXBQb3NpdGlvbj1cImFib3ZlXCIgbWF0VG9vbHRpcENsYXNzPVwibmFtZVRvb2x0aXBcIj5cbiAgICAgICAgICAgICAgICAgICAge3sgKHJvd1sncnVsZURlc2NyaXB0aW9uJ10gPyByb3dbJ3J1bGVEZXNjcmlwdGlvbiddOiBDT01NT05fQ09OU1RBTlQuSFlQSEVOKSB8IGRvdGRvdGRvdDozMH19XG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICAgICAgICA8bmctY29udGFpbmVyIG1hdENvbHVtbkRlZj1cInR5cGVcIj5cbiAgICAgICAgICAgICAgICA8dGggY2xhc3M9XCJweC0zIGNvbHVtbldpZHRoMVwiIG1hdC1oZWFkZXItY2VsbCAqbWF0SGVhZGVyQ2VsbERlZj4gVHlwZSA8L3RoPlxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cInB4LTMgY29sdW1uV2lkdGgxXCIgbWF0LWNlbGwgKm1hdENlbGxEZWY9XCJsZXQgcm93XCI+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiYmFkZ2Ugcm91bmRlZC1waWxsIGJnLWxpZ2h0IHRleHQtZGFya1wiIFtuZ1N3aXRjaF09XCJyb3c/LnR5cGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nU3dpdGNoQ2FzZT1cIkFsZXJ0VHlwZUVudW0uSU5TVEFOVEFORU9VU1wiPnt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQWxlcnRQYWdlTGFiZWxFbnVtLklOU1RBTlRBTkVPVVNfTEFCRUxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fTwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdTd2l0Y2hDYXNlPVwiQWxlcnRUeXBlRW51bS5QRVJJT0RJQ1wiPnt7IEFsZXJ0UGFnZUxhYmVsRW51bS5QRVJJT0RJQ19MQUJFTFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19PC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgbWF0Q29sdW1uRGVmPVwic3RhdHVzXCI+XG4gICAgICAgICAgICAgICAgPHRoIGNsYXNzPVwicHgtMyBjb2x1bW5XaWR0aDFcIiBtYXQtaGVhZGVyLWNlbGwgKm1hdEhlYWRlckNlbGxEZWY+IFN0YXR1cyA8L3RoPlxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cInB4LTMgY29sdW1uV2lkdGgxXCIgbWF0LWNlbGwgKm1hdENlbGxEZWY9XCJsZXQgcm93XCI+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiYmFkZ2Ugcm91bmRlZC1waWxsXCIgW25nQ2xhc3NdPVwieydiZy1zdWNjZXNzJzogcm93Py5zdGF0dXMsICdiZy1kYW5nZXInOiAhcm93Py5zdGF0dXN9XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7eyByb3c/LnN0YXR1cyA/IFN0YXR1c0VudW0uQUNUSVZFX1NUQVRVUyA6IFN0YXR1c0VudW0uSU5BQ1RJVkVfU1RBVFVTIH19XG4gICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgICAgIDx0ciBtYXQtaGVhZGVyLXJvdyAqbWF0SGVhZGVyUm93RGVmPVwiZGlzcGxheWVkQ29sdW1uXCI+PC90cj5cbiAgICAgICAgICAgIDx0ciBtYXQtcm93ICptYXRSb3dEZWY9XCJsZXQgdGFzazsgY29sdW1uczogZGlzcGxheWVkQ29sdW1uO1wiPjwvdHI+XG5cbiAgICAgICAgICAgIDx0ciBjbGFzcz1cIm1hdC1yb3dcIiAqbWF0Tm9EYXRhUm93PlxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cIm1hdC1jZWxsIHRleHQtY2VudGVyXCIgW2F0dHIuY29sc3Bhbl09XCJkaXNwbGF5ZWRDb2x1bW4ubGVuZ3RoXCI+XG4gICAgICAgICAgICAgICAgICAgIHt7IFRBQkxFX0NPTlNUQU5ULlRBQkxFX05PX0RBVEEgfX1cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPC90cj5cbiAgICAgICAgPC90YWJsZT5cbiAgICA8L2Rpdj5cbiAgICA8bWF0LXBhZ2luYXRvciAjcGFnaW5hdG9yIGNsYXNzPVwicm91bmRlZEJvcmRlclwiIHNob3dGaXJzdExhc3RCdXR0b25zIFtsZW5ndGhdPVwicmVzdWx0TGVuZ3RoXCJcbiAgICAgICAgW3BhZ2VTaXplXT1cIlRBQkxFX0NPTlNUQU5ULkRFRkFVTFRfUEFHRV9TSVpFXCIgW3BhZ2VTaXplT3B0aW9uc109XCJUQUJMRV9DT05TVEFOVC5QQUdFX1NJWkVfT1BUSU9OXCI+XG4gICAgPC9tYXQtcGFnaW5hdG9yPlxuPC9kaXY+Il19