import { __awaiter } from "tslib";
import { Component } from '@angular/core';
import { ApplicationKeyID } from '@library/application-service';
import { OrgType } from '@library/organization-service';
import * as i0 from "@angular/core";
import * as i1 from "@library/storage-service";
import * as i2 from "@library/application-service";
import * as i3 from "@ng-bootstrap/ng-bootstrap";
import * as i4 from "@angular/common";
export class ApplicationDrawerComponent {
    constructor(storageService, applicationService) {
        this.storageService = storageService;
        this.applicationService = applicationService;
        this.applicationM = [];
        this.applicationFilter = [];
        this.currentOrgType = '';
        this.currentOrgID = '';
        this.currentRootOrgID = '';
    }
    ngOnInit() {
        this.applicationKeyID = this.storageService.getStorage('applicationKeyID');
        this.currentOrgType = this.storageService.getStorage('currentOrgType');
        this.currentOrgID = this.storageService.getStorage('currentOrgID');
        this.currentRootOrgID = this.storageService.getStorage('rootOrgID');
        if (this.applicationKeyID == ApplicationKeyID.ACCOUNT_KEY_ID) {
            this.getAllApplication();
        }
        else {
            this.getApplicationByUserAccess();
        }
    }
    getAllApplication() {
        return __awaiter(this, void 0, void 0, function* () {
            this.applicationM = (yield this.applicationService.getAllApplication());
            this.applicationFilter = this.applicationM.filter(applicationFilter => applicationFilter['keyID'] != ApplicationKeyID.NETZERO_ADMIN_KEY_ID &&
                applicationFilter['keyID'] != ApplicationKeyID.EMPLOYEE_KEY_ID);
        });
    }
    getApplicationByUserAccess() {
        return __awaiter(this, void 0, void 0, function* () {
            this.applicationM = (yield this.applicationService.getApplicationByUserAccess());
            this.applicationFilter = this.applicationM.filter(applicationFilter => applicationFilter['keyID'] != this.applicationKeyID &&
                applicationFilter['keyID'] != ApplicationKeyID.EMPLOYEE_KEY_ID);
        });
    }
    getApplicationLogo(keyID) {
        let logo;
        logo = this.applicationService.getApplicationLogoWithoutName(keyID);
        return logo;
    }
    appUrlBuilder(applicationKeyID, appURL) {
        let url = appURL;
        let orgLevelApp = [ApplicationKeyID.ADMIN_KEY_ID, ApplicationKeyID.OFFSET_KEY_ID];
        let siteLevelApp = [ApplicationKeyID.ENERGY_KEY_ID, ApplicationKeyID.WATER_KEY_ID, ApplicationKeyID.ENVIRO_KEY_ID];
        let orgSiteLevelApp = [ApplicationKeyID.NETZERO_KEY_ID, ApplicationKeyID.CONNECT_KEY_ID];
        if (orgLevelApp.includes(applicationKeyID) && this.currentOrgType == OrgType.ORGANIZATION) {
            url = `${appURL}&orgID=${this.currentRootOrgID}`;
        }
        else if (siteLevelApp.includes(applicationKeyID) && this.currentOrgType == OrgType.SITE) {
            url = `${appURL}&orgID=${this.currentOrgID}`;
        }
        else if (orgSiteLevelApp.includes(applicationKeyID) && (this.currentOrgType == OrgType.ORGANIZATION || this.currentOrgType == OrgType.SITE)) {
            url = `${appURL}&orgID=${this.currentOrgID}`;
        }
        else {
            url = appURL;
        }
        return url;
    }
}
ApplicationDrawerComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: ApplicationDrawerComponent, deps: [{ token: i1.StorageService }, { token: i2.ApplicationService }], target: i0.ɵɵFactoryTarget.Component });
ApplicationDrawerComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.17", type: ApplicationDrawerComponent, selector: "lib-application-drawer", ngImport: i0, template: "<div class=\"header-dots\">\n    <div class=\"btn-group\" ngbDropdown placement=\"bottom\">\n        <button type=\"button\" class=\"btn btn-link text-secondary p-0\" ngbDropdownToggle>\n            <span class=\"material-symbols-outlined fw-bolder\">\n                apps\n            </span>\n        </button>\n        <div class=\"dropdown-menu-xl mt-3 appDrawerPositioning\" ngbDropdownMenu>\n            <div class=\"grid-menu grid-menu-xl grid-menu-3col\">\n                <div class=\"g-0 row\">\n\n                    <div class=\"col-sm-4 col-xl-4 border-0\" *ngFor=\"let applicationsM of applicationFilter\">\n                        <a class=\"btn\" [href]=\"appUrlBuilder(applicationsM.keyID, applicationsM.url)\" target=\"_blank\">\n\n                            <img class=\"appDrawerIcon\" [src]=\"getApplicationLogo(applicationsM.keyID)\" alt=\"{{ applicationsM.name }}\">\n                            <br />\n                            <span class=\"appDrawerName\">{{ applicationsM.name }}</span>\n                        </a>\n                    </div>\n\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n", styles: [".appDrawerPositioning{transform:translate(-355px,35px)!important;border-radius:20px}.appDrawerIcon{width:auto;height:40px;margin-bottom:10px}.appDrawerName{font-size:14px}\n"], directives: [{ type: i3.NgbDropdown, selector: "[ngbDropdown]", inputs: ["autoClose", "dropdownClass", "open", "placement", "container", "display"], outputs: ["openChange"], exportAs: ["ngbDropdown"] }, { type: i3.NgbDropdownToggle, selector: "[ngbDropdownToggle]" }, { type: i3.NgbDropdownMenu, selector: "[ngbDropdownMenu]" }, { type: i4.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: ApplicationDrawerComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'lib-application-drawer',
                    templateUrl: './application-drawer.component.html',
                    styleUrls: ['./application-drawer.component.scss']
                }]
        }], ctorParameters: function () { return [{ type: i1.StorageService }, { type: i2.ApplicationService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwbGljYXRpb24tZHJhd2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2xpYnJhcnkvdHNjLWNvbW1vbi9zcmMvbGliL3RzYy9jb21wb25lbnQvbGF5b3V0L2RyYXdlci9hcHBsaWNhdGlvbi1kcmF3ZXIvYXBwbGljYXRpb24tZHJhd2VyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2xpYnJhcnkvdHNjLWNvbW1vbi9zcmMvbGliL3RzYy9jb21wb25lbnQvbGF5b3V0L2RyYXdlci9hcHBsaWNhdGlvbi1kcmF3ZXIvYXBwbGljYXRpb24tZHJhd2VyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBRWxELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBR2hFLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQzs7Ozs7O0FBUXhELE1BQU0sT0FBTywwQkFBMEI7SUFRbkMsWUFDWSxjQUE4QixFQUM5QixrQkFBc0M7UUFEdEMsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBQzlCLHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBb0I7UUFSbEQsaUJBQVksR0FBbUIsRUFBRSxDQUFDO1FBQ2xDLHNCQUFpQixHQUFtQixFQUFFLENBQUM7UUFDdkMsbUJBQWMsR0FBUSxFQUFFLENBQUM7UUFDekIsaUJBQVksR0FBUSxFQUFFLENBQUM7UUFDdkIscUJBQWdCLEdBQVEsRUFBRSxDQUFDO0lBS3ZCLENBQUM7SUFFTCxRQUFRO1FBQ0osSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLGtCQUFrQixDQUFDLENBQUM7UUFDM0UsSUFBSSxDQUFDLGNBQWMsR0FB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SUFBSSxDQUFDLEVBQUU7WUFDM0ksR0FBRyxHQUFHLEdBQUcsTUFBTSxVQUFVLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztTQUNoRDthQUFNO1lBQ0gsR0FBRyxHQUFHLE1BQU0sQ0FBQztTQUNoQjtRQUVELE9BQU8sR0FBRyxDQUFDO0lBQ2YsQ0FBQzs7d0hBckVRLDBCQUEwQjs0R0FBMUIsMEJBQTBCLDhEQ2J2Qywwb0NBeUJBOzRGRFphLDBCQUEwQjtrQkFOdEMsU0FBUzttQkFBQztvQkFDUCxRQUFRLEVBQUUsd0JBQXdCO29CQUNsQyxXQUFXLEVBQUUscUNBQXFDO29CQUNsRCxTQUFTLEVBQUUsQ0FBQyxxQ0FBcUMsQ0FBQztpQkFDckQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBBcHBsaWNhdGlvbktleUlEIH0gZnJvbSAnQGxpYnJhcnkvYXBwbGljYXRpb24tc2VydmljZSc7XG5pbXBvcnQgeyBTdG9yYWdlU2VydmljZSB9IGZyb20gJ0BsaWJyYXJ5L3N0b3JhZ2Utc2VydmljZSc7XG5pbXBvcnQgeyBBcHBsaWNhdGlvbk0sIEFwcGxpY2F0aW9uU2VydmljZSB9IGZyb20gJ0BsaWJyYXJ5L2FwcGxpY2F0aW9uLXNlcnZpY2UnO1xuaW1wb3J0IHsgT3JnVHlwZSB9IGZyb20gJ0BsaWJyYXJ5L29yZ2FuaXphdGlvbi1zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdsaWItYXBwbGljYXRpb24tZHJhd2VyJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vYXBwbGljYXRpb24tZHJhd2VyLmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHM6IFsnLi9hcHBsaWNhdGlvbi1kcmF3ZXIuY29tcG9uZW50LnNjc3MnXVxufSlcblxuZXhwb3J0IGNsYXNzIEFwcGxpY2F0aW9uRHJhd2VyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgICBhcHBsaWNhdGlvbktleUlEOiBzdHJpbmc7XG4gICAgYXBwbGljYXRpb25NOiBBcHBsaWNhdGlvbk1bXSA9IFtdO1xuICAgIGFwcGxpY2F0aW9uRmlsdGVyOiBBcHBsaWNhdGlvbk1bXSA9IFtdO1xuICAgIGN1cnJlbnRPcmdUeXBlOiBhbnkgPSAnJztcbiAgICBjdXJyZW50T3JnSUQ6IGFueSA9ICcnO1xuICAgIGN1cnJlbnRSb290T3JnSUQ6IGFueSA9ICcnO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgc3RvcmFnZVNlcnZpY2U6IFN0b3JhZ2VTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIGFwcGxpY2F0aW9uU2VydmljZTogQXBwbGljYXRpb25TZXJ2aWNlXG4gICAgKSB7IH1cblxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uS2V5SUQgPSB0aGlzLnN0b3JhZ2VTZXJ2aWNlLmdldFN0b3JhZ2UoJ2FwcGxpY2F0aW9uS2V5SUQnKTtcbiAgICAgICAgdGhpcy5jdXJyZW50T3JnVHlwZSA9IHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0U3RvcmFnZSgnY3VycmVudE9yZ1R5cGUnKTtcbiAgICAgICAgdGhpcy5jdXJyZW50T3JnSUQgPSB0aGlzLnN0b3JhZ2VTZXJ2aWNlLmdldFN0b3JhZ2UoJ2N1cnJlbnRPcmdJRCcpO1xuICAgICAgICB0aGlzLmN1cnJlbnRSb290T3JnSUQgPSB0aGlzLnN0b3JhZ2VTZXJ2aWNlLmdldFN0b3JhZ2UoJ3Jvb3RPcmdJRCcpO1xuXG4gICAgICAgIGlmICh0aGlzLmFwcGxpY2F0aW9uS2V5SUQgPT0gQXBwbGljYXRpb25LZXlJRC5BQ0NPVU5UX0tFWV9JRCkge1xuICAgICAgICAgICAgdGhpcy5nZXRBbGxBcHBsaWNhdGlvbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5nZXRBcHBsaWNhdGlvbkJ5VXNlckFjY2VzcygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0QWxsQXBwbGljYXRpb24oKSB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb25NID0gPEFwcGxpY2F0aW9uTVtdPmF3YWl0IHRoaXMuYXBwbGljYXRpb25TZXJ2aWNlLmdldEFsbEFwcGxpY2F0aW9uKCk7XG5cbiAgICAgICAgdGhpcy5hcHBsaWNhdGlvbkZpbHRlciA9IHRoaXMuYXBwbGljYXRpb25NLmZpbHRlcihhcHBsaWNhdGlvbkZpbHRlciA9PlxuICAgICAgICAgICAgYXBwbGljYXRpb25GaWx0ZXJbJ2tleUlEJ10gIT0gQXBwbGljYXRpb25LZXlJRC5ORVRaRVJPX0FETUlOX0tFWV9JRCAmJlxuICAgICAgICAgICAgYXBwbGljYXRpb25GaWx0ZXJbJ2tleUlEJ10gIT0gQXBwbGljYXRpb25LZXlJRC5FTVBMT1lFRV9LRVlfSURcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRBcHBsaWNhdGlvbkJ5VXNlckFjY2VzcygpIHtcbiAgICAgICAgdGhpcy5hcHBsaWNhdGlvbk0gPSA8QXBwbGljYXRpb25NW10+YXdhaXQgdGhpcy5hcHBsaWNhdGlvblNlcnZpY2UuZ2V0QXBwbGljYXRpb25CeVVzZXJBY2Nlc3MoKTtcblxuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uRmlsdGVyID0gdGhpcy5hcHBsaWNhdGlvbk0uZmlsdGVyKGFwcGxpY2F0aW9uRmlsdGVyID0+XG4gICAgICAgICAgICBhcHBsaWNhdGlvbkZpbHRlclsna2V5SUQnXSAhPSB0aGlzLmFwcGxpY2F0aW9uS2V5SUQgJiZcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uRmlsdGVyWydrZXlJRCddICE9IEFwcGxpY2F0aW9uS2V5SUQuRU1QTE9ZRUVfS0VZX0lEXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgZ2V0QXBwbGljYXRpb25Mb2dvKGtleUlEOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBsZXQgbG9nbzogc3RyaW5nO1xuXG4gICAgICAgIGxvZ28gPSB0aGlzLmFwcGxpY2F0aW9uU2VydmljZS5nZXRBcHBsaWNhdGlvbkxvZ29XaXRob3V0TmFtZShrZXlJRCk7XG5cbiAgICAgICAgcmV0dXJuIGxvZ287XG4gICAgfVxuXG4gICAgYXBwVXJsQnVpbGRlcihhcHBsaWNhdGlvbktleUlEOiBBcHBsaWNhdGlvbktleUlELCBhcHBVUkw6IHN0cmluZykge1xuICAgICAgICBsZXQgdXJsOiBzdHJpbmcgPSBhcHBVUkw7XG4gICAgICAgIGxldCBvcmdMZXZlbEFwcDogQXBwbGljYXRpb25LZXlJRFtdID0gWyBBcHBsaWNhdGlvbktleUlELkFETUlOX0tFWV9JRCwgQXBwbGljYXRpb25LZXlJRC5PRkZTRVRfS0VZX0lEXTtcbiAgICAgICAgbGV0IHNpdGVMZXZlbEFwcDogQXBwbGljYXRpb25LZXlJRFtdID0gW0FwcGxpY2F0aW9uS2V5SUQuRU5FUkdZX0tFWV9JRCwgQXBwbGljYXRpb25LZXlJRC5XQVRFUl9LRVlfSUQsIEFwcGxpY2F0aW9uS2V5SUQuRU5WSVJPX0tFWV9JRF07XG4gICAgICAgIGxldCBvcmdTaXRlTGV2ZWxBcHA6IEFwcGxpY2F0aW9uS2V5SURbXSA9IFtBcHBsaWNhdGlvbktleUlELk5FVFpFUk9fS0VZX0lELCBBcHBsaWNhdGlvbktleUlELkNPTk5FQ1RfS0VZX0lEXTtcblxuICAgICAgICBpZiAob3JnTGV2ZWxBcHAuaW5jbHVkZXMoYXBwbGljYXRpb25LZXlJRCkgJiYgdGhpcy5jdXJyZW50T3JnVHlwZSA9PSBPcmdUeXBlLk9SR0FOSVpBVElPTikge1xuICAgICAgICAgICAgdXJsID0gYCR7YXBwVVJMfSZvcmdJRD0ke3RoaXMuY3VycmVudFJvb3RPcmdJRH1gO1xuICAgICAgICB9IGVsc2UgaWYgKHNpdGVMZXZlbEFwcC5pbmNsdWRlcyhhcHBsaWNhdGlvbktleUlEKSAmJiB0aGlzLmN1cnJlbnRPcmdUeXBlID09IE9yZ1R5cGUuU0lURSkge1xuICAgICAgICAgICAgdXJsID0gYCR7YXBwVVJMfSZvcmdJRD0ke3RoaXMuY3VycmVudE9yZ0lEfWA7XG4gICAgICAgIH0gZWxzZSBpZiAob3JnU2l0ZUxldmVsQXBwLmluY2x1ZGVzKGFwcGxpY2F0aW9uS2V5SUQpICYmICh0aGlzLmN1cnJlbnRPcmdUeXBlID09IE9yZ1R5cGUuT1JHQU5JWkFUSU9OIHx8IHRoaXMuY3VycmVudE9yZ1R5cGUgPT0gT3JnVHlwZS5TSVRFKSkge1xuICAgICAgICAgICAgdXJsID0gYCR7YXBwVVJMfSZvcmdJRD0ke3RoaXMuY3VycmVudE9yZ0lEfWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1cmwgPSBhcHBVUkw7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH1cblxufVxuIiwiPGRpdiBjbGFzcz1cImhlYWRlci1kb3RzXCI+XG4gICAgPGRpdiBjbGFzcz1cImJ0bi1ncm91cFwiIG5nYkRyb3Bkb3duIHBsYWNlbWVudD1cImJvdHRvbVwiPlxuICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tbGluayB0ZXh0LXNlY29uZGFyeSBwLTBcIiBuZ2JEcm9wZG93blRvZ2dsZT5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZCBmdy1ib2xkZXJcIj5cbiAgICAgICAgICAgICAgICBhcHBzXG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZHJvcGRvd24tbWVudS14bCBtdC0zIGFwcERyYXdlclBvc2l0aW9uaW5nXCIgbmdiRHJvcGRvd25NZW51PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImdyaWQtbWVudSBncmlkLW1lbnUteGwgZ3JpZC1tZW51LTNjb2xcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZy0wIHJvd1wiPlxuXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtc20tNCBjb2wteGwtNCBib3JkZXItMFwiICpuZ0Zvcj1cImxldCBhcHBsaWNhdGlvbnNNIG9mIGFwcGxpY2F0aW9uRmlsdGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz1cImJ0blwiIFtocmVmXT1cImFwcFVybEJ1aWxkZXIoYXBwbGljYXRpb25zTS5rZXlJRCwgYXBwbGljYXRpb25zTS51cmwpXCIgdGFyZ2V0PVwiX2JsYW5rXCI+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIGNsYXNzPVwiYXBwRHJhd2VySWNvblwiIFtzcmNdPVwiZ2V0QXBwbGljYXRpb25Mb2dvKGFwcGxpY2F0aW9uc00ua2V5SUQpXCIgYWx0PVwie3sgYXBwbGljYXRpb25zTS5uYW1lIH19XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJhcHBEcmF3ZXJOYW1lXCI+e3sgYXBwbGljYXRpb25zTS5uYW1lIH19PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuPC9kaXY+XG4iXX0=