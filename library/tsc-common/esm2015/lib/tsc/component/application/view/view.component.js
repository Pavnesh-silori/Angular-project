import { __awaiter } from "tslib";
import { Component } from '@angular/core';
import { ApplicationKeyID, Application, UserApplication } from '@library/application-service';
import { User } from '@library/user-service';
import * as i0 from "@angular/core";
import * as i1 from "@library/storage-service";
import * as i2 from "@library/application-service";
import * as i3 from "@library/user-service";
import * as i4 from "@angular/material/card";
import * as i5 from "@angular/flex-layout/flex";
import * as i6 from "@angular/common";
// /library/
export class ViewComponent {
    constructor(storageService, applicationService, userService) {
        this.storageService = storageService;
        this.applicationService = applicationService;
        this.userService = userService;
        this.isCurrentAppIsAccount = false;
        this.applicationFilter = [new Application()];
        this.excludeApplicationKeyID = [ApplicationKeyID.ADMIN_KEY_ID, ApplicationKeyID.NETZERO_ADMIN_KEY_ID, ApplicationKeyID.EMPLOYEE_KEY_ID];
        // userApplicationM: UserApplicationM[];
        this.userApplicationM = [new UserApplication()];
        this.userM = new User();
    }
    ngOnInit() {
        this.currentOrgID = this.storageService.getStorage(['currentOrgID']);
        this.currentAppKeyID = this.storageService.getStorage(['applicationKeyID']);
        this.userID = this.storageService.getStorage(['userID']);
        this.isCurrentAppIsAccountFnc(this.currentAppKeyID);
        this.getAllApplication();
        this.getUserByID();
        if (!this.isCurrentAppIsAccount) {
            this.getApplicationByUserAccess();
        }
    }
    getAllApplication() {
        return __awaiter(this, void 0, void 0, function* () {
            this.applicationM = (yield this.applicationService.getAllApplication());
            this.applicationFilter = this.applicationM.filter((applicationres) => !this.excludeApplicationKeyID.includes(applicationres.keyID));
        });
    }
    getApplicationByUserAccess() {
        return __awaiter(this, void 0, void 0, function* () {
            this.userApplicationM = (yield this.applicationService.getSubscribedApplicationsByOrgID(this.currentOrgID));
        });
    }
    getUserByID() {
        return __awaiter(this, void 0, void 0, function* () {
            this.userM = (yield this.userService.getUserByID(this.userID));
        });
    }
    getApplicationLogoWithoutName(keyID) {
        let logo;
        logo = this.applicationService.getApplicationLogoWithoutName(keyID);
        return logo;
    }
    isCurrentAppIsAccountFnc(appKeyID) {
        this.isCurrentAppIsAccount = appKeyID == ApplicationKeyID.ACCOUNT_KEY_ID ? true : false;
    }
    isAccess(applicationID) {
        return this.userApplicationM.some(item => item.id == applicationID);
    }
}
ViewComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: ViewComponent, deps: [{ token: i1.StorageService }, { token: i2.ApplicationService }, { token: i3.UserService }], target: i0.ɵɵFactoryTarget.Component });
ViewComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.17", type: ViewComponent, selector: "app-view", ngImport: i0, template: "<div class=\"card main-card cardOverwrite h100 mb-4 appTile\">\n    <div class=\"headerContainer\">\n        <div class=\"headerLeftContainer\">\n            <div class=\"pageTitle\">\n                Hello {{ userM.firstName }}{{ userM.lastName ? ' ' + userM.lastName : ''}}, welcome to The\n                Sustainability Cloud! <img class=\"celebrateEmoji\" src=\"/assets/images/celebrate-emoji.png\">\n            </div>\n            <div class=\"pageSubtitle\">\n                Let's transition your business to netzero.\n            </div>\n        </div>\n    </div>\n\n    <div class=\"card-body\">\n        <div fxLayout=\"row wrap\" fxLayoutGap=\"20px grid\">\n            <div class=\"appCardOuter\" fxFlex=\"50%\" fxFlex.xs=\"50%\" fxFlex.sm=\"50%\"\n                *ngFor=\"let applications of applicationFilter\">\n\n                <a href=\"{{ applications.url }}\" target=\"_blank\">\n                    <mat-card class=\"border appCardInner cardOverwrite cursorPointer matHeader\">\n                        <div class=\"row\">\n                            <div class=\"col-sm-3\">\n                                <span class=\"centerAlign\">\n                                    <img class=\"appImg\" [src]=\"getApplicationLogoWithoutName(applications.keyID)\"\n                                        alt=\"{{ applications.name }}\">\n                                </span>\n                            </div>\n                            <div class=\"col-sm-9\">\n                                <mat-card-header>\n                                    <mat-card-title-group>\n                                        <mat-card-title class=\"ps-0\">\n                                            <p class=\"fs-4 fw-bold\">\n                                                {{ applications.name }}\n                                                <span *ngIf=\"!isCurrentAppIsAccount && isAccess(applications.id)\">\n                                                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\"\n                                                        class=\"check-circle-fill flex-shrink-0 me-2 mb-2 ms-2 tickIcon text-success\"\n                                                        viewBox=\"0 0 16 16\" role=\"img\" aria-label=\"Success:\">\n                                                        <path\n                                                            d=\"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z\" />\n                                                    </svg>\n                                                </span>\n                                            </p>\n                                        </mat-card-title>\n                                    </mat-card-title-group>\n                                </mat-card-header>\n                                <mat-card-content>\n                                    <p>{{ applications.description }}</p>\n                                </mat-card-content>\n                            </div>\n                        </div>\n                    </mat-card>\n                </a>\n\n            </div>\n        </div>\n    </div>\n</div>\n", styles: [".appTile .celebrateEmoji{max-width:20px}.appTile .appImg{max-width:70%;height:auto}.appTile .appCardOuter .mat-card{min-height:70px!important}.appTile .appCardInner{height:8rem;transition:all .3s cubic-bezier(.25,.8,.25,1)}.appTile .appCardInner:hover{box-shadow:0 1px 20px #0000,0 10px 10px #0000000d!important}.appTile .mat-card-subtitle,.appTile .mat-card-content{font-size:13px}.appTile .mat-card-title{font-size:16px!important;margin:0!important;color:#495057}.appTile .mat-card-title p{margin-bottom:0!important}.appTile .mat-card-content{color:gray}.appTile .tickIcon{width:24px;height:24px}\n"], components: [{ type: i4.MatCard, selector: "mat-card", exportAs: ["matCard"] }, { type: i4.MatCardHeader, selector: "mat-card-header" }, { type: i4.MatCardTitleGroup, selector: "mat-card-title-group" }], directives: [{ type: i5.DefaultLayoutDirective, selector: "  [fxLayout], [fxLayout.xs], [fxLayout.sm], [fxLayout.md],  [fxLayout.lg], [fxLayout.xl], [fxLayout.lt-sm], [fxLayout.lt-md],  [fxLayout.lt-lg], [fxLayout.lt-xl], [fxLayout.gt-xs], [fxLayout.gt-sm],  [fxLayout.gt-md], [fxLayout.gt-lg]", inputs: ["fxLayout", "fxLayout.xs", "fxLayout.sm", "fxLayout.md", "fxLayout.lg", "fxLayout.xl", "fxLayout.lt-sm", "fxLayout.lt-md", "fxLayout.lt-lg", "fxLayout.lt-xl", "fxLayout.gt-xs", "fxLayout.gt-sm", "fxLayout.gt-md", "fxLayout.gt-lg"] }, { type: i5.DefaultLayoutGapDirective, selector: "  [fxLayoutGap], [fxLayoutGap.xs], [fxLayoutGap.sm], [fxLayoutGap.md],  [fxLayoutGap.lg], [fxLayoutGap.xl], [fxLayoutGap.lt-sm], [fxLayoutGap.lt-md],  [fxLayoutGap.lt-lg], [fxLayoutGap.lt-xl], [fxLayoutGap.gt-xs], [fxLayoutGap.gt-sm],  [fxLayoutGap.gt-md], [fxLayoutGap.gt-lg]", inputs: ["fxLayoutGap", "fxLayoutGap.xs", "fxLayoutGap.sm", "fxLayoutGap.md", "fxLayoutGap.lg", "fxLayoutGap.xl", "fxLayoutGap.lt-sm", "fxLayoutGap.lt-md", "fxLayoutGap.lt-lg", "fxLayoutGap.lt-xl", "fxLayoutGap.gt-xs", "fxLayoutGap.gt-sm", "fxLayoutGap.gt-md", "fxLayoutGap.gt-lg"] }, { type: i6.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i5.DefaultFlexDirective, selector: "  [fxFlex], [fxFlex.xs], [fxFlex.sm], [fxFlex.md],  [fxFlex.lg], [fxFlex.xl], [fxFlex.lt-sm], [fxFlex.lt-md],  [fxFlex.lt-lg], [fxFlex.lt-xl], [fxFlex.gt-xs], [fxFlex.gt-sm],  [fxFlex.gt-md], [fxFlex.gt-lg]", inputs: ["fxFlex", "fxFlex.xs", "fxFlex.sm", "fxFlex.md", "fxFlex.lg", "fxFlex.xl", "fxFlex.lt-sm", "fxFlex.lt-md", "fxFlex.lt-lg", "fxFlex.lt-xl", "fxFlex.gt-xs", "fxFlex.gt-sm", "fxFlex.gt-md", "fxFlex.gt-lg"] }, { type: i4.MatCardTitle, selector: "mat-card-title, [mat-card-title], [matCardTitle]" }, { type: i6.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i4.MatCardContent, selector: "mat-card-content, [mat-card-content], [matCardContent]" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.17", ngImport: i0, type: ViewComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'app-view',
                    templateUrl: './view.component.html',
                    styleUrls: ['./view.component.scss'
                    ]
                }]
        }], ctorParameters: function () { return [{ type: i1.StorageService }, { type: i2.ApplicationService }, { type: i3.UserService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlldy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9saWJyYXJ5L3RzYy1jb21tb24vc3JjL2xpYi90c2MvY29tcG9uZW50L2FwcGxpY2F0aW9uL3ZpZXcvdmlldy5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9saWJyYXJ5L3RzYy1jb21tb24vc3JjL2xpYi90c2MvY29tcG9uZW50L2FwcGxpY2F0aW9uL3ZpZXcvdmlldy5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxNQUFNLGVBQWUsQ0FBQztBQUtsRCxPQUFPLEVBQ0gsZ0JBQWdCLEVBRWhCLFdBQVcsRUFFWCxlQUFlLEVBRWxCLE1BQU0sOEJBQThCLENBQUM7QUFFdEMsT0FBTyxFQUVILElBQUksRUFFUCxNQUFNLHVCQUF1QixDQUFDOzs7Ozs7OztBQUMvQixZQUFZO0FBU1osTUFBTSxPQUFPLGFBQWE7SUFjdEIsWUFDWSxjQUE4QixFQUM5QixrQkFBc0MsRUFDdEMsV0FBd0I7UUFGeEIsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBQzlCLHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBb0I7UUFDdEMsZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFkcEMsMEJBQXFCLEdBQVksS0FBSyxDQUFDO1FBR3ZDLHNCQUFpQixHQUFHLENBQUMsSUFBSSxXQUFXLEVBQUUsQ0FBQyxDQUFDO1FBQ3hDLDRCQUF1QixHQUFhLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxFQUFFLGdCQUFnQixDQUFDLG9CQUFvQixFQUFFLGdCQUFnQixDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQzdJLHdDQUF3QztRQUN4QyxxQkFBZ0IsR0FBRyxDQUFDLElBQUksZUFBZSxFQUFFLENBQUMsQ0FBQztRQUczQyxVQUFLLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztJQU1mLENBQUM7SUFFTCxRQUFRO1FBQ0osSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUM7UUFDckUsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQztRQUM1RSxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUV6RCxJQUFJLENBQUMsd0JBQXdCLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ3BELElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUVuQixJQUFJLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFO1lBQzdCLElBQUksQ0FBQywwQkFBMEIsRUFBRSxDQUFDO1NBQ3JDO0lBQ0wsQ0FBQztJQUVLLGlCQUFpQjs7WUFDbkIsSUFBSSxDQUFDLFlBQVksSUFBbUIsTUFBTSxJQUFJLENBQUMsa0JBQWtCLENBQUMsaUJBQWlCLEVBQUUsQ0FBQSxDQUFDO1lBRXRGLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQTRCLEVBQUUsRUFBRSxDQUMvRSxDQUFDLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUMvRCxDQUFDO1FBQ04sQ0FBQztLQUFBO0lBRUssMEJBQTBCOztZQUM1QixJQUFJLENBQUMsZ0JBQWdCLElBQXVCLE1BQU0sSUFBSSxDQUFDLGtCQUFrQixDQUFDLGdDQUFnQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQSxDQUFDO1FBQ2xJLENBQUM7S0FBQTtJQUVLLFdBQVc7O1lBQ2IsSUFBSSxDQUFDLEtBQUssSUFBVSxNQUFNLElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQSxDQUFDO1FBQ3hFLENBQUM7S0FBQTtJQUVELDZCQUE2QixDQUFDLEtBQWE7UUFDdkMsSUFBSSxJQUFZLENBQUM7UUFDakIsSUFBSSxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyw2QkFBNkIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNwRSxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBRUQsd0JBQXdCLENBQUMsUUFBUTtRQUM3QixJQUFJLENBQUMscUJBQXFCLEdBQUcsUUFBUSxJQUFJLGdCQUFnQixDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7SUFDNUYsQ0FBQztJQUVELFFBQVEsQ0FBQyxhQUFhO1FBQ2xCLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksYUFBYSxDQUFDLENBQUM7SUFDeEUsQ0FBQzs7MkdBOURRLGFBQWE7K0ZBQWIsYUFBYSxnREM1QjFCLDZ2R0F5REE7NEZEN0JhLGFBQWE7a0JBUHpCLFNBQVM7bUJBQUM7b0JBQ1AsUUFBUSxFQUFFLFVBQVU7b0JBQ3BCLFdBQVcsRUFBRSx1QkFBdUI7b0JBQ3BDLFNBQVMsRUFBRSxDQUFDLHVCQUF1QjtxQkFDbEM7aUJBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG4vLyBsaWJyYXJ5XG5pbXBvcnQgeyBTdG9yYWdlU2VydmljZSB9IGZyb20gJ0BsaWJyYXJ5L3N0b3JhZ2Utc2VydmljZSc7XG5cbmltcG9ydCB7XG4gICAgQXBwbGljYXRpb25LZXlJRCxcbiAgICBBcHBsaWNhdGlvbk0sXG4gICAgQXBwbGljYXRpb24sXG4gICAgVXNlckFwcGxpY2F0aW9uTSxcbiAgICBVc2VyQXBwbGljYXRpb24sXG4gICAgQXBwbGljYXRpb25TZXJ2aWNlXG59IGZyb20gJ0BsaWJyYXJ5L2FwcGxpY2F0aW9uLXNlcnZpY2UnO1xuXG5pbXBvcnQge1xuICAgIFVzZXJNLFxuICAgIFVzZXIsXG4gICAgVXNlclNlcnZpY2Vcbn0gZnJvbSAnQGxpYnJhcnkvdXNlci1zZXJ2aWNlJztcbi8vIC9saWJyYXJ5L1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2FwcC12aWV3JyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vdmlldy5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vdmlldy5jb21wb25lbnQuc2NzcydcbiAgICBdXG59KVxuXG5leHBvcnQgY2xhc3MgVmlld0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gICAgY3VycmVudE9yZ0lEOiBhbnk7XG4gICAgY3VycmVudEFwcEtleUlEOiBzdHJpbmc7XG4gICAgaXNDdXJyZW50QXBwSXNBY2NvdW50OiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBhcHBsaWNhdGlvbk06IEFwcGxpY2F0aW9uTVtdO1xuICAgIGFwcGxpY2F0aW9uRmlsdGVyID0gW25ldyBBcHBsaWNhdGlvbigpXTtcbiAgICBleGNsdWRlQXBwbGljYXRpb25LZXlJRDogc3RyaW5nW10gPSBbQXBwbGljYXRpb25LZXlJRC5BRE1JTl9LRVlfSUQsIEFwcGxpY2F0aW9uS2V5SUQuTkVUWkVST19BRE1JTl9LRVlfSUQsIEFwcGxpY2F0aW9uS2V5SUQuRU1QTE9ZRUVfS0VZX0lEXTtcbiAgICAvLyB1c2VyQXBwbGljYXRpb25NOiBVc2VyQXBwbGljYXRpb25NW107XG4gICAgdXNlckFwcGxpY2F0aW9uTSA9IFtuZXcgVXNlckFwcGxpY2F0aW9uKCldO1xuXG4gICAgdXNlcklEOiBhbnk7XG4gICAgdXNlck0gPSBuZXcgVXNlcigpO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgc3RvcmFnZVNlcnZpY2U6IFN0b3JhZ2VTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIGFwcGxpY2F0aW9uU2VydmljZTogQXBwbGljYXRpb25TZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIHVzZXJTZXJ2aWNlOiBVc2VyU2VydmljZVxuICAgICkgeyB9XG5cbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jdXJyZW50T3JnSUQgPSB0aGlzLnN0b3JhZ2VTZXJ2aWNlLmdldFN0b3JhZ2UoWydjdXJyZW50T3JnSUQnXSk7XG4gICAgICAgIHRoaXMuY3VycmVudEFwcEtleUlEID0gdGhpcy5zdG9yYWdlU2VydmljZS5nZXRTdG9yYWdlKFsnYXBwbGljYXRpb25LZXlJRCddKTtcbiAgICAgICAgdGhpcy51c2VySUQgPSB0aGlzLnN0b3JhZ2VTZXJ2aWNlLmdldFN0b3JhZ2UoWyd1c2VySUQnXSk7XG5cbiAgICAgICAgdGhpcy5pc0N1cnJlbnRBcHBJc0FjY291bnRGbmModGhpcy5jdXJyZW50QXBwS2V5SUQpO1xuICAgICAgICB0aGlzLmdldEFsbEFwcGxpY2F0aW9uKCk7XG4gICAgICAgIHRoaXMuZ2V0VXNlckJ5SUQoKTtcblxuICAgICAgICBpZiAoIXRoaXMuaXNDdXJyZW50QXBwSXNBY2NvdW50KSB7XG4gICAgICAgICAgICB0aGlzLmdldEFwcGxpY2F0aW9uQnlVc2VyQWNjZXNzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBnZXRBbGxBcHBsaWNhdGlvbigpIHtcbiAgICAgICAgdGhpcy5hcHBsaWNhdGlvbk0gPSA8QXBwbGljYXRpb25NW10+YXdhaXQgdGhpcy5hcHBsaWNhdGlvblNlcnZpY2UuZ2V0QWxsQXBwbGljYXRpb24oKTtcblxuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uRmlsdGVyID0gdGhpcy5hcHBsaWNhdGlvbk0uZmlsdGVyKChhcHBsaWNhdGlvbnJlczogQXBwbGljYXRpb25NKSA9PlxuICAgICAgICAgICAgIXRoaXMuZXhjbHVkZUFwcGxpY2F0aW9uS2V5SUQuaW5jbHVkZXMoYXBwbGljYXRpb25yZXMua2V5SUQpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0QXBwbGljYXRpb25CeVVzZXJBY2Nlc3MoKSB7XG4gICAgICAgIHRoaXMudXNlckFwcGxpY2F0aW9uTSA9IDxVc2VyQXBwbGljYXRpb25NW10+YXdhaXQgdGhpcy5hcHBsaWNhdGlvblNlcnZpY2UuZ2V0U3Vic2NyaWJlZEFwcGxpY2F0aW9uc0J5T3JnSUQodGhpcy5jdXJyZW50T3JnSUQpO1xuICAgIH1cblxuICAgIGFzeW5jIGdldFVzZXJCeUlEKCkge1xuICAgICAgICB0aGlzLnVzZXJNID0gPFVzZXJNPmF3YWl0IHRoaXMudXNlclNlcnZpY2UuZ2V0VXNlckJ5SUQodGhpcy51c2VySUQpO1xuICAgIH1cblxuICAgIGdldEFwcGxpY2F0aW9uTG9nb1dpdGhvdXROYW1lKGtleUlEOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBsZXQgbG9nbzogc3RyaW5nO1xuICAgICAgICBsb2dvID0gdGhpcy5hcHBsaWNhdGlvblNlcnZpY2UuZ2V0QXBwbGljYXRpb25Mb2dvV2l0aG91dE5hbWUoa2V5SUQpO1xuICAgICAgICByZXR1cm4gbG9nbztcbiAgICB9XG5cbiAgICBpc0N1cnJlbnRBcHBJc0FjY291bnRGbmMoYXBwS2V5SUQpIHtcbiAgICAgICAgdGhpcy5pc0N1cnJlbnRBcHBJc0FjY291bnQgPSBhcHBLZXlJRCA9PSBBcHBsaWNhdGlvbktleUlELkFDQ09VTlRfS0VZX0lEID8gdHJ1ZSA6IGZhbHNlO1xuICAgIH1cblxuICAgIGlzQWNjZXNzKGFwcGxpY2F0aW9uSUQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudXNlckFwcGxpY2F0aW9uTS5zb21lKGl0ZW0gPT4gaXRlbS5pZCA9PSBhcHBsaWNhdGlvbklEKTtcbiAgICB9XG5cbn1cbiIsIjxkaXYgY2xhc3M9XCJjYXJkIG1haW4tY2FyZCBjYXJkT3ZlcndyaXRlIGgxMDAgbWItNCBhcHBUaWxlXCI+XG4gICAgPGRpdiBjbGFzcz1cImhlYWRlckNvbnRhaW5lclwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaGVhZGVyTGVmdENvbnRhaW5lclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInBhZ2VUaXRsZVwiPlxuICAgICAgICAgICAgICAgIEhlbGxvIHt7IHVzZXJNLmZpcnN0TmFtZSB9fXt7IHVzZXJNLmxhc3ROYW1lID8gJyAnICsgdXNlck0ubGFzdE5hbWUgOiAnJ319LCB3ZWxjb21lIHRvIFRoZVxuICAgICAgICAgICAgICAgIFN1c3RhaW5hYmlsaXR5IENsb3VkISA8aW1nIGNsYXNzPVwiY2VsZWJyYXRlRW1vamlcIiBzcmM9XCIvYXNzZXRzL2ltYWdlcy9jZWxlYnJhdGUtZW1vamkucG5nXCI+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwYWdlU3VidGl0bGVcIj5cbiAgICAgICAgICAgICAgICBMZXQncyB0cmFuc2l0aW9uIHlvdXIgYnVzaW5lc3MgdG8gbmV0emVyby5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJjYXJkLWJvZHlcIj5cbiAgICAgICAgPGRpdiBmeExheW91dD1cInJvdyB3cmFwXCIgZnhMYXlvdXRHYXA9XCIyMHB4IGdyaWRcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhcHBDYXJkT3V0ZXJcIiBmeEZsZXg9XCI1MCVcIiBmeEZsZXgueHM9XCI1MCVcIiBmeEZsZXguc209XCI1MCVcIlxuICAgICAgICAgICAgICAgICpuZ0Zvcj1cImxldCBhcHBsaWNhdGlvbnMgb2YgYXBwbGljYXRpb25GaWx0ZXJcIj5cblxuICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJ7eyBhcHBsaWNhdGlvbnMudXJsIH19XCIgdGFyZ2V0PVwiX2JsYW5rXCI+XG4gICAgICAgICAgICAgICAgICAgIDxtYXQtY2FyZCBjbGFzcz1cImJvcmRlciBhcHBDYXJkSW5uZXIgY2FyZE92ZXJ3cml0ZSBjdXJzb3JQb2ludGVyIG1hdEhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInJvd1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtc20tM1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImNlbnRlckFsaWduXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIGNsYXNzPVwiYXBwSW1nXCIgW3NyY109XCJnZXRBcHBsaWNhdGlvbkxvZ29XaXRob3V0TmFtZShhcHBsaWNhdGlvbnMua2V5SUQpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHQ9XCJ7eyBhcHBsaWNhdGlvbnMubmFtZSB9fVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbC1zbS05XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxtYXQtY2FyZC1oZWFkZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bWF0LWNhcmQtdGl0bGUtZ3JvdXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG1hdC1jYXJkLXRpdGxlIGNsYXNzPVwicHMtMFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cImZzLTQgZnctYm9sZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgYXBwbGljYXRpb25zLm5hbWUgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwiIWlzQ3VycmVudEFwcElzQWNjb3VudCAmJiBpc0FjY2VzcyhhcHBsaWNhdGlvbnMuaWQpXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiY2hlY2stY2lyY2xlLWZpbGwgZmxleC1zaHJpbmstMCBtZS0yIG1iLTIgbXMtMiB0aWNrSWNvbiB0ZXh0LXN1Y2Nlc3NcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3Qm94PVwiMCAwIDE2IDE2XCIgcm9sZT1cImltZ1wiIGFyaWEtbGFiZWw9XCJTdWNjZXNzOlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZD1cIk0xNiA4QTggOCAwIDEgMSAwIDhhOCA4IDAgMCAxIDE2IDB6bS0zLjk3LTMuMDNhLjc1Ljc1IDAgMCAwLTEuMDguMDIyTDcuNDc3IDkuNDE3IDUuMzg0IDcuMzIzYS43NS43NSAwIDAgMC0xLjA2IDEuMDZMNi45NyAxMS4wM2EuNzUuNzUgMCAwIDAgMS4wNzktLjAybDMuOTkyLTQuOTlhLjc1Ljc1IDAgMCAwLS4wMS0xLjA1elwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L21hdC1jYXJkLXRpdGxlPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9tYXQtY2FyZC10aXRsZS1ncm91cD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9tYXQtY2FyZC1oZWFkZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxtYXQtY2FyZC1jb250ZW50PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+e3sgYXBwbGljYXRpb25zLmRlc2NyaXB0aW9uIH19PC9wPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L21hdC1jYXJkLWNvbnRlbnQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9tYXQtY2FyZD5cbiAgICAgICAgICAgICAgICA8L2E+XG5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbjwvZGl2PlxuIl19