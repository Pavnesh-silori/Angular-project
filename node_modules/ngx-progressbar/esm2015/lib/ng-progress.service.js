import { Injectable, Inject, Optional } from '@angular/core';
import { NgProgressRef } from './ng-progress-ref';
import { NG_PROGRESS_CONFIG } from './ng-progress.interface';
import * as i0 from "@angular/core";
import * as i1 from "./ng-progress.interface";
import * as ɵngcc0 from '@angular/core';
const ɵ0 = (n) => {
    if (n >= 0 && n < 20)
        return 10;
    if (n >= 20 && n < 50)
        return 4;
    if (n >= 50 && n < 80)
        return 2;
    if (n >= 80 && n < 99)
        return 0.5;
    return 0;
};
const defaultConfig = {
    min: 8,
    max: 100,
    speed: 200,
    debounceTime: 0,
    trickleSpeed: 300,
    fixed: true,
    meteor: true,
    thick: false,
    spinner: true,
    ease: 'linear',
    color: '#1B95E0',
    direction: 'ltr+',
    spinnerPosition: 'right',
    trickleFunc: ɵ0
};
export class NgProgress {
    constructor(config) {
        // Store progress bar instances
        this._instances = new Map();
        this.config = config ? Object.assign(Object.assign({}, defaultConfig), config) : defaultConfig;
    }
    /**
     * Get or Create progress bar by ID
     */
    ref(id = 'root', config) {
        if (this._instances.has(id)) {
            // Get ProgressRef instance
            const progressRef = this._instances.get(id);
            if (config) {
                progressRef.setConfig(Object.assign(Object.assign({}, this.config), config));
            }
            return progressRef;
        }
        else {
            // Create new ProgressRef instance
            const progressRef = new NgProgressRef(Object.assign(Object.assign({}, this.config), config), this.deleteInstance(id));
            return this._instances.set(id, progressRef).get(id);
        }
    }
    /**
     * Destroy all progress bar instances
     */
    destroyAll() {
        this._instances.forEach((ref) => ref.destroy());
    }
    /**
     * A destroyer function for each progress bar instance
     */
    deleteInstance(id) {
        return () => {
            this._instances.delete(id);
        };
    }
}
NgProgress.ɵfac = function NgProgress_Factory(t) { return new (t || NgProgress)(ɵngcc0.ɵɵinject(NG_PROGRESS_CONFIG, 8)); };
NgProgress.ɵprov = i0.ɵɵdefineInjectable({ factory: function NgProgress_Factory() { return new NgProgress(i0.ɵɵinject(i1.NG_PROGRESS_CONFIG, 8)); }, token: NgProgress, providedIn: "root" });
NgProgress.ctorParameters = () => [
    { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [NG_PROGRESS_CONFIG,] }] }
];
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(NgProgress, [{
        type: Injectable,
        args: [{
                providedIn: 'root'
            }]
    }], function () { return [{ type: undefined, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [NG_PROGRESS_CONFIG]
            }] }]; }, null); })();
export { ɵ0 };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmctcHJvZ3Jlc3Muc2VydmljZS5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LXByb2dyZXNzYmFyL3NyYy9saWIvbmctcHJvZ3Jlc3Muc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDN0QsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBb0Msa0JBQWtCLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUMvRjtBQUNvQzs7QUFJN0IsV0FVUSxDQUFDLENBQVMsRUFBVSxFQUFFO0FBQ3JDLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFO0FBQUUsUUFBQSxPQUFPLEVBQUUsQ0FBQztBQUNwQyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTtBQUFFLFFBQUEsT0FBTyxDQUFDLENBQUM7QUFDcEMsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUU7QUFBRSxRQUFBLE9BQU8sQ0FBQyxDQUFDO0FBQ3BDLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFO0FBQUUsUUFBQSxPQUFPLEdBQUcsQ0FBQztBQUN0QyxJQUFJLE9BQU8sQ0FBQyxDQUFDO0FBQ1gsQ0FBQztBQXBCSCxNQUFNLGFBQWEsR0FBbUI7QUFDdEMsSUFBRSxHQUFHLEVBQUUsQ0FBQztBQUNSLElBQUUsR0FBRyxFQUFFLEdBQUc7QUFDVixJQUFFLEtBQUssRUFBRSxHQUFHO0FBQ1osSUFBRSxZQUFZLEVBQUUsQ0FBQztBQUNqQixJQUFFLFlBQVksRUFBRSxHQUFHO0FBQ25CLElBQUUsS0FBSyxFQUFFLElBQUk7QUFDYixJQUFFLE1BQU0sRUFBRSxJQUFJO0FBQ2QsSUFBRSxLQUFLLEVBQUUsS0FBSztBQUNkLElBQUUsT0FBTyxFQUFFLElBQUk7QUFDZixJQUFFLElBQUksRUFBRSxRQUFRO0FBQ2hCLElBQUUsS0FBSyxFQUFFLFNBQVM7QUFDbEIsSUFBRSxTQUFTLEVBQUUsTUFBTTtBQUNuQixJQUFFLGVBQWUsRUFBRSxPQUFPO0FBQzFCLElBQUUsV0FBVyxJQU1WO0FBQ0gsQ0FBQyxDQUFDO0FBS0YsTUFBTSxPQUFPLFVBQVU7QUFDdkIsSUFPRSxZQUFvRCxNQUF3QjtBQUM5RSxRQVBFLCtCQUErQjtBQUNqQyxRQUFtQixlQUFVLEdBQUcsSUFBSSxHQUFHLEVBQXlCLENBQUM7QUFDakUsUUFLSSxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxDQUFDLGlDQUFNLGFBQWEsR0FBSyxNQUFNLEVBQUcsQ0FBQyxDQUFDLGFBQWEsQ0FBQztBQUMzRSxJQUFFLENBQUM7QUFDSCxJQUNFO0FBQ0Y7QUFDRSxPQUFHO0FBQ0wsSUFBRSxHQUFHLENBQUMsRUFBRSxHQUFHLE1BQU0sRUFBRSxNQUF5QjtBQUFJLFFBQzVDLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUU7QUFDakMsWUFBTSwyQkFBMkI7QUFDakMsWUFBTSxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQWtCLENBQUM7QUFDbkUsWUFBTSxJQUFJLE1BQU0sRUFBRTtBQUNsQixnQkFBUSxXQUFXLENBQUMsU0FBUyxpQ0FBTSxJQUFJLENBQUMsTUFBTSxHQUFLLE1BQU0sRUFBRyxDQUFDO0FBQzdELGFBQU87QUFDUCxZQUFNLE9BQU8sV0FBNEIsQ0FBQztBQUMxQyxTQUFLO0FBQUMsYUFBSztBQUNYLFlBQU0sa0NBQWtDO0FBQ3hDLFlBQU0sTUFBTSxXQUFXLEdBQUcsSUFBSSxhQUFhLGlDQUFNLElBQUksQ0FBQyxNQUFNLEdBQUssTUFBTSxHQUFJLElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztBQUNwRyxZQUFNLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFFLFdBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQWtCLENBQUM7QUFDM0UsU0FBSztBQUNMLElBQUUsQ0FBQztBQUNILElBQ0U7QUFDRjtBQUNFLE9BQUc7QUFDTCxJQUFFLFVBQVU7QUFDWixRQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBa0IsRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7QUFDbkUsSUFBRSxDQUFDO0FBQ0gsSUFDRTtBQUNGO0FBQ0UsT0FBRztBQUNMLElBQVUsY0FBYyxDQUFDLEVBQVU7QUFBSSxRQUNuQyxPQUFPLEdBQUcsRUFBRTtBQUNoQixZQUFNLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ2pDLFFBQUksQ0FBQyxDQUFDO0FBQ04sSUFBRSxDQUFDO0FBQ0g7MkhBQUM7QUFDRCw4TEE5Q0s7QUFBQztFQUhMLFVBQVUsU0FBQyxrQkFDVixVQUFVLEVBQUUsTUFBTSxjQUNuQix2RUFHYyw0Q0FNQSxRQUFRLFlBQUksTUFBTSxTQUFDLGtCQUFrQjtBQUFROzs7Ozs7Ozs7OztrQ0FBRTtBQUFDO0FBQWUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3QsIE9wdGlvbmFsIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBOZ1Byb2dyZXNzUmVmIH0gZnJvbSAnLi9uZy1wcm9ncmVzcy1yZWYnO1xuaW1wb3J0IHsgTmdQcm9ncmVzc0NvbmZpZywgUHJvZ3Jlc3NDb25maWcsIE5HX1BST0dSRVNTX0NPTkZJRyB9IGZyb20gJy4vbmctcHJvZ3Jlc3MuaW50ZXJmYWNlJztcblxuY29uc3QgZGVmYXVsdENvbmZpZzogUHJvZ3Jlc3NDb25maWcgPSB7XG4gIG1pbjogOCxcbiAgbWF4OiAxMDAsXG4gIHNwZWVkOiAyMDAsXG4gIGRlYm91bmNlVGltZTogMCxcbiAgdHJpY2tsZVNwZWVkOiAzMDAsXG4gIGZpeGVkOiB0cnVlLFxuICBtZXRlb3I6IHRydWUsXG4gIHRoaWNrOiBmYWxzZSxcbiAgc3Bpbm5lcjogdHJ1ZSxcbiAgZWFzZTogJ2xpbmVhcicsXG4gIGNvbG9yOiAnIzFCOTVFMCcsXG4gIGRpcmVjdGlvbjogJ2x0cisnLFxuICBzcGlubmVyUG9zaXRpb246ICdyaWdodCcsXG4gIHRyaWNrbGVGdW5jOiAobjogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgICBpZiAobiA+PSAwICYmIG4gPCAyMCkgcmV0dXJuIDEwO1xuICAgIGlmIChuID49IDIwICYmIG4gPCA1MCkgcmV0dXJuIDQ7XG4gICAgaWYgKG4gPj0gNTAgJiYgbiA8IDgwKSByZXR1cm4gMjtcbiAgICBpZiAobiA+PSA4MCAmJiBuIDwgOTkpIHJldHVybiAwLjU7XG4gICAgcmV0dXJuIDA7XG4gIH1cbn07XG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIE5nUHJvZ3Jlc3Mge1xuXG4gIC8vIFN0b3JlIHByb2dyZXNzIGJhciBpbnN0YW5jZXNcbiAgcHJpdmF0ZSByZWFkb25seSBfaW5zdGFuY2VzID0gbmV3IE1hcDxzdHJpbmcsIE5nUHJvZ3Jlc3NSZWY+KCk7XG5cbiAgLy8gR2xvYmFsIGNvbmZpZ1xuICBjb25maWc6IFByb2dyZXNzQ29uZmlnO1xuXG4gIGNvbnN0cnVjdG9yKEBPcHRpb25hbCgpIEBJbmplY3QoTkdfUFJPR1JFU1NfQ09ORklHKSBjb25maWc6IE5nUHJvZ3Jlc3NDb25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZyA/IHsgLi4uZGVmYXVsdENvbmZpZywgLi4uY29uZmlnIH0gOiBkZWZhdWx0Q29uZmlnO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBvciBDcmVhdGUgcHJvZ3Jlc3MgYmFyIGJ5IElEXG4gICAqL1xuICByZWYoaWQgPSAncm9vdCcsIGNvbmZpZz86IE5nUHJvZ3Jlc3NDb25maWcpOiBOZ1Byb2dyZXNzUmVmIHtcbiAgICBpZiAodGhpcy5faW5zdGFuY2VzLmhhcyhpZCkpIHtcbiAgICAgIC8vIEdldCBQcm9ncmVzc1JlZiBpbnN0YW5jZVxuICAgICAgY29uc3QgcHJvZ3Jlc3NSZWYgPSB0aGlzLl9pbnN0YW5jZXMuZ2V0KGlkKSBhcyBOZ1Byb2dyZXNzUmVmO1xuICAgICAgaWYgKGNvbmZpZykge1xuICAgICAgICBwcm9ncmVzc1JlZi5zZXRDb25maWcoeyAuLi50aGlzLmNvbmZpZywgLi4uY29uZmlnIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHByb2dyZXNzUmVmIGFzIE5nUHJvZ3Jlc3NSZWY7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIENyZWF0ZSBuZXcgUHJvZ3Jlc3NSZWYgaW5zdGFuY2VcbiAgICAgIGNvbnN0IHByb2dyZXNzUmVmID0gbmV3IE5nUHJvZ3Jlc3NSZWYoeyAuLi50aGlzLmNvbmZpZywgLi4uY29uZmlnIH0sIHRoaXMuZGVsZXRlSW5zdGFuY2UoaWQpKTtcbiAgICAgIHJldHVybiB0aGlzLl9pbnN0YW5jZXMuc2V0KGlkLCBwcm9ncmVzc1JlZikuZ2V0KGlkKSBhcyBOZ1Byb2dyZXNzUmVmO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZXN0cm95IGFsbCBwcm9ncmVzcyBiYXIgaW5zdGFuY2VzXG4gICAqL1xuICBkZXN0cm95QWxsKCkge1xuICAgIHRoaXMuX2luc3RhbmNlcy5mb3JFYWNoKChyZWY6IE5nUHJvZ3Jlc3NSZWYpID0+IHJlZi5kZXN0cm95KCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgZGVzdHJveWVyIGZ1bmN0aW9uIGZvciBlYWNoIHByb2dyZXNzIGJhciBpbnN0YW5jZVxuICAgKi9cbiAgcHJpdmF0ZSBkZWxldGVJbnN0YW5jZShpZDogc3RyaW5nKTogKCkgPT4gdm9pZCB7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHRoaXMuX2luc3RhbmNlcy5kZWxldGUoaWQpO1xuICAgIH07XG4gIH1cbn1cbiJdfQ==