{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { isEqual } from 'lodash';\n// tsc-library\nimport { ToastrTitle, ToastrColor } from '@library/toastr-service';\nimport { DialogEnum, InvalidForm, MaterialFormFieldAppearance } from '@library/tsc-common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"@carbon/controller/base-year.controller\";\nimport * as i4 from \"@library/storage-service\";\nimport * as i5 from \"@library/toastr-service\";\nimport * as i6 from \"@angular/material/form-field\";\nimport * as i7 from \"@angular/material/input\";\nimport * as i8 from \"@angular/common\";\nfunction UpdateComponent_mat_hint_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-hint\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Total number of character remaining: \", ctx_r0.updateFG.get(\"recalculationPolicy\").value.length, \" /2000 \");\n  }\n}\nfunction UpdateComponent_mat_error_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Recalculation Policy is required \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UpdateComponent_mat_error_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Significance Threshold is required \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UpdateComponent_mat_error_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Significance Threshold can not be negative \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UpdateComponent_mat_error_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Significance Threshold can not exceed \", ctx_r4.maxThreshold, \" % \");\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    \"disabled\": a0\n  };\n};\n// /tsc-library\nexport let UpdateComponent = /*#__PURE__*/(() => {\n  class UpdateComponent {\n    constructor(formBuilder, data, dialogRef, baseYearController, storageService, toastrService) {\n      this.formBuilder = formBuilder;\n      this.dialogRef = dialogRef;\n      this.baseYearController = baseYearController;\n      this.storageService = storageService;\n      this.toastrService = toastrService;\n      this.MaterialFormFieldAppearance = MaterialFormFieldAppearance;\n      this.isSbtiBaseYear = false;\n      this.maxThreshold = 100;\n      this.isEqual = true;\n      this.dialogRef.disableClose = true;\n      this.baseYearKeyID = data.baseYearKeyID;\n      this.isSbtiBaseYear = data.isSbtiBaseYear;\n    }\n    ngOnInit() {\n      this.rootOrgID = this.storageService.getStorage('rootOrgID');\n      this.formDetailsInit();\n      this.getBaseYearByType();\n    }\n    formDetailsInit() {\n      this.maxThreshold = this.isSbtiBaseYear ? 5 : 100;\n      this.updateFG = this.formBuilder.group({\n        recalculationPolicy: [, Validators.required],\n        significanceThreshold: [, [Validators.required, Validators.min(0), Validators.max(this.maxThreshold)]]\n      });\n    }\n    getBaseYearByType() {\n      this.baseYearController.getBaseYearByType(this.rootOrgID, this.baseYearKeyID).subscribe(response => {\n        this.patchData(response);\n      }, error => {\n        console.log('error in getBaseYearByType() -', error);\n        this.toastrService.openToast(ToastrTitle.ERROR, InvalidForm.INVALID_FORM_MESSAGE, ToastrColor.ERROR);\n      });\n    }\n    patchData(update) {\n      this.updateFG.patchValue({\n        recalculationPolicy: update['recalculationPolicy'],\n        significanceThreshold: update['significanceThreshold']\n      });\n      this.updateFG.valueChanges.subscribe(() => {\n        this.isEqual = isEqual(this.initialObject, this.updateFG.value);\n      });\n    }\n    // isValidForm() {\n    //     if (this.updateFG.invalid) {\n    //         this.updateFG.markAllAsTouched();\n    //         this.toastrService.openToast(ToastrTitle.ERROR, InvalidForm.INVALID_FORM_MESSAGE, ToastrColor.ERROR);\n    //         return;\n    //     }\n    // }\n    updateData() {\n      if (this.updateFG.invalid) {\n        this.updateFG.markAllAsTouched();\n        this.toastrService.openToast(ToastrTitle.ERROR, InvalidForm.INVALID_FORM_MESSAGE, ToastrColor.ERROR);\n        return;\n      }\n      let toast;\n      this.baseYearController.updateData(this.rootOrgID, this.baseYearKeyID, this.updateFG.value).subscribe(updateRes => {\n        toast = this.toastrService.getToastStatus(updateRes.status);\n        this.toastrService.openToast(toast.title, updateRes.message, toast.color);\n        this.dialogRef.close(DialogEnum.SUCCESS_DR);\n      }, error => {\n        console.error('Error updating data:', error);\n      });\n    }\n  }\n  UpdateComponent.ɵfac = function UpdateComponent_Factory(t) {\n    return new (t || UpdateComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i2.MatDialogRef), i0.ɵɵdirectiveInject(i3.BaseYearController), i0.ɵɵdirectiveInject(i4.StorageService), i0.ɵɵdirectiveInject(i5.ToastrService));\n  };\n  UpdateComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UpdateComponent,\n    selectors: [[\"app-update\"]],\n    decls: 27,\n    vars: 12,\n    consts: [[\"mat-dialog-title\", \"\"], [1, \"dialogHeader\"], [\"mat-dialog-content\", \"\"], [3, \"formGroup\"], [1, \"row\"], [1, \"matFieldWidth100\", 3, \"appearance\"], [1, \"formLabel\"], [\"matInput\", \"\", \"placeholder\", \"Write your company policy here\", \"type\", \"text\", \"formControlName\", \"recalculationPolicy\", 3, \"maxLength\"], [4, \"ngIf\"], [1, \"row\", \"pt-3\"], [\"matInput\", \"\", \"formControlName\", \"significanceThreshold\", \"type\", \"number\", 1, \"formPlaceholder\"], [\"matSuffix\", \"\", 1, \"m-3\"], [\"align\", \"end\"], [\"type\", \"button\", \"mat-dialog-close\", \"\", 1, \"btn\", \"btn-secondary\", \"me-2\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\", 3, \"ngClass\", \"click\"]],\n    template: function UpdateComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"strong\", 1);\n        i0.ɵɵtext(2, \" Update base year \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 2);\n        i0.ɵɵelementStart(4, \"form\", 3);\n        i0.ɵɵelementStart(5, \"div\", 4);\n        i0.ɵɵelementStart(6, \"mat-form-field\", 5);\n        i0.ɵɵelementStart(7, \"mat-label\", 6);\n        i0.ɵɵtext(8, \"Recalculation Policy\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(9, \"textarea\", 7);\n        i0.ɵɵtemplate(10, UpdateComponent_mat_hint_10_Template, 2, 1, \"mat-hint\", 8);\n        i0.ɵɵtemplate(11, UpdateComponent_mat_error_11_Template, 2, 0, \"mat-error\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"div\", 9);\n        i0.ɵɵelementStart(13, \"mat-form-field\", 5);\n        i0.ɵɵelementStart(14, \"mat-label\", 6);\n        i0.ɵɵtext(15, \"Significance Threshold\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(16, \"input\", 10);\n        i0.ɵɵelementStart(17, \"span\", 11);\n        i0.ɵɵtext(18, \"%\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(19, UpdateComponent_mat_error_19_Template, 2, 0, \"mat-error\", 8);\n        i0.ɵɵtemplate(20, UpdateComponent_mat_error_20_Template, 2, 0, \"mat-error\", 8);\n        i0.ɵɵtemplate(21, UpdateComponent_mat_error_21_Template, 2, 1, \"mat-error\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"div\", 12);\n        i0.ɵɵelementStart(23, \"button\", 13);\n        i0.ɵɵtext(24, \" Cancel \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function UpdateComponent_Template_button_click_25_listener() {\n          return ctx.updateData();\n        });\n        i0.ɵɵtext(26, \" Update \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"formGroup\", ctx.updateFG);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"appearance\", ctx.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"maxLength\", 2000);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.updateFG.get(\"recalculationPolicy\").value == null ? null : ctx.updateFG.get(\"recalculationPolicy\").value.length);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.updateFG.get(\"recalculationPolicy\").hasError(\"required\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"appearance\", ctx.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", ctx.updateFG.get(\"significanceThreshold\").hasError(\"required\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.updateFG.get(\"significanceThreshold\").hasError(\"min\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.updateFG.get(\"significanceThreshold\").hasError(\"max\"));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(10, _c0, ctx.isEqual));\n      }\n    },\n    directives: [i2.MatDialogTitle, i2.MatDialogContent, i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i6.MatFormField, i6.MatLabel, i7.MatInput, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlName, i8.NgIf, i1.NumberValueAccessor, i6.MatSuffix, i2.MatDialogClose, i8.NgClass, i6.MatHint, i6.MatError],\n    encapsulation: 2\n  });\n  return UpdateComponent;\n})();\nexport let UpdateModule = /*#__PURE__*/(() => {\n  class UpdateModule {}\n  UpdateModule.ɵfac = function UpdateModule_Factory(t) {\n    return new (t || UpdateModule)();\n  };\n  UpdateModule.ɵmod = /*@__PURE__*/i0.ɵɵdefineNgModule({\n    type: UpdateModule\n  });\n  UpdateModule.ɵinj = /*@__PURE__*/i0.ɵɵdefineInjector({\n    imports: [[CommonModule, FormsModule, ReactiveFormsModule, MatInputModule, MatDialogModule, MatFormFieldModule]]\n  });\n  return UpdateModule;\n})();","map":null,"metadata":{},"sourceType":"module"}