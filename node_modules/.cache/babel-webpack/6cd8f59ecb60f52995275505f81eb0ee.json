{"ast":null,"code":"import { MatPaginator } from '@angular/material/paginator';\nimport { startWith } from 'rxjs/operators';\nimport { TimelineComponent } from './timeline/timeline.component';\nimport { CARBON_CONSTANT } from '@carbon/constant/carbon.constant';\n// tsc-library\nimport { ProfileImg } from '@library/user-service';\nimport { TABLE_CONSTANT } from '@library/tsc-common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@library/storage-service\";\nimport * as i4 from \"@carbon/controller/timeline.controller\";\nimport * as i5 from \"@library/user-service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/material/paginator\";\nfunction RecalculationHistoryComponent_ng_container_10_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"li\", 16);\n    i0.ɵɵelementStart(2, \"span\", 17);\n    i0.ɵɵelementStart(3, \"span\", 18);\n    i0.ɵɵtext(4, \" calculate \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 19);\n    i0.ɵɵelement(6, \"img\", 20);\n    i0.ɵɵelementStart(7, \"span\", 21);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"span\", 22);\n    i0.ɵɵtext(10, \"triggered \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"span\", 21);\n    i0.ɵɵtext(12, \"a Recalculation\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"span\", 22);\n    i0.ɵɵtext(14, \" on \");\n    i0.ɵɵelementStart(15, \"time\", 23);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function RecalculationHistoryComponent_ng_container_10_ng_container_2_Template_button_click_17_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const history_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return ctx_r6.viewHistoricTimeline(history_r5);\n    });\n    i0.ɵɵtext(18, \" View changes \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const history_r5 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"src\", (history_r5 == null ? null : history_r5[\"profileImgUrl\"]) || ctx_r4.defaultImage(history_r5 == null ? null : history_r5[\"userName\"]), i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", history_r5 == null ? null : history_r5[\"userName\"], \" \");\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate(history_r5.recalculatedOn);\n  }\n}\nfunction RecalculationHistoryComponent_ng_container_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ol\", 14);\n    i0.ɵɵtemplate(2, RecalculationHistoryComponent_ng_container_10_ng_container_2_Template, 19, 3, \"ng-container\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.recalculationHistory);\n  }\n}\nfunction RecalculationHistoryComponent_ng_template_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵelementStart(1, \"div\", 26);\n    i0.ɵɵelementStart(2, \"div\", 27);\n    i0.ɵɵelementStart(3, \"div\", 28);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(4, \"svg\", 29);\n    i0.ɵɵelement(5, \"use\", 30);\n    i0.ɵɵelementEnd();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(6, \"div\", 31);\n    i0.ɵɵelementStart(7, \"div\");\n    i0.ɵɵelementStart(8, \"strong\");\n    i0.ɵɵtext(9, \"No recalculation history available.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 32);\n    i0.ɵɵtext(11, \" Currently, there's no data in the recalculation history for your base year emissions, as no recalculation has been initiated for the base year emissions yet. \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\", 33);\n    i0.ɵɵelementStart(13, \"div\", 34);\n    i0.ɵɵelement(14, \"img\", 35);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n// tsc-library\nexport let RecalculationHistoryComponent = /*#__PURE__*/(() => {\n  class RecalculationHistoryComponent {\n    constructor(dialog, activatedRoute, storageService, timelineController, userService) {\n      this.dialog = dialog;\n      this.activatedRoute = activatedRoute;\n      this.storageService = storageService;\n      this.timelineController = timelineController;\n      this.userService = userService;\n      this.TABLE_CONSTANT = TABLE_CONSTANT;\n      this.recalculationHistory = [];\n      this.totalCount = 0;\n    }\n    ngOnInit() {\n      this.rootOrgID = this.storageService.getStorage('rootOrgID');\n      this.activatedRoute.data.subscribe(data => {\n        this.baseYearKeyID = data['base_year'];\n      });\n    }\n    ngAfterViewInit() {\n      this.paginator.page.pipe(startWith({})).subscribe(() => {\n        this.getRecalculationHistory(this.paginator.pageIndex + 1, this.paginator.pageSize);\n      });\n    }\n    getRecalculationHistory(pageNo, pageSize) {\n      this.timelineController.getRecalculationHistory(this.rootOrgID, this.baseYearKeyID, pageNo, pageSize).subscribe(history => {\n        this.recalculationHistory = history['records'];\n        this.totalCount = history['totalCount'];\n      });\n    }\n    viewHistoricTimeline(history) {\n      let config = CARBON_CONSTANT['RIGHT_DIALOG_CONFIG'];\n      config['minWidth'] = '80vw';\n      config['data'] = {\n        rootOrgID: this.rootOrgID,\n        baseYearKeyID: this.baseYearKeyID,\n        recalculatedOn: history['recalculatedOn'],\n        recalculationID: history['recalculationID'],\n        recalculationTime: history['recalculationTime']\n      };\n      this.dialog.open(TimelineComponent, config);\n    }\n    defaultImage(user) {\n      user = user.split(' ');\n      let firstName = user[0];\n      let lastName = user[1];\n      return this.userService.defaultImage((firstName ? firstName + ' ' : '') + (lastName ? lastName : ''), ProfileImg.PROFILE_IMAGE_DROPDOWN_NAME_VIEW);\n    }\n  }\n  RecalculationHistoryComponent.ɵfac = function RecalculationHistoryComponent_Factory(t) {\n    return new (t || RecalculationHistoryComponent)(i0.ɵɵdirectiveInject(i1.MatDialog), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.StorageService), i0.ɵɵdirectiveInject(i4.TimelineController), i0.ɵɵdirectiveInject(i5.UserService));\n  };\n  RecalculationHistoryComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: RecalculationHistoryComponent,\n    selectors: [[\"app-recalculation-history\"]],\n    viewQuery: function RecalculationHistoryComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(MatPaginator, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n      }\n    },\n    decls: 16,\n    vars: 5,\n    consts: [[\"xmlns\", \"http://www.w3.org/2000/svg\", 2, \"display\", \"none\"], [\"id\", \"info-fill\", \"fill\", \"currentColor\", \"viewBox\", \"0 0 16 16\"], [\"d\", \"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z\"], [1, \"card\", \"main-card\", \"cardOverwrite\"], [1, \"headerContainer\"], [1, \"headerLeftContainer\"], [1, \"pageTitle\"], [1, \"headerRightContainer\"], [1, \"headerRightContainerInner\"], [4, \"ngIf\", \"ngIfElse\"], [\"noHistory\", \"\"], [\"align\", \"end\", 1, \"w-100\"], [\"showFirstLastButtons\", \"\", 1, \"roundedBorder\", 3, \"length\", \"pageSizeOptions\", \"pageSize\"], [\"paginator\", \"\"], [1, \"timeline\"], [4, \"ngFor\", \"ngForOf\"], [1, \"timeline-item\"], [1, \"timeline-item-icon\", \"recalculate-icon\"], [1, \"material-icons\"], [1, \"timeline-item-description\", \"centerAlign\"], [\"alt\", \"profile-image\", 1, \"avatar\", \"small\", \"border\", \"d-block\", \"profileImageHeaderView\", 3, \"src\"], [1, \"focus\"], [1, \"lowFocus\"], [\"datetime\", \"timeline.date\"], [1, \"btn\", \"btn-link\", \"viewBtn\", 3, \"click\"], [1, \"infoCardContainer\", \"mt-2\"], [1, \"extraInfoCard\", \"px-2\"], [\"role\", \"alert\", 1, \"alert\", \"alert-info\", \"m-0\", \"centerAlignVertical\", \"justify-content-between\", \"roundedBorder\"], [1, \"d-flex\", \"align-items-center\"], [1, \"bi\", \"flex-shrink-0\", \"me-3\", \"extraInfoCardHeaderIcon\"], [0, \"xlink\", \"href\", \"#info-fill\"], [1, \"endAlignVertical\"], [1, \"mt-2\"], [1, \"row\"], [1, \"centerAlign\"], [\"src\", \"/assets/images/no-recalculation-history.jpg\", \"alt\", \"\", 1, \"noBaseYear\"]],\n    template: function RecalculationHistoryComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(0, \"svg\", 0);\n        i0.ɵɵelementStart(1, \"symbol\", 1);\n        i0.ɵɵelement(2, \"path\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵelementStart(6, \"div\", 6);\n        i0.ɵɵtext(7, \" Recalculation timeline \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 7);\n        i0.ɵɵelement(9, \"div\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(10, RecalculationHistoryComponent_ng_container_10_Template, 3, 1, \"ng-container\", 9);\n        i0.ɵɵtemplate(11, RecalculationHistoryComponent_ng_template_11_Template, 15, 0, \"ng-template\", null, 10, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementStart(13, \"div\", 11);\n        i0.ɵɵelement(14, \"mat-paginator\", 12, 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(12);\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngIf\", ctx.recalculationHistory.length > 0)(\"ngIfElse\", _r1);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"length\", ctx.totalCount)(\"pageSizeOptions\", ctx.TABLE_CONSTANT.PAGE_SIZE_OPTION)(\"pageSize\", ctx.TABLE_CONSTANT.DEFAULT_PAGE_SIZE);\n      }\n    },\n    directives: [i6.NgIf, i7.MatPaginator, i6.NgForOf],\n    styles: [\"@import\\\"https://fonts.googleapis.com/css2?family=Outfit:wght@100;200;300;400;500;600;700;800;900&display=swap\\\";*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box}[_ngcontent-%COMP%]:root{--c-grey-100: #f4f6f8;--c-grey-200: #e3e3e3;--c-grey-300: #b2b2b2;--c-grey-400: #7b7b7b;--c-grey-500: #3d3d3d;--c-blue-500: #688afd}body[_ngcontent-%COMP%]{line-height:1.5;min-height:100vh;font-family:\\\"Outfit\\\",sans-serif;padding-top:20vh;padding-bottom:20vh}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font:inherit}img[_ngcontent-%COMP%]{display:block;max-width:100%}.timeline[_ngcontent-%COMP%]{width:100%;max-width:max-content;margin-left:50px;margin-right:auto;display:flex;flex-direction:column;padding:32px 0 32px 32px;border-left:2px solid #e3e3e3;font-size:1.05rem;font-family:Roboto,\\\"Helvetica Neue\\\",sans-serif}.timeline-item[_ngcontent-%COMP%]{display:flex;grid-gap:24px;gap:24px}.timeline-item[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:24px}.timeline-item[_ngcontent-%COMP%] + .extra-space[_ngcontent-%COMP%]{margin-top:48px}.timeline-item-description[_ngcontent-%COMP%]{display:flex;grid-gap:8px;gap:8px;color:#7b7b7b}.timeline-item-description[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{flex-shrink:0}.timeline-item-description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#3d3d3d;font-weight:500;text-decoration:none}.timeline-item-description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .timeline-item-description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus{outline:0!important;color:var(--c-blue-500)}.avatar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border-radius:50%;overflow:hidden;aspect-ratio:1/1;flex-shrink:0;width:40px;height:40px}.avatar.small[_ngcontent-%COMP%]{width:28px;height:28px}.avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover}.timeline-item-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;margin-left:-52px;flex-shrink:0;overflow:hidden;box-shadow:0 0 0 6px #fff}.timeline-item-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.timeline-item-icon.recalculate-icon[_ngcontent-%COMP%]{background-color:#f3ca20;color:#000000d9}.timeline-item-icon.faded-icon[_ngcontent-%COMP%]{background-color:#e3e3e3;color:#7b7b7b}.lowFocus[_ngcontent-%COMP%]{opacity:.7}.focus[_ngcontent-%COMP%]{color:#3d3d3d;font-family:sans-serif}.recalculate[_ngcontent-%COMP%]{background-image:linear-gradient(to right,green,yellow,red)}.noBaseYear[_ngcontent-%COMP%]{width:30vw}.viewBtn[_ngcontent-%COMP%]{margin:auto 0 auto auto;height:30px}.maxFooterHeight[_ngcontent-%COMP%]{max-height:10px!important}\"]\n  });\n  return RecalculationHistoryComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}