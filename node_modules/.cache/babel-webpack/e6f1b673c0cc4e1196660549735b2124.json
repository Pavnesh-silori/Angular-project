{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { forkJoin } from 'rxjs';\nimport { CARBON_CONSTANT } from '@carbon/constant/carbon.constant';\nimport { ConsolidationApproachKeyIDEnum } from '@carbon/enum/consolidation-approach.enum';\n// tsc-library\nimport { ToastrColor } from '@library/toastr-service';\nimport { UnitTypeKeyID, UomCode } from '@library/unit-service';\nimport { FormAction, MaterialFormFieldAppearance } from '@library/tsc-common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@library/storage-service\";\nimport * as i3 from \"@carbon/service/scope.service\";\nimport * as i4 from \"@library/toastr-service\";\nimport * as i5 from \"@library/unit-service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/material/form-field\";\nimport * as i8 from \"@angular/material/input\";\nfunction EmissionDataComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵelementStart(1, \"div\", 13);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(2, \"svg\", 14);\n    i0.ɵɵelement(3, \"use\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(4, \"div\", 16);\n    i0.ɵɵtext(5, \" At least one record must be filled from scope 1, scope 2. \");\n    i0.ɵɵelementStart(6, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function EmissionDataComponent_div_3_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.showInfo = false;\n    });\n    i0.ɵɵelementStart(7, \"span\", 18);\n    i0.ɵɵtext(8, \" close \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_td_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 19);\n    i0.ɵɵtext(1, \" Operational control approach \");\n    i0.ɵɵelementStart(2, \"span\");\n    i0.ɵɵtext(3, \"(tCO\");\n    i0.ɵɵelementStart(4, \"sub\");\n    i0.ɵɵtext(5, \"2\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"e)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_td_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 19);\n    i0.ɵɵtext(1, \" Financial control approach \");\n    i0.ɵɵelementStart(2, \"span\");\n    i0.ɵɵtext(3, \"(tCO\");\n    i0.ɵɵelementStart(4, \"sub\");\n    i0.ɵɵtext(5, \"2\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"e)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_td_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 19);\n    i0.ɵɵtext(1, \" Equity control approach \");\n    i0.ɵɵelementStart(2, \"span\");\n    i0.ɵɵtext(3, \"(tCO\");\n    i0.ɵɵelementStart(4, \"sub\");\n    i0.ɵɵtext(5, \"2\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"e)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_6_mat_error_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"This field cannot be negative\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_6_mat_error_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Enter emission \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_6_mat_error_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"This field cannot be negative\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementContainerStart(1, 22);\n    i0.ɵɵelementStart(2, \"td\");\n    i0.ɵɵelementStart(3, \"div\", 23);\n    i0.ɵɵelementStart(4, \"div\", 24);\n    i0.ɵɵelementStart(5, \"mat-form-field\", 25);\n    i0.ɵɵelementStart(6, \"mat-label\", 26);\n    i0.ɵɵtext(7, \" Enter emission \");\n    i0.ɵɵelementStart(8, \"span\");\n    i0.ɵɵtext(9, \"(tCO\");\n    i0.ɵɵelementStart(10, \"sub\");\n    i0.ɵɵtext(11, \"2\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"e)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(13, \"input\", 27, 28);\n    i0.ɵɵtemplate(15, EmissionDataComponent_tr_16_ng_container_6_mat_error_15_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵtemplate(16, EmissionDataComponent_tr_16_ng_container_6_mat_error_16_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 29);\n    i0.ɵɵelementStart(18, \"mat-form-field\", 25);\n    i0.ɵɵelementStart(19, \"mat-label\", 26);\n    i0.ɵɵtext(20, \" Enter biogenic emission \");\n    i0.ɵɵelementStart(21, \"span\");\n    i0.ɵɵtext(22, \"(tCO\");\n    i0.ɵɵelementStart(23, \"sub\");\n    i0.ɵɵtext(24, \"2\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(25, \"e)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(26, \"input\", 27, 28);\n    i0.ɵɵtemplate(28, EmissionDataComponent_tr_16_ng_container_6_mat_error_28_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const emissionGroup_r7 = i0.ɵɵnextContext().$implicit;\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"appearance\", ctx_r9.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"min\", 0)(\"formControl\", emissionGroup_r7.get(\"operationalControlApproach\").get(\"emission\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", emissionGroup_r7.get(\"operationalControlApproach\").get(\"emission\").hasError(\"min\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", emissionGroup_r7.get(\"operationalControlApproach\").get(\"emission\").hasError(\"required\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"appearance\", ctx_r9.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"min\", 0)(\"formControl\", emissionGroup_r7.get(\"operationalControlApproach\").get(\"biogenicEmission\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", emissionGroup_r7.get(\"operationalControlApproach\").get(\"biogenicEmission\").hasError(\"min\"));\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_7_mat_error_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"This field cannot be negative\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_7_mat_error_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Enter emission \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_7_mat_error_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"This field cannot be negative\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementContainerStart(1, 30);\n    i0.ɵɵelementStart(2, \"td\");\n    i0.ɵɵelementStart(3, \"div\", 23);\n    i0.ɵɵelementStart(4, \"div\", 24);\n    i0.ɵɵelementStart(5, \"mat-form-field\", 25);\n    i0.ɵɵelementStart(6, \"mat-label\", 26);\n    i0.ɵɵtext(7, \" Enter emission \");\n    i0.ɵɵelementStart(8, \"span\");\n    i0.ɵɵtext(9, \"(tCO\");\n    i0.ɵɵelementStart(10, \"sub\");\n    i0.ɵɵtext(11, \"2\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"e)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(13, \"input\", 27, 28);\n    i0.ɵɵtemplate(15, EmissionDataComponent_tr_16_ng_container_7_mat_error_15_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵtemplate(16, EmissionDataComponent_tr_16_ng_container_7_mat_error_16_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 29);\n    i0.ɵɵelementStart(18, \"mat-form-field\", 25);\n    i0.ɵɵelementStart(19, \"mat-label\", 26);\n    i0.ɵɵtext(20, \" Enter biogenic emission \");\n    i0.ɵɵelementStart(21, \"span\");\n    i0.ɵɵtext(22, \"(tCO\");\n    i0.ɵɵelementStart(23, \"sub\");\n    i0.ɵɵtext(24, \"2\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(25, \"e)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(26, \"input\", 27, 28);\n    i0.ɵɵtemplate(28, EmissionDataComponent_tr_16_ng_container_7_mat_error_28_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const emissionGroup_r7 = i0.ɵɵnextContext().$implicit;\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"appearance\", ctx_r10.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"min\", 0)(\"formControl\", emissionGroup_r7.get(\"financialControlApproach\").get(\"emission\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", emissionGroup_r7.get(\"financialControlApproach\").get(\"emission\").hasError(\"min\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", emissionGroup_r7.get(\"financialControlApproach\").get(\"emission\").hasError(\"required\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"appearance\", ctx_r10.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"min\", 0)(\"formControl\", emissionGroup_r7.get(\"financialControlApproach\").get(\"biogenicEmission\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", emissionGroup_r7.get(\"financialControlApproach\").get(\"biogenicEmission\").hasError(\"min\"));\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_8_mat_error_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"This field cannot be negative\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_8_mat_error_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Enter emission \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_8_mat_error_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"This field cannot be negative\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmissionDataComponent_tr_16_ng_container_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementContainerStart(1, 31);\n    i0.ɵɵelementStart(2, \"td\");\n    i0.ɵɵelementStart(3, \"div\", 23);\n    i0.ɵɵelementStart(4, \"div\", 24);\n    i0.ɵɵelementStart(5, \"mat-form-field\", 25);\n    i0.ɵɵelementStart(6, \"mat-label\", 26);\n    i0.ɵɵtext(7, \" Enter emission \");\n    i0.ɵɵelementStart(8, \"span\");\n    i0.ɵɵtext(9, \"(tCO\");\n    i0.ɵɵelementStart(10, \"sub\");\n    i0.ɵɵtext(11, \"2\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"e)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(13, \"input\", 27, 28);\n    i0.ɵɵtemplate(15, EmissionDataComponent_tr_16_ng_container_8_mat_error_15_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵtemplate(16, EmissionDataComponent_tr_16_ng_container_8_mat_error_16_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 29);\n    i0.ɵɵelementStart(18, \"mat-form-field\", 25);\n    i0.ɵɵelementStart(19, \"mat-label\", 26);\n    i0.ɵɵtext(20, \" Enter biogenic emission \");\n    i0.ɵɵelementStart(21, \"span\");\n    i0.ɵɵtext(22, \"(tCO\");\n    i0.ɵɵelementStart(23, \"sub\");\n    i0.ɵɵtext(24, \"2\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(25, \"e)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(26, \"input\", 27, 28);\n    i0.ɵɵtemplate(28, EmissionDataComponent_tr_16_ng_container_8_mat_error_28_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const emissionGroup_r7 = i0.ɵɵnextContext().$implicit;\n    const ctx_r11 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"appearance\", ctx_r11.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"min\", 0)(\"formControl\", emissionGroup_r7.get(\"equityShareApproach\").get(\"emission\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", emissionGroup_r7.get(\"equityShareApproach\").get(\"emission\").hasError(\"min\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", emissionGroup_r7.get(\"equityShareApproach\").get(\"emission\").hasError(\"required\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"appearance\", ctx_r11.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"min\", 0)(\"formControl\", emissionGroup_r7.get(\"equityShareApproach\").get(\"biogenicEmission\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", emissionGroup_r7.get(\"equityShareApproach\").get(\"biogenicEmission\").hasError(\"min\"));\n  }\n}\nfunction EmissionDataComponent_tr_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementContainerStart(1, 20);\n    i0.ɵɵelementStart(2, \"td\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, EmissionDataComponent_tr_16_ng_container_6_Template, 29, 9, \"ng-container\", 21);\n    i0.ɵɵtemplate(7, EmissionDataComponent_tr_16_ng_container_7_Template, 29, 9, \"ng-container\", 21);\n    i0.ɵɵtemplate(8, EmissionDataComponent_tr_16_ng_container_8_Template, 29, 9, \"ng-container\", 21);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const emissionGroup_r7 = ctx.$implicit;\n    const i_r8 = ctx.index;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroupName\", i_r8);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(emissionGroup_r7.get(\"scope\").value);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(emissionGroup_r7.get(\"activityName\").value);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.operationalControlApproachDisplay);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.financialControlApproachDisplay);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.equityShareApproachDisplay);\n  }\n}\n// /tsc-library\nexport let EmissionDataComponent = /*#__PURE__*/(() => {\n  class EmissionDataComponent {\n    constructor(activityEmissionDataFB, storageService, scopeService, toastrService, unitService) {\n      this.activityEmissionDataFB = activityEmissionDataFB;\n      this.storageService = storageService;\n      this.scopeService = scopeService;\n      this.toastrService = toastrService;\n      this.unitService = unitService;\n      this.MaterialFormFieldAppearance = MaterialFormFieldAppearance;\n      this.consolidationApproachKeyIDList = [];\n      this.emissionData = null;\n      this.CARBON_CONSTANT = CARBON_CONSTANT;\n      this.scopesWithActivity = [];\n      this.operationalControlApproachDisplay = false;\n      this.financialControlApproachDisplay = false;\n      this.equityShareApproachDisplay = false;\n      this.filled = false;\n      this.scope1Filled = false;\n      this.scope2Filled = false;\n      this.biogenicFilled = false;\n      this.scope1FGMap = new Map();\n      this.scope2FGMap = new Map();\n      this.unitM = [];\n      this.showInfo = true;\n      this.emissionFlag = true;\n    }\n    ngOnInit() {\n      this.rootOrgID = this.storageService.getStorage('rootOrgID');\n      this.activityEmissionDataFGInit();\n      this.formInitialization();\n      // this.getUnit();\n      // this.getAllScopeWithActivity();\n      if (this.consolidationApproachKeyIDList) {\n        this.consolidationApproachValidation();\n      }\n      if (this.emissionData) {\n        this.patchActivityToFormGroup(this.emissionData);\n        this.updateActivityValidators();\n      }\n    }\n    ngOnChanges(changes) {\n      if (changes === null || changes === void 0 ? void 0 : changes.consolidationApproachKeyIDList) if (!changes.consolidationApproachKeyIDList.firstChange) {\n        this.consolidationApproachValidation();\n      }\n      if (changes.emissionData && this.emissionData) {\n        if (this.action == FormAction.UPDATE) {\n          this.patchActivityToFormGroup(this.emissionData);\n          this.updateActivityValidators();\n        }\n      }\n    }\n    // ngDoCheck() {\n    //     if (this.emissionData && this.emissionFlag) {\n    //         if (this.action == FormAction.UPDATE) {\n    //             this.emissionFlag = false;\n    //             this.activityEmissionDataFG.reset([]);\n    //             this.patchActivityToFormGroup(this.emissionData);\n    //             this.updateActivityValidators();\n    //         }\n    //     }\n    // }\n    formInitialization() {\n      forkJoin([this.unitService.getUnit([`type:` + UnitTypeKeyID.EQUIVALENT_EMISSION]), this.scopeService.getAllScopeWithActivity()]).subscribe(([unitM, scopesWithActivity]) => {\n        this.scopesWithActivity = scopesWithActivity;\n        this.unitM = unitM;\n        this.tCo2EUnitM = this.unitM.find(unit => unit.uomCode == UomCode.TCO2E);\n        this.addActivityToFormGroup();\n      }, error => {\n        console.error('error in formInitialization -', error);\n      });\n    }\n    consolidationApproachValidation() {\n      this.operationalControlApproachDisplay = false;\n      this.financialControlApproachDisplay = false;\n      this.equityShareApproachDisplay = false;\n      for (const approach of this.consolidationApproachKeyIDList) {\n        if (approach == ConsolidationApproachKeyIDEnum.OPERATIONAL_CONTROL_APPROACH) {\n          this.operationalControlApproachDisplay = true;\n        } else if (approach == ConsolidationApproachKeyIDEnum.FINANCIAL_CONTROL_APPROACH) {\n          this.financialControlApproachDisplay = true;\n        } else if (approach == ConsolidationApproachKeyIDEnum.EQUITY_CONTROL_APPROACH) {\n          this.equityShareApproachDisplay = true;\n        }\n      }\n      this.updateActivityValidators();\n    }\n    getEmissionRecord() {\n      return this.activityEmissionDataFG.get('emissionRecords');\n    }\n    addActivityToFormGroup() {\n      if (!this.emissionData && this.action != FormAction.UPDATE) {\n        const formArray = this.activityEmissionDataFG.get('emissionRecords');\n        for (const scopeWithActivity of this.scopesWithActivity) {\n          for (const activity of scopeWithActivity.activity) {\n            const activityGroup = this.activityEmissionDataFB.group({\n              scope: scopeWithActivity.name,\n              activityID: activity.id,\n              activityKeyID: activity.keyID,\n              activityName: activity.name,\n              operationalControlApproach: this.activityEmissionDataFB.group({\n                emission: [null, [Validators.min(0)]],\n                emissionUnitID: [this.tCo2EUnitM.id],\n                biogenicEmission: [null, [Validators.min(0)]],\n                biogenicEmissionUnitID: [this.tCo2EUnitM.id],\n                consolidationApproachKeyID: ConsolidationApproachKeyIDEnum.OPERATIONAL_CONTROL_APPROACH\n              }),\n              financialControlApproach: this.activityEmissionDataFB.group({\n                emission: [null, [Validators.min(0)]],\n                emissionUnitID: [this.tCo2EUnitM.id],\n                biogenicEmission: [null, [Validators.min(0)]],\n                biogenicEmissionUnitID: [this.tCo2EUnitM.id],\n                consolidationApproachKeyID: ConsolidationApproachKeyIDEnum.FINANCIAL_CONTROL_APPROACH\n              }),\n              equityShareApproach: this.activityEmissionDataFB.group({\n                emission: [null, [Validators.min(0)]],\n                emissionUnitID: [this.tCo2EUnitM.id],\n                biogenicEmission: [null, [Validators.min(0)]],\n                biogenicEmissionUnitID: [this.tCo2EUnitM.id],\n                consolidationApproachKeyID: ConsolidationApproachKeyIDEnum.EQUITY_CONTROL_APPROACH\n              })\n            });\n            formArray.push(activityGroup);\n          }\n        }\n      }\n      this.updateActivityValidators();\n    }\n    patchActivityToFormGroup(emissionData) {\n      var _a, _b, _c, _d, _e, _f;\n      const emissionRecords = emissionData;\n      const formArray = this.activityEmissionDataFG.get('emissionRecords');\n      for (const record of emissionRecords) {\n        formArray.push(this.activityEmissionDataFB.group({\n          scope: record.scope,\n          activityID: record.activityID,\n          activityKeyID: record.activityKeyID,\n          activityName: record.activityName,\n          operationalControlApproach: this.activityEmissionDataFB.group({\n            emission: [(_a = record.operationalControlApproach) === null || _a === void 0 ? void 0 : _a.emission, [Validators.min(0)]],\n            emissionUnitID: [this.CARBON_CONSTANT.DEFAULT_EMISSION_UNIT.id],\n            biogenicEmission: [(_b = record.operationalControlApproach) === null || _b === void 0 ? void 0 : _b.biogenicEmission, [Validators.min(0)]],\n            biogenicEmissionUnitID: [this.CARBON_CONSTANT.DEFAULT_EMISSION_UNIT.id],\n            consolidationApproachKeyID: ConsolidationApproachKeyIDEnum.OPERATIONAL_CONTROL_APPROACH\n          }),\n          financialControlApproach: this.activityEmissionDataFB.group({\n            emission: [(_c = record.financialControlApproach) === null || _c === void 0 ? void 0 : _c.emission, [Validators.min(0)]],\n            emissionUnitID: [this.CARBON_CONSTANT.DEFAULT_EMISSION_UNIT.id],\n            biogenicEmission: [(_d = record.financialControlApproach) === null || _d === void 0 ? void 0 : _d.biogenicEmission, [Validators.min(0)]],\n            biogenicEmissionUnitID: [this.CARBON_CONSTANT.DEFAULT_EMISSION_UNIT.id],\n            consolidationApproachKeyID: ConsolidationApproachKeyIDEnum.FINANCIAL_CONTROL_APPROACH\n          }),\n          equityShareApproach: this.activityEmissionDataFB.group({\n            emission: [(_e = record.equityShareApproach) === null || _e === void 0 ? void 0 : _e.emission, [Validators.min(0)]],\n            emissionUnitID: [this.CARBON_CONSTANT.DEFAULT_EMISSION_UNIT.id],\n            biogenicEmission: [(_f = record.equityShareApproach) === null || _f === void 0 ? void 0 : _f.biogenicEmission, [Validators.min(0)]],\n            biogenicEmissionUnitID: [this.CARBON_CONSTANT.DEFAULT_EMISSION_UNIT.id],\n            consolidationApproachKeyID: ConsolidationApproachKeyIDEnum.EQUITY_CONTROL_APPROACH\n          })\n        }));\n      }\n      this.updateActivityValidators();\n    }\n    activityEmissionDataFGInit() {\n      this.activityEmissionDataFG = this.activityEmissionDataFB.group({\n        emissionRecords: this.activityEmissionDataFB.array([])\n      });\n    }\n    updateActivityValidators() {\n      this.currentFormArr = this.activityEmissionDataFG.get('emissionRecords');\n      for (let i = 0; i < this.currentFormArr.controls.length; ++i) {\n        let item = this.currentFormArr.controls[i];\n        this.addActivityValidators(item);\n        item.valueChanges.subscribe(() => {\n          this.addActivityValidators(item);\n        });\n      }\n    }\n    addActivityValidators(item) {\n      this.removeValidators(item);\n      this.filled = false;\n      if (item.value.scope === 'Scope 1') this.scope1Filled = false;else if (item.value.scope === 'Scope 2') this.scope2Filled = false;\n      this.isFormFilled(item);\n      if (this.filled) {\n        if (item.value.scope === 'Scope 1') this.scope1Filled = true;else if (item.value.scope === 'Scope 2') this.scope2Filled = true;\n        this.addValidators(item);\n      }\n      if (item.value.scope === 'Scope 1') {\n        this.scope1FGMap.set(item, this.scope1Filled);\n      } else if (item.value.scope === 'Scope 2') {\n        this.scope2FGMap.set(item, this.scope2Filled);\n      }\n      this.filled = false;\n    }\n    isFormFilled(item) {\n      if (this.consolidationApproachKeyIDList) {\n        for (let approach of this.consolidationApproachKeyIDList) {\n          switch (approach) {\n            case ConsolidationApproachKeyIDEnum.OPERATIONAL_CONTROL_APPROACH:\n              if (item.get('operationalControlApproach.emission').value != null) this.filled = true;\n              break;\n            case ConsolidationApproachKeyIDEnum.FINANCIAL_CONTROL_APPROACH:\n              if (item.get('financialControlApproach.emission').value != null) this.filled = true;\n              break;\n            case ConsolidationApproachKeyIDEnum.EQUITY_CONTROL_APPROACH:\n              if (item.get('equityShareApproach.emission').value != null) this.filled = true;\n              break;\n          }\n        }\n      }\n    }\n    removeValidators(formGroup) {\n      formGroup.get('operationalControlApproach.emission').clearValidators();\n      formGroup.get('financialControlApproach.emission').clearValidators();\n      formGroup.get('equityShareApproach.emission').clearValidators();\n      this.updateValueAndValidity(formGroup);\n    }\n    addValidators(formGroup) {\n      for (let approach of this.consolidationApproachKeyIDList) {\n        switch (approach) {\n          case ConsolidationApproachKeyIDEnum.OPERATIONAL_CONTROL_APPROACH:\n            formGroup.get('operationalControlApproach.emission').addValidators([Validators.required, Validators.min(0)]);\n            break;\n          case ConsolidationApproachKeyIDEnum.FINANCIAL_CONTROL_APPROACH:\n            formGroup.get('financialControlApproach.emission').addValidators([Validators.required, Validators.min(0)]);\n            break;\n          case ConsolidationApproachKeyIDEnum.EQUITY_CONTROL_APPROACH:\n            formGroup.get('equityShareApproach.emission').addValidators([Validators.required, Validators.min(0)]);\n            break;\n        }\n        this.updateValueAndValidity(formGroup);\n      }\n    }\n    updateValueAndValidity(formGroup) {\n      formGroup.get('operationalControlApproach.emission').updateValueAndValidity({\n        emitEvent: false\n      });\n      formGroup.get('financialControlApproach.emission').updateValueAndValidity({\n        emitEvent: false\n      });\n      formGroup.get('equityShareApproach.emission').updateValueAndValidity({\n        emitEvent: false\n      });\n    }\n    saveEmission() {\n      this.activityEmissionDataFG.markAllAsTouched();\n      let hasTrueValue1 = false;\n      let hasTrueValue2 = false;\n      if (this.emissionData) {\n        hasTrueValue1 = true;\n        hasTrueValue2 = true;\n      }\n      for (const [formGroup, value] of this.scope1FGMap) {\n        if (value === true) {\n          hasTrueValue1 = true;\n          break;\n        }\n      }\n      for (const [formGroup, value] of this.scope2FGMap) {\n        if (value === true) {\n          hasTrueValue2 = true;\n          break;\n        }\n      }\n      if (this.activityEmissionDataFG.invalid || hasTrueValue1 === false || hasTrueValue2 === false) {\n        this.toastrService.openToast('Error', 'At least one record must be filled from scope 1, scope 2. Scope 3 is optional.', ToastrColor.ERROR);\n        return false;\n      } else {\n        return true;\n      }\n    }\n  }\n  EmissionDataComponent.ɵfac = function EmissionDataComponent_Factory(t) {\n    return new (t || EmissionDataComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.StorageService), i0.ɵɵdirectiveInject(i3.ScopeService), i0.ɵɵdirectiveInject(i4.ToastrService), i0.ɵɵdirectiveInject(i5.UnitService));\n  };\n  EmissionDataComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EmissionDataComponent,\n    selectors: [[\"app-emission-data\"]],\n    inputs: {\n      consolidationApproachKeyIDList: \"consolidationApproachKeyIDList\",\n      emissionData: \"emissionData\",\n      action: \"action\",\n      year: \"year\",\n      dialogTitle: \"dialogTitle\"\n    },\n    features: [i0.ɵɵNgOnChangesFeature],\n    decls: 17,\n    vars: 6,\n    consts: [[\"xmlns\", \"http://www.w3.org/2000/svg\", 1, \"d-none\"], [\"id\", \"info-fill\", \"fill\", \"currentColor\", \"viewBox\", \"0 0 16 16\"], [\"d\", \"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z\"], [\"class\", \"mb-2 ms-2\", 4, \"ngIf\"], [3, \"formGroup\"], [1, \"table\"], [1, \"tableRowBgColor\", \"theadStickyOverwrite\"], [1, \"fw-bold\", \"columnWidth1\"], [1, \"fw-bold\", \"columnWidth2\"], [\"class\", \"fw-bold\", 4, \"ngIf\"], [\"formArrayName\", \"emissionRecords\"], [4, \"ngFor\", \"ngForOf\"], [1, \"mb-2\", \"ms-2\"], [1, \"alert\", \"alert-primary\", \"centerAlignVertical\", \"roundedBorder\", \"d-inline-flex\", \"p-2\", \"me-2\"], [1, \"alertIcon\", \"bi\", \"flex-shrink-0\"], [0, \"xlink\", \"href\", \"#info-fill\"], [1, \"extraInfoCardText\", \"px-3\"], [\"type\", \"button\", 1, \"btn\", 3, \"click\"], [1, \"material-symbols-outlined\", \"fw-bold\"], [1, \"fw-bold\"], [3, \"formGroupName\"], [4, \"ngIf\"], [\"formGroupName\", \"operationalControlApproach\"], [1, \"d-flex\", \"align-items-center\"], [1, \"col-sm-4\"], [1, \"matFieldWidth100\", 3, \"appearance\"], [1, \"formLabel\"], [\"matInput\", \"\", \"type\", \"number\", 3, \"min\", \"formControl\"], [\"input\", \"\"], [1, \"ms-2\", \"col-sm-4\"], [\"formGroupName\", \"financialControlApproach\"], [\"formGroupName\", \"equityShareApproach\"]],\n    template: function EmissionDataComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(0, \"svg\", 0);\n        i0.ɵɵelementStart(1, \"symbol\", 1);\n        i0.ɵɵelement(2, \"path\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(3, EmissionDataComponent_div_3_Template, 9, 0, \"div\", 3);\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(4, \"form\", 4);\n        i0.ɵɵelementStart(5, \"table\", 5);\n        i0.ɵɵelementStart(6, \"thead\", 6);\n        i0.ɵɵelementStart(7, \"tr\");\n        i0.ɵɵelementStart(8, \"td\", 7);\n        i0.ɵɵtext(9, \"Scope\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"td\", 8);\n        i0.ɵɵtext(11, \"Activity type\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(12, EmissionDataComponent_td_12_Template, 7, 0, \"td\", 9);\n        i0.ɵɵtemplate(13, EmissionDataComponent_td_13_Template, 7, 0, \"td\", 9);\n        i0.ɵɵtemplate(14, EmissionDataComponent_td_14_Template, 7, 0, \"td\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"tbody\", 10);\n        i0.ɵɵtemplate(16, EmissionDataComponent_tr_16_Template, 9, 6, \"tr\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.showInfo);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.activityEmissionDataFG);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngIf\", ctx.operationalControlApproachDisplay);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.financialControlApproachDisplay);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.equityShareApproachDisplay);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.getEmissionRecord().controls);\n      }\n    },\n    directives: [i6.NgIf, i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormArrayName, i6.NgForOf, i1.FormGroupName, i7.MatFormField, i7.MatLabel, i8.MatInput, i1.MinValidator, i1.NumberValueAccessor, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlDirective, i7.MatError],\n    styles: [\".mat-cell[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{border:none!important}td.mat-cell[_ngcontent-%COMP%], td.mat-footer-cell[_ngcontent-%COMP%]{padding:0;border-bottom-style:none}table[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1.6rem .5rem}.columnWidth1[_ngcontent-%COMP%]{min-width:120px}.columnWidth2[_ngcontent-%COMP%]{min-width:160px}.tableRowBgColor[_ngcontent-%COMP%]{background-color:#f0f8ff}\"]\n  });\n  return EmissionDataComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}