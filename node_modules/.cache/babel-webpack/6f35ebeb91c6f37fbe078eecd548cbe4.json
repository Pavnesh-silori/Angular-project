{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { FormControl, Validators } from '@angular/forms';\nimport { COMMA, ENTER } from '@angular/cdk/keycodes';\nimport * as moment from 'moment';\nimport { isEqual } from 'lodash';\nimport { DaterangepickerDirective } from 'ngx-daterangepicker-material';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { SubsidiaryEnum } from '@carbon/enum/subsidiary.enum';\nimport { RoleTypeEnum } from '@carbon/enum/role.enum';\nimport { CARBON_CONSTANT } from '@carbon/constant/carbon.constant';\n// tsc-library\nimport { ToastrColor, ToastrTitle } from '@library/toastr-service';\nimport { ButtonLabelEnum, COMMON_CONSTANT, DialogEnum, InvalidForm, MatSelectSearchService, MaterialFormFieldAppearance, MessageAlertIconEnum, MessageAlertTypeEnum } from '@library/tsc-common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@library/storage-service\";\nimport * as i2 from \"@carbon/service/consolidation-approach.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/material/dialog\";\nimport * as i5 from \"@carbon/controller/subsidiary.controller\";\nimport * as i6 from \"@library/toastr-service\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/material/button\";\nimport * as i9 from \"@angular/material/tooltip\";\nimport * as i10 from \"@angular/material/form-field\";\nimport * as i11 from \"@angular/material/select\";\nimport * as i12 from \"@angular/material/core\";\nimport * as i13 from \"ngx-mat-select-search\";\nimport * as i14 from \"@angular/material/input\";\nimport * as i15 from \"ngx-daterangepicker-material\";\nimport * as i16 from \"@angular/material/datepicker\";\nimport * as i17 from \"@library/tsc-common\";\nimport * as i18 from \"@angular/material/chips\";\nimport * as i19 from \"@angular/material/icon\";\nconst _c0 = [\"chipList\"];\nfunction CreateComponent_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.isRerequest ? \"Re-request\" : \"Edit Subsidiary/JV emission request\", \" \");\n  }\n}\nfunction CreateComponent_ng_template_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \" New Subsidiary/JV emission request \");\n  }\n}\nfunction CreateComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵelementStart(1, \"div\", 29);\n    i0.ɵɵelement(2, \"lib-message-alert\", 30);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"messageAlertTypeInp\", ctx_r3.messageAlertTypeEnum.INFO)(\"messageAlertIconInp\", ctx_r3.messageAlertIconEnum.INFO_ICON);\n  }\n}\nfunction CreateComponent_mat_option_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const subsidiary_r19 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", subsidiary_r19.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", subsidiary_r19[\"name\"], \" \");\n  }\n}\nfunction CreateComponent_mat_error_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Subsidiary/JV is mandatory \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CreateComponent_ng_container_25_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r20 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", (ctx_r20.subsidiary == null ? null : ctx_r20.subsidiary[\"financialControl\"]) + \"%\", \" Financial control \");\n  }\n}\nfunction CreateComponent_ng_container_25_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r21 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", (ctx_r21.subsidiary == null ? null : ctx_r21.subsidiary[\"operationalControl\"]) + \"%\", \" Operational control \");\n  }\n}\nfunction CreateComponent_ng_container_25_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r22 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", (ctx_r22.subsidiary == null ? null : ctx_r22.subsidiary[\"equityControl\"]) + \"%\", \" Equity control \");\n  }\n}\nfunction CreateComponent_ng_container_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 32);\n    i0.ɵɵelementStart(2, \"div\", 33);\n    i0.ɵɵelementStart(3, \"div\", 34);\n    i0.ɵɵtext(4, \" % control on Subsidiary/JV \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 35);\n    i0.ɵɵelementStart(6, \"div\", 36);\n    i0.ɵɵelementStart(7, \"div\", 37);\n    i0.ɵɵtemplate(8, CreateComponent_ng_container_25_div_8_Template, 2, 1, \"div\", 18);\n    i0.ɵɵtemplate(9, CreateComponent_ng_container_25_div_9_Template, 2, 1, \"div\", 18);\n    i0.ɵɵtemplate(10, CreateComponent_ng_container_25_div_10_Template, 2, 1, \"div\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.subsidiary == null ? null : ctx_r6.subsidiary[\"financialControl\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.subsidiary == null ? null : ctx_r6.subsidiary[\"operationalControl\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.subsidiary == null ? null : ctx_r6.subsidiary[\"equityControl\"]);\n  }\n}\nfunction CreateComponent_ng_container_26_ng_container_1_mat_option_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const assignee_r28 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", assignee_r28.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", assignee_r28[\"name\"], \" \");\n  }\n}\nfunction CreateComponent_ng_container_26_ng_container_1_mat_error_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Assignee is mandatory \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CreateComponent_ng_container_26_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"mat-form-field\", 39);\n    i0.ɵɵelementStart(2, \"mat-label\");\n    i0.ɵɵtext(3, \" Request emissions from(Select user) \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-select\", 40);\n    i0.ɵɵelementStart(5, \"mat-option\");\n    i0.ɵɵelement(6, \"ngx-mat-select-search\", 41);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, CreateComponent_ng_container_26_ng_container_1_mat_option_7_Template, 2, 2, \"mat-option\", 17);\n    i0.ɵɵpipe(8, \"async\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(9, CreateComponent_ng_container_26_ng_container_1_mat_error_9_Template, 2, 0, \"mat-error\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r23 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"appearance\", ctx_r23.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"formControl\", ctx_r23.assigneeSelectSearch.filterFC);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(8, 4, ctx_r23.assigneeSelectSearch.filteredEntities));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r23.errorHandling(\"assigneeID\", \"required\"));\n  }\n}\nfunction CreateComponent_ng_container_26_ng_template_2_mat_chip_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r35 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-chip\", 45);\n    i0.ɵɵlistener(\"removed\", function CreateComponent_ng_container_26_ng_template_2_mat_chip_5_Template_mat_chip_removed_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r35);\n      const email_r33 = restoredCtx.$implicit;\n      const ctx_r34 = i0.ɵɵnextContext(3);\n      return ctx_r34.removeEmail(email_r33);\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementStart(2, \"button\", 46);\n    i0.ɵɵelementStart(3, \"mat-icon\");\n    i0.ɵɵtext(4, \"cancel\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const email_r33 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", email_r33, \" \");\n  }\n}\nfunction CreateComponent_ng_container_26_ng_template_2_mat_error_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Assignee email is mandatory \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CreateComponent_ng_container_26_ng_template_2_mat_error_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Invalid email format \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CreateComponent_ng_container_26_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r37 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-form-field\", 39);\n    i0.ɵɵelementStart(1, \"mat-label\", 20);\n    i0.ɵɵtext(2, \" Request emissions from(Enter email id)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"mat-chip-list\", null, 42);\n    i0.ɵɵtemplate(5, CreateComponent_ng_container_26_ng_template_2_mat_chip_5_Template, 5, 1, \"mat-chip\", 43);\n    i0.ɵɵelementStart(6, \"input\", 44);\n    i0.ɵɵlistener(\"matChipInputTokenEnd\", function CreateComponent_ng_container_26_ng_template_2_Template_input_matChipInputTokenEnd_6_listener($event) {\n      i0.ɵɵrestoreView(_r37);\n      const ctx_r36 = i0.ɵɵnextContext(2);\n      return ctx_r36.addAssigneeEmail($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, CreateComponent_ng_container_26_ng_template_2_mat_error_7_Template, 2, 0, \"mat-error\", 18);\n    i0.ɵɵtemplate(8, CreateComponent_ng_container_26_ng_template_2_mat_error_8_Template, 2, 0, \"mat-error\", 18);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const _r29 = i0.ɵɵreference(4);\n    const ctx_r25 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"appearance\", ctx_r25.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r25.email.value);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"placeholder\", (ctx_r25.assigneeEmail == null ? null : ctx_r25.assigneeEmail.value == null ? null : ctx_r25.assigneeEmail.value.length) < 2 ? \"user.email@domain.com\" : \"\")(\"matChipInputFor\", _r29)(\"matChipInputSeparatorKeyCodes\", ctx_r25.separatorKeysCodes);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r29.errorState);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r25.invalidEmailFormat);\n  }\n}\nfunction CreateComponent_ng_container_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, CreateComponent_ng_container_26_ng_container_1_Template, 10, 6, \"ng-container\", 4);\n    i0.ɵɵtemplate(2, CreateComponent_ng_container_26_ng_template_2_Template, 9, 7, \"ng-template\", null, 38, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const _r24 = i0.ɵɵreference(3);\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r7.isInternal)(\"ngIfElse\", _r24);\n  }\n}\nfunction CreateComponent_ng_container_27_mat_option_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const consolidationApproach_r40 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", consolidationApproach_r40.keyID);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", consolidationApproach_r40[\"name\"], \" \");\n  }\n}\nfunction CreateComponent_ng_container_27_mat_error_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Consolidation approach is mandatory \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CreateComponent_ng_container_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"mat-form-field\", 14);\n    i0.ɵɵelementStart(2, \"mat-label\");\n    i0.ɵɵtext(3, \" Select consolidation approach \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-select\", 47);\n    i0.ɵɵelementStart(5, \"mat-option\");\n    i0.ɵɵelement(6, \"ngx-mat-select-search\", 48);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, CreateComponent_ng_container_27_mat_option_7_Template, 2, 2, \"mat-option\", 17);\n    i0.ɵɵpipe(8, \"async\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(9, CreateComponent_ng_container_27_mat_error_9_Template, 2, 0, \"mat-error\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"appearance\", ctx_r8.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"formControl\", ctx_r8.caSelectSearch.filterFC);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(8, 4, ctx_r8.caSelectSearch.filteredEntities));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.errorHandling(\"consolidationApproachKeyID\", \"required\"));\n  }\n}\nfunction CreateComponent_ng_template_28_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\nconst _c1 = function (a1) {\n  return {\n    title: \"Consolidation approach\",\n    value: a1\n  };\n};\nfunction CreateComponent_ng_template_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, CreateComponent_ng_template_28_ng_container_0_Template, 1, 0, \"ng-container\", 49);\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    const _r15 = i0.ɵɵreference(45);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", _r15)(\"ngTemplateOutletContext\", i0.ɵɵpureFunction1(2, _c1, ctx_r10.consolidationApproach[0] == null ? null : ctx_r10.consolidationApproach[0].name));\n  }\n}\nfunction CreateComponent_mat_error_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Accounting period is mandatory \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CreateComponent_ng_container_41_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 52);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r42 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r42.CARBON_CONSTANT.RE_REQUEST_BTN_LABEL, \" \");\n  }\n}\nfunction CreateComponent_ng_container_41_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 53);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r43 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r43.isEqual);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r43.ButtonLabelEnum.SAVE_BTN_LABEL, \" \");\n  }\n}\nfunction CreateComponent_ng_container_41_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, CreateComponent_ng_container_41_button_1_Template, 2, 1, \"button\", 50);\n    i0.ɵɵtemplate(2, CreateComponent_ng_container_41_button_2_Template, 2, 2, \"button\", 51);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r12.isRerequest);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r12.isRerequest);\n  }\n}\nfunction CreateComponent_ng_template_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 52);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r14 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r14.ButtonLabelEnum.CREATE_BTN_LABEL, \" \");\n  }\n}\nfunction CreateComponent_ng_template_44_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 36);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const value_r45 = i0.ɵɵnextContext().value;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", value_r45, \" \");\n  }\n}\nfunction CreateComponent_ng_template_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵelementStart(1, \"div\", 33);\n    i0.ɵɵelementStart(2, \"div\", 34);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, CreateComponent_ng_template_44_div_4_Template, 2, 1, \"div\", 54);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const title_r44 = ctx.title;\n    const value_r45 = ctx.value;\n    i0.ɵɵnextContext();\n    const _r17 = i0.ɵɵreference(47);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", title_r44, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", value_r45)(\"ngIfElse\", _r17);\n  }\n}\nfunction CreateComponent_ng_template_46_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 55);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r18 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r18.COMMON_CONSTANT.HYPHEN, \" \");\n  }\n}\nconst _c2 = function () {\n  return {\n    direction: \"ltr\",\n    applyLabel: \"Apply\",\n    format: \"DD-MMM-YYYY\",\n    customRangeLabel: \"Custom Range\"\n  };\n};\n// tsc-library\nexport let CreateComponent = /*#__PURE__*/(() => {\n  class CreateComponent {\n    constructor(storageService, ConsolidationApproachService, formBuilder, data, dialogRef, subsidiaryController, toastrService) {\n      this.storageService = storageService;\n      this.ConsolidationApproachService = ConsolidationApproachService;\n      this.formBuilder = formBuilder;\n      this.data = data;\n      this.dialogRef = dialogRef;\n      this.subsidiaryController = subsidiaryController;\n      this.toastrService = toastrService;\n      this.ButtonLabelEnum = ButtonLabelEnum;\n      this.COMMON_CONSTANT = COMMON_CONSTANT;\n      this.MaterialFormFieldAppearance = MaterialFormFieldAppearance;\n      this.messageAlertTypeEnum = MessageAlertTypeEnum;\n      this.messageAlertIconEnum = MessageAlertIconEnum;\n      this.CARBON_CONSTANT = CARBON_CONSTANT;\n      this.consolidationApproach = [];\n      this.caSelectSearch = new MatSelectSearchService(['name']);\n      this.subSelectSearch = new MatSelectSearchService(['name']);\n      this.assigneeSelectSearch = new MatSelectSearchService(['name']);\n      this.subsidiary = null;\n      this.isInternal = false;\n      this.addOnBlur = true;\n      this.separatorKeysCodes = [ENTER, COMMA];\n      this.accountingPeriodFC = new FormControl(null, Validators.required);\n      this.isEqual = false;\n      this.isUpdate = false;\n      this.isRerequest = false;\n      this.errorHandling = (control, error) => {\n        return this.requestFG.get(control).hasError(error);\n      };\n      dialogRef.disableClose = true;\n    }\n    ngOnInit() {\n      this.currentOrgID = this.storageService.getStorage('currentOrgID');\n      this.applicationKeyID = this.storageService.getStorage('applicationKeyID');\n      this.rootOrgID = this.storageService.getStorage('rootOrgID');\n      this.requestFGInit();\n    }\n    ngAfterViewInit() {\n      this.initCodeflow();\n    }\n    initCodeflow() {\n      var _a, _b;\n      return __awaiter(this, void 0, void 0, function* () {\n        this.subsidiaryList = yield this.getSubsidaryByOrgID(this.currentOrgID);\n        this.getAllConsolidationApproachByOrgID();\n        if ((_a = this.data) === null || _a === void 0 ? void 0 : _a['requestID']) {\n          this.isUpdate = true;\n          this.isRerequest = (_b = this.data) === null || _b === void 0 ? void 0 : _b.reRequest;\n          this.requestID = this.data['requestID'];\n          this.getEmissionRequestByID(this.requestID);\n          this.requestFG.valueChanges.subscribe(() => {\n            this.isEqual = isEqual(this.initialObject, this.requestFG.getRawValue());\n          });\n        }\n      });\n    }\n    requestFGInit() {\n      this.requestFG = this.formBuilder.group({\n        subsidiaryID: [, Validators.required],\n        assigneeID: [],\n        assigneeEmail: [[]],\n        startDate: [, Validators.required],\n        endDate: [, Validators.required],\n        consolidationApproachKeyID: [, Validators.required],\n        requestNote: []\n      });\n      this.accountingPeriodFC.valueChanges.subscribe(period => {\n        this.requestFG.patchValue({\n          startDate: moment(period['start']).format('YYYY-MM-DD'),\n          endDate: moment(period['end']).format('YYYY-MM-DD')\n        });\n      });\n    }\n    get subsidiaryIDAC() {\n      return this.requestFG.get('subsidiaryID');\n    }\n    get email() {\n      return this.requestFG.get('assigneeEmail');\n    }\n    get assigneeID() {\n      return this.requestFG.get('assigneeID');\n    }\n    get assigneeEmail() {\n      return this.requestFG.get('assigneeEmail');\n    }\n    getAllConsolidationApproachByOrgID() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.consolidationApproach = yield this.ConsolidationApproachService.getAllConsolidationApproachByOrgID(this.rootOrgID);\n        this.caSelectSearch.entityArr = this.consolidationApproach;\n        this.caSelectSearch.createSubscription();\n      });\n    }\n    getSubsidaryByOrgID(orgID) {\n      return new Promise(resolve => {\n        this.subsidiaryController.getSubsidiaryByOrgID(orgID, SubsidiaryEnum.APPROVED).subscribe(response => {\n          this.subsidiaryList = response;\n          this.subSelectSearch.entityArr = response;\n          this.subSelectSearch.createSubscription();\n          resolve(response);\n        });\n      });\n    }\n    setSubsidary(subsidiaryID) {\n      this.subsidiary = this.subsidiaryList.find(subsidiary => subsidiary['id'] == subsidiaryID);\n      return this.isInternal = this.subsidiary['isInternal'];\n    }\n    getSubsidiaryUserListByOrgIDAndsubsidiaryID(subsidiaryID) {\n      this.assigneeID.reset([]);\n      this.assigneeEmail.reset([]);\n      this.assigneeID.clearValidators();\n      this.assigneeEmail.clearValidators();\n      this.setAssigneeValidatorsAndGetAssignee(subsidiaryID);\n    }\n    setAssigneeValidatorsAndGetAssignee(subsidiaryID) {\n      if (this.setSubsidary(subsidiaryID)) {\n        this.assigneeID.setValidators([Validators.required]);\n        this.subsidiaryController.getSubsidaryUserListByOrgIDAndsubsidiaryID(this.currentOrgID, subsidiaryID, this.applicationKeyID, RoleTypeEnum.ADMIN).subscribe(response => {\n          this.assigneeSelectSearch.entityArr = response;\n          this.assigneeSelectSearch.createSubscription();\n        });\n      } else {\n        this.assigneeEmail.setValidators([Validators.required]);\n      }\n      this.assigneeID.updateValueAndValidity();\n      this.assigneeEmail.updateValueAndValidity();\n    }\n    getEmissionRequestByID(requestID) {\n      this.subsidiaryController.getEmissionRequestByID(requestID).subscribe(request => {\n        this.emissionRequest = request;\n        this.patchData(this.emissionRequest);\n      });\n    }\n    patchData(request) {\n      let requestee = request['requestee'];\n      this.requestFG.patchValue({\n        subsidiaryID: requestee['id'],\n        assigneeID: request['assigneeUser'].map(user => user['id']),\n        assigneeEmail: request['assigneeEmail'],\n        consolidationApproachKeyID: request['consolidationApproach'].map(ca => ca['keyID']),\n        requestNote: request['requestNote']\n      });\n      this.subsidiaryIDAC.disable();\n      this.setAssigneeValidatorsAndGetAssignee(requestee['id']);\n      this.accountingPeriodFC.patchValue({\n        start: moment(request['startDate']),\n        end: moment(request['endDate'])\n      });\n      this.initialObject = this.requestFG.getRawValue();\n      this.isEqual = isEqual(this.initialObject, this.requestFG.getRawValue());\n    }\n    removeEmail(email) {\n      const index = this.email.value.indexOf(email);\n      if (index >= 0) {\n        const emails = [...this.email.value];\n        emails.splice(index, 1);\n        this.email.setValue(emails);\n      }\n    }\n    addAssigneeEmail(event) {\n      const email = (event.value || '').trim();\n      if (email) {\n        if (this.isValidEmail(email)) {\n          this.userEmailChipList.errorState = false;\n          this.email.patchValue([...this.email.value, email]);\n          event.chipInput.clear();\n        } else {\n          this.toastrService.openToast(ToastrTitle.ERROR, 'Invalid email format!', ToastrColor.ERROR);\n        }\n      }\n    }\n    isValidEmail(email) {\n      const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n      return emailRegex.test(email);\n    }\n    isValidForm() {\n      if (this.requestFG.invalid) {\n        console.log('invalid form - ', this.requestFG);\n        this.toastrService.openToast(ToastrTitle.ERROR, InvalidForm.INVALID_FORM_MESSAGE, ToastrColor.ERROR);\n        if (this.subsidiary != null && !this.subsidiary['isInternal']) {\n          this.userEmailChipList.errorState = this.assigneeEmail.invalid;\n        }\n        return;\n      }\n      if (this.isUpdate) this.resendEmissionRequest();else this.sendEmissionRequest();\n    }\n    sendEmissionRequest() {\n      this.subsidiaryController.sendEmissionRequest(this.currentOrgID, this.requestFG.value).subscribe(response => {\n        this.dialogRef.close(DialogEnum.SUCCESS_DR);\n      });\n    }\n    resendEmissionRequest() {\n      this.subsidiaryController.reSendEmissionRequest(this.currentOrgID, this.requestID, this.requestFG.value).subscribe(response => {\n        this.dialogRef.close(DialogEnum.SUCCESS_DR);\n      });\n    }\n  }\n  CreateComponent.ɵfac = function CreateComponent_Factory(t) {\n    return new (t || CreateComponent)(i0.ɵɵdirectiveInject(i1.StorageService), i0.ɵɵdirectiveInject(i2.ConsolidationApproachService), i0.ɵɵdirectiveInject(i3.FormBuilder), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i4.MatDialogRef), i0.ɵɵdirectiveInject(i5.SubsidiaryController), i0.ɵɵdirectiveInject(i6.ToastrService));\n  };\n  CreateComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CreateComponent,\n    selectors: [[\"app-create\"]],\n    viewQuery: function CreateComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(DaterangepickerDirective, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.userEmailChipList = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.dateRangePicker = _t.first);\n      }\n    },\n    decls: 48,\n    vars: 30,\n    consts: [[1, \"card\", \"main-card\", \"cardOverwrite\"], [1, \"headerContainer\", \"p-0\"], [1, \"col-sm-11\"], [1, \"pageTitle\"], [4, \"ngIf\", \"ngIfElse\"], [\"add\", \"\"], [1, \"col-sm-1\", \"mb-auto\"], [\"mat-icon-button\", \"\", \"mat-dialog-close\", \"\", \"cdkFocusInitial\", \"\", \"matTooltip\", \"Close\", \"matTooltipPosition\", \"before\", 1, \"float-end\", \"matDialogClose\"], [1, \"material-symbols-outlined\"], [\"class\", \"mt-2\", 4, \"ngIf\"], [1, \"mt-4\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"row\"], [1, \"col-sm-12\"], [1, \"matFieldWidth100\", 3, \"appearance\"], [\"formControlName\", \"subsidiaryID\", 3, \"selectionChange\"], [\"placeholderLabel\", \"Search by name\", \"noEntriesFoundLabel\", \"No matching subsidiary/JV found.\", 3, \"formControl\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [\"singleCA\", \"\"], [1, \"formLabel\"], [\"type\", \"text\", \"matInput\", \"\", \"ngxDaterangepickerMd\", \"\", \"startKey\", \"start\", \"endKey\", \"end\", \"autocomplete\", \"off\", \"name\", \"daterange\", 3, \"readonly\", \"locale\", \"drops\", \"opens\", \"alwaysShowCalendars\", \"keepCalendarOpeningWithRange\", \"showDropdowns\", \"showCancel\", \"formControl\"], [\"matSuffix\", \"\", 3, \"for\"], [\"matInput\", \"\", \"rows\", \"3\", \"formControlName\", \"requestNote\"], [\"align\", \"end\"], [\"create\", \"\"], [\"value\", \"\"], [\"hyphen\", \"\"], [1, \"mt-2\"], [1, \"mb-2\"], [\"contentInp\", \"Since your last request was declined, try requesting emissions from a different person or make\\n                some other changes to submit the request again.\", 3, \"messageAlertTypeInp\", \"messageAlertIconInp\"], [3, \"value\"], [1, \"row\", \"pb-1\"], [1, \"d-flex\", \"justify-content-between\"], [1, \"col-form-label\", \"ms-1\"], [1, \"py-2\"], [1, \"col-form-value\", \"fw-bold\"], [1, \"pb-1\"], [\"external\", \"\"], [1, \"matFieldWidth100\", \"pt-3\", 3, \"appearance\"], [\"formControlName\", \"assigneeID\", \"multiple\", \"\"], [\"placeholderLabel\", \"Search by user name\", \"noEntriesFoundLabel\", \"No matching user found.\", 3, \"formControl\"], [\"chipList\", \"\"], [3, \"removed\", 4, \"ngFor\", \"ngForOf\"], [\"matChipInputAddOnBlur\", \"\", 3, \"placeholder\", \"matChipInputFor\", \"matChipInputSeparatorKeyCodes\", \"matChipInputTokenEnd\"], [3, \"removed\"], [\"matChipRemove\", \"\"], [\"formControlName\", \"consolidationApproachKeyID\", \"multiple\", \"\"], [\"placeholderLabel\", \"Search by consolidation approach name\", \"noEntriesFoundLabel\", \"No matching approach found.\", 3, \"formControl\"], [4, \"ngTemplateOutlet\", \"ngTemplateOutletContext\"], [\"type\", \"submit\", \"class\", \"btn btn-success\", 4, \"ngIf\"], [\"type\", \"submit\", \"class\", \"btn btn-success\", 3, \"disabled\", 4, \"ngIf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\", 3, \"disabled\"], [\"class\", \"col-form-value fw-bold\", 4, \"ngIf\", \"ngIfElse\"], [1, \"fw-bold\"]],\n    template: function CreateComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵtemplate(4, CreateComponent_ng_container_4_Template, 2, 1, \"ng-container\", 4);\n        i0.ɵɵtemplate(5, CreateComponent_ng_template_5_Template, 1, 0, \"ng-template\", null, 5, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\", 6);\n        i0.ɵɵelementStart(8, \"button\", 7);\n        i0.ɵɵelementStart(9, \"span\", 8);\n        i0.ɵɵtext(10, \" close \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(11, CreateComponent_div_11_Template, 3, 2, \"div\", 9);\n        i0.ɵɵelementStart(12, \"div\", 10);\n        i0.ɵɵelementStart(13, \"form\", 11);\n        i0.ɵɵlistener(\"ngSubmit\", function CreateComponent_Template_form_ngSubmit_13_listener() {\n          return ctx.isValidForm();\n        });\n        i0.ɵɵelementStart(14, \"div\", 12);\n        i0.ɵɵelementStart(15, \"div\", 13);\n        i0.ɵɵelementStart(16, \"mat-form-field\", 14);\n        i0.ɵɵelementStart(17, \"mat-label\");\n        i0.ɵɵtext(18, \" Select Subsidiary/JV \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"mat-select\", 15);\n        i0.ɵɵlistener(\"selectionChange\", function CreateComponent_Template_mat_select_selectionChange_19_listener($event) {\n          return ctx.getSubsidiaryUserListByOrgIDAndsubsidiaryID($event.value);\n        });\n        i0.ɵɵelementStart(20, \"mat-option\");\n        i0.ɵɵelement(21, \"ngx-mat-select-search\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(22, CreateComponent_mat_option_22_Template, 2, 2, \"mat-option\", 17);\n        i0.ɵɵpipe(23, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(24, CreateComponent_mat_error_24_Template, 2, 0, \"mat-error\", 18);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(25, CreateComponent_ng_container_25_Template, 11, 3, \"ng-container\", 18);\n        i0.ɵɵtemplate(26, CreateComponent_ng_container_26_Template, 4, 2, \"ng-container\", 18);\n        i0.ɵɵtemplate(27, CreateComponent_ng_container_27_Template, 10, 6, \"ng-container\", 4);\n        i0.ɵɵtemplate(28, CreateComponent_ng_template_28_Template, 1, 4, \"ng-template\", null, 19, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementStart(30, \"mat-form-field\", 14);\n        i0.ɵɵelementStart(31, \"mat-label\", 20);\n        i0.ɵɵtext(32, \" Accounting period \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(33, \"input\", 21);\n        i0.ɵɵelement(34, \"mat-datepicker-toggle\", 22);\n        i0.ɵɵtemplate(35, CreateComponent_mat_error_35_Template, 2, 0, \"mat-error\", 18);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"mat-form-field\", 14);\n        i0.ɵɵelementStart(37, \"mat-label\", 20);\n        i0.ɵɵtext(38, \" Add a note \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(39, \"textarea\", 23);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"div\", 24);\n        i0.ɵɵtemplate(41, CreateComponent_ng_container_41_Template, 3, 2, \"ng-container\", 4);\n        i0.ɵɵtemplate(42, CreateComponent_ng_template_42_Template, 2, 1, \"ng-template\", null, 25, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(44, CreateComponent_ng_template_44_Template, 5, 3, \"ng-template\", null, 26, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(46, CreateComponent_ng_template_46_Template, 2, 1, \"ng-template\", null, 27, i0.ɵɵtemplateRefExtractor);\n      }\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(6);\n        const _r9 = i0.ɵɵreference(29);\n        const _r13 = i0.ɵɵreference(43);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.isUpdate)(\"ngIfElse\", _r1);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngIf\", ctx.isRerequest);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"formGroup\", ctx.requestFG);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"appearance\", ctx.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"formControl\", ctx.subSelectSearch.filterFC);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(23, 27, ctx.subSelectSearch.filteredEntities));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.errorHandling(\"subsidiaryID\", \"required\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.subsidiary);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.subsidiaryIDAC.value);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.consolidationApproach.length > 1)(\"ngIfElse\", _r9);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"appearance\", ctx.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"readonly\", true)(\"locale\", i0.ɵɵpureFunction0(29, _c2))(\"drops\", \"down\")(\"opens\", \"right\")(\"alwaysShowCalendars\", true)(\"keepCalendarOpeningWithRange\", true)(\"showDropdowns\", true)(\"showCancel\", true)(\"formControl\", ctx.accountingPeriodFC);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"for\", ctx.dateRangePicker);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.accountingPeriodFC.hasError(\"required\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"appearance\", ctx.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.isUpdate)(\"ngIfElse\", _r13);\n      }\n    },\n    directives: [i7.NgIf, i8.MatButton, i4.MatDialogClose, i9.MatTooltip, i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.FormGroupDirective, i10.MatFormField, i10.MatLabel, i11.MatSelect, i3.NgControlStatus, i3.FormControlName, i12.MatOption, i13.MatSelectSearchComponent, i3.FormControlDirective, i7.NgForOf, i14.MatInput, i15.DaterangepickerDirective, i3.DefaultValueAccessor, i16.MatDatepickerToggle, i10.MatSuffix, i17.MessageAlertComponent, i10.MatError, i18.MatChipList, i18.MatChipInput, i18.MatChip, i18.MatChipRemove, i19.MatIcon, i7.NgTemplateOutlet],\n    pipes: [i7.AsyncPipe],\n    styles: [\"\"]\n  });\n  return CreateComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}