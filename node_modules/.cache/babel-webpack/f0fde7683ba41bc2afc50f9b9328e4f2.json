{"ast":null,"code":"import { merge } from 'rxjs';\nimport { SCOPE_WISE_EMISSION_MD, CARBON_EMISSION_TREND_MD, ACTIVITY_WISE_EMISSION_MD } from '@carbon/constant/chart.constant';\n// tsc-library\nimport { COMMON_CONSTANT } from '@library/tsc-common';\nimport { ToastrTitle, ToastrColor } from '@library/toastr-service';\nimport { DateFormatEnum, FrequencyEnum } from '@library/date';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@carbon/controller/dashboard.controller\";\nimport * as i2 from \"@library/date\";\nimport * as i3 from \"@library/storage-service\";\nimport * as i4 from \"@library/toastr-service\";\nimport * as i5 from \"../_shared/filter/filter.component\";\nimport * as i6 from \"@angular/material/tooltip\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"../../../../../../../netzero/src/app/tsc/component/_shared/chart/doughnut-chart/doughnut-chart.component\";\nimport * as i9 from \"../../../../../../../netzero/src/app/tsc/component/_shared/chart/stacked-horizontal-bar-chart/stacked-horizontal-bar-chart.component\";\nimport * as i10 from \"../../../../../../../netzero/src/app/tsc/component/_shared/chart/horizontal-bar-chart/horizontal-bar-chart.component\";\nconst _c0 = [\"filterChild\"];\nconst _c1 = [\"carbonFilterChild\"];\nconst _c2 = function (a0, a1) {\n  return {\n    \"fw-bold text-primary\": a0,\n    \"fw-light text-secondary\": a1\n  };\n};\n// /tsc-library/\nexport let FootprintComponent = /*#__PURE__*/(() => {\n  class FootprintComponent {\n    constructor(dashboardController, dateService,\n    // tsc-library\n    storageService, toastrService) {\n      this.dashboardController = dashboardController;\n      this.dateService = dateService;\n      this.toastrService = toastrService;\n      this.scopeWiseEmissionRenderFlag = 'LOADING';\n      this.scopeWiseEmissionMD = SCOPE_WISE_EMISSION_MD;\n      this.carbonEmissionTrendRenderFlag = 'LOADING';\n      this.carbonEmissionTrendMD = CARBON_EMISSION_TREND_MD;\n      this.activityWiseEmissionRenderFlag = 'LOADING';\n      this.activityWiseEmissionMD = ACTIVITY_WISE_EMISSION_MD;\n      this.currentOrgID = parseInt(storageService.getStorage('currentOrgID'));\n    }\n    ngOnInit() {}\n    ngAfterViewInit() {\n      merge(this.filterChild.emitFilter, this.carbonFilterChild.emitFilter).subscribe(() => this.checkAllFilters());\n    }\n    checkAllFilters() {\n      if (this.carbonFilterChild.consolidationApproach != null) {\n        this.getFootprintDashboard();\n      }\n    }\n    getFootprintDashboard() {\n      if (this.filterChild.frequencyFC.value == FrequencyEnum.CUSTOM && !this.filterChild.startDateFC && !this.filterChild.endDateFC) {\n        return;\n      }\n      this.scopeWiseEmissionRenderFlag = 'LOADING';\n      this.carbonEmissionTrendRenderFlag = 'LOADING';\n      this.activityWiseEmissionRenderFlag = 'LOADING';\n      let startDate = this.dateService.convertUtcToTimeZone(this.filterChild.startDateFC.value, COMMON_CONSTANT.ASIAN_KOLKATA, DateFormatEnum.YYYY_MM_DD);\n      let endDate = this.dateService.convertUtcToTimeZone(this.filterChild.endDateFC.value, COMMON_CONSTANT.ASIAN_KOLKATA, DateFormatEnum.YYYY_MM_DD);\n      this.dashboardController.getFootprintDashboard(this.currentOrgID, startDate, endDate, this.carbonFilterChild.facilityFC.value, this.carbonFilterChild.subsidiaryFC.value, this.carbonFilterChild.consolidationApproachFC.value).subscribe(data => {\n        if (data['emission'] && data['emission']['data']) {\n          this.uomName = data['emission']['uomName'];\n          this.totalEmission = data['emission']['data']['totalEmission'];\n          this.scope1Emission = data['emission']['data']['scope1Emission'];\n          this.scope2Emission = data['emission']['data']['scope2Emission'];\n          this.scope3Emission = data['emission']['data']['scope3Emission'];\n          this.totalBiogenicEmission = data['emission']['data']['totalBiogenicEmission'];\n        }\n        if (data['scopeWiseEmission'] && data['scopeWiseEmission']['data']) {\n          this.scopeWiseEmission = data['scopeWiseEmission'];\n          this.scopeWiseEmissionRenderFlag = 'DATA';\n        } else {\n          this.scopeWiseEmissionRenderFlag = 'NO_DATA';\n        }\n        if (data['carbonEmissionTrend'] && data['carbonEmissionTrend']['data']) {\n          this.carbonEmissionTrend = data['carbonEmissionTrend'];\n          this.carbonEmissionTrendRenderFlag = 'DATA';\n        } else {\n          this.carbonEmissionTrendRenderFlag = 'NO_DATA';\n        }\n        if (data['activityWiseEmission'] && data['activityWiseEmission']['data']) {\n          this.activityWiseEmission = data['activityWiseEmission'];\n          this.activityWiseEmissionRenderFlag = 'DATA';\n        } else {\n          this.activityWiseEmissionRenderFlag = 'NO_DATA';\n        }\n      }, error => {\n        this.scopeWiseEmissionRenderFlag = 'NO_DATA';\n        this.carbonEmissionTrendRenderFlag = 'NO_DATA';\n        this.activityWiseEmissionRenderFlag = 'NO_DATA';\n        this.toastrService.openToast(ToastrTitle.ERROR, 'Error in getting dashboard values', ToastrColor.ERROR);\n      });\n    }\n  }\n  FootprintComponent.ɵfac = function FootprintComponent_Factory(t) {\n    return new (t || FootprintComponent)(i0.ɵɵdirectiveInject(i1.DashboardController), i0.ɵɵdirectiveInject(i2.DateService), i0.ɵɵdirectiveInject(i3.StorageService), i0.ɵɵdirectiveInject(i4.ToastrService));\n  };\n  FootprintComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FootprintComponent,\n    selectors: [[\"app-footprint\"]],\n    viewQuery: function FootprintComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.filterChild = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.carbonFilterChild = _t.first);\n      }\n    },\n    decls: 60,\n    vars: 60,\n    consts: [[1, \"card\", \"main-card\", \"cardOverwrite\", \"mb-4\"], [1, \"card-body\", \"pt-2\", \"pb-0\"], [\"filterChild\", \"\"], [1, \"float-end\", 3, \"module\"], [\"carbonFilterChild\", \"\"], [1, \"outerDiv\", \"mb-4\", \"fs-5\"], [1, \"card\", \"main-card\", \"cardOverwrite\", \"innerDiv\", \"me-4\"], [\"matTooltipPosition\", \"above\", 1, \"card-body\", 3, \"matTooltip\"], [1, \"fs-1\", 3, \"ngClass\"], [1, \"text-secondary\"], [1, \"card\", \"main-card\", \"cardOverwrite\", \"innerDiv\"], [1, \"row\", \"mb-4\"], [1, \"col-sm-6\"], [3, \"renderFlag\", \"chartData\", \"chartMetaData\"], [1, \"row\"], [1, \"col-sm-12\"]],\n    template: function FootprintComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelement(2, \"lib-date-filter\", null, 2);\n        i0.ɵɵelement(4, \"app-filter-carbon\", 3, 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 5);\n        i0.ɵɵelementStart(7, \"div\", 6);\n        i0.ɵɵelementStart(8, \"div\", 7);\n        i0.ɵɵelementStart(9, \"div\", 8);\n        i0.ɵɵtext(10);\n        i0.ɵɵpipe(11, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"div\", 9);\n        i0.ɵɵtext(13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"div\", 9);\n        i0.ɵɵtext(15, \"Total Emissions\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 6);\n        i0.ɵɵelementStart(17, \"div\", 7);\n        i0.ɵɵelementStart(18, \"div\", 8);\n        i0.ɵɵtext(19);\n        i0.ɵɵpipe(20, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"div\", 9);\n        i0.ɵɵtext(22);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"div\", 9);\n        i0.ɵɵtext(24, \"Scope 1 Emissions\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\", 6);\n        i0.ɵɵelementStart(26, \"div\", 7);\n        i0.ɵɵelementStart(27, \"div\", 8);\n        i0.ɵɵtext(28);\n        i0.ɵɵpipe(29, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"div\", 9);\n        i0.ɵɵtext(31);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"div\", 9);\n        i0.ɵɵtext(33, \"Scope 2 Emissions\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"div\", 6);\n        i0.ɵɵelementStart(35, \"div\", 7);\n        i0.ɵɵelementStart(36, \"div\", 8);\n        i0.ɵɵtext(37);\n        i0.ɵɵpipe(38, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"div\", 9);\n        i0.ɵɵtext(40);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"div\", 9);\n        i0.ɵɵtext(42, \"Scope 3 Emissions\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(43, \"div\", 10);\n        i0.ɵɵelementStart(44, \"div\", 7);\n        i0.ɵɵelementStart(45, \"div\", 8);\n        i0.ɵɵtext(46);\n        i0.ɵɵpipe(47, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(48, \"div\", 9);\n        i0.ɵɵtext(49);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"div\", 9);\n        i0.ɵɵtext(51, \"Biogenic Emissions\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(52, \"div\", 11);\n        i0.ɵɵelementStart(53, \"div\", 12);\n        i0.ɵɵelement(54, \"app-doughnut-chart\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(55, \"div\", 12);\n        i0.ɵɵelement(56, \"app-stacked-horizontal-bar-chart\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(57, \"div\", 14);\n        i0.ɵɵelementStart(58, \"div\", 15);\n        i0.ɵɵelement(59, \"app-horizontal-bar-chart\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"module\", \"dashboard\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"matTooltip\", ctx.totalEmission);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(45, _c2, ctx.totalEmission != null, ctx.totalEmission == null));\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \", ctx.totalEmission == null ? \"No Data\" : i0.ɵɵpipeBind2(11, 30, ctx.totalEmission, \"1.2-2\"), \"\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.totalEmission == null ? \"\\u00A0\" : ctx.uomName);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"matTooltip\", ctx.scope1Emission);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(48, _c2, ctx.scope1Emission != null, ctx.scope1Emission == null));\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \", ctx.scope1Emission == null ? \"No Data\" : i0.ɵɵpipeBind2(20, 33, ctx.scope1Emission, \"1.2-2\"), \"\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.scope1Emission == null ? \"\\u00A0\" : ctx.uomName);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"matTooltip\", ctx.scope2Emission);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(51, _c2, ctx.scope2Emission != null, ctx.scope2Emission == null));\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \", ctx.scope2Emission == null ? \"No Data\" : i0.ɵɵpipeBind2(29, 36, ctx.scope2Emission, \"1.2-2\"), \"\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.scope2Emission == null ? \"\\u00A0\" : ctx.uomName);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"matTooltip\", ctx.scope3Emission);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(54, _c2, ctx.scope3Emission != null, ctx.scope3Emission == null));\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \", ctx.scope3Emission == null ? \"No Data\" : i0.ɵɵpipeBind2(38, 39, ctx.scope3Emission, \"1.2-2\"), \"\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.scope3Emission == null ? \"\\u00A0\" : ctx.uomName);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"matTooltip\", ctx.totalBiogenicEmission);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(57, _c2, ctx.totalBiogenicEmission != null, ctx.totalBiogenicEmission == null));\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \", ctx.totalBiogenicEmission == null ? \"No Data\" : i0.ɵɵpipeBind2(47, 42, ctx.totalBiogenicEmission, \"1.2-2\"), \"\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.totalBiogenicEmission == null ? \"\\u00A0\" : ctx.uomName);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"renderFlag\", ctx.scopeWiseEmissionRenderFlag)(\"chartData\", ctx.scopeWiseEmission)(\"chartMetaData\", ctx.scopeWiseEmissionMD);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"renderFlag\", ctx.carbonEmissionTrendRenderFlag)(\"chartData\", ctx.carbonEmissionTrend)(\"chartMetaData\", ctx.carbonEmissionTrendMD);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"renderFlag\", ctx.activityWiseEmissionRenderFlag)(\"chartData\", ctx.activityWiseEmission)(\"chartMetaData\", ctx.activityWiseEmissionMD);\n      }\n    },\n    directives: [i2.DateFilterComponent, i5.CarbonFilterComponent, i6.MatTooltip, i7.NgClass, i8.DoughnutChartComponent, i9.StackedHorizontalBarChartComponent, i10.HorizontalBarChartComponent],\n    pipes: [i7.DecimalPipe],\n    styles: [\".outerDiv[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;box-sizing:border-box}.innerDiv[_ngcontent-%COMP%]{flex:1}\"]\n  });\n  return FootprintComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}