{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { Validators } from '@angular/forms';\nimport * as moment from 'moment';\nimport { isEqual } from \"lodash\";\nimport { EmissionDataDialog } from '../../emission-data-dialog/emission-data-dialog.component';\nimport { date_format_providers } from '@carbon/constant/carbon.constant';\nimport { StructuralChangeData } from '@carbon/model/ghg-base-year.model';\nimport { StructuralChangeTabTypeEnum, StructuralChangeTypeEnum } from '@carbon/enum/ghg.enum';\nimport { BaseYearEnum } from '@carbon/enum/base-year.enum';\n// tsc-library\nimport { ButtonLabelEnum, FormAction, InvalidForm, MaterialFormFieldAppearance } from '@library/tsc-common';\nimport { ToastrColor } from '@library/toastr-service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@carbon/service/consolidation-approach.service\";\nimport * as i3 from \"@library/storage-service\";\nimport * as i4 from \"@library/date\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/material/dialog\";\nimport * as i7 from \"@carbon/controller/base-year.controller\";\nimport * as i8 from \"@carbon/controller/ghg-base-year.controller\";\nimport * as i9 from \"@carbon/service/ghg.service\";\nimport * as i10 from \"@library/toastr-service\";\nimport * as i11 from \"@angular/common\";\nimport * as i12 from \"@angular/material/form-field\";\nimport * as i13 from \"@angular/material/input\";\nimport * as i14 from \"@angular/material/select\";\nimport * as i15 from \"@angular/material/core\";\nimport * as i16 from \"@angular/material/datepicker\";\nfunction UpdateComponent_mat_error_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Business entity name is required \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UpdateComponent_mat_option_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const years_r8 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", years_r8);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", years_r8, \" \");\n  }\n}\nfunction UpdateComponent_mat_error_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Business entity start year is required \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UpdateComponent_mat_error_47_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Merger / Acquisition date is required \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UpdateComponent_ng_container_48_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 32);\n    i0.ɵɵelementStart(2, \"div\", 33);\n    i0.ɵɵelementStart(3, \"div\", 34);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(4, \"svg\", 35);\n    i0.ɵɵelement(5, \"use\", 36);\n    i0.ɵɵelementEnd();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(6, \"div\", 37);\n    i0.ɵɵtext(7, \"For submitting the record you have to confirm emissions for atleast one year.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction UpdateComponent_div_49_ng_container_6_span_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \" Not applicable \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UpdateComponent_div_49_ng_container_6_span_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \" Business entity did not exist in this year \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UpdateComponent_div_49_ng_container_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 8);\n    i0.ɵɵelementStart(2, \"div\", 41);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 11);\n    i0.ɵɵelementStart(5, \"div\", 34);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(6, \"svg\", 42);\n    i0.ɵɵelement(7, \"path\", 2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, UpdateComponent_div_49_ng_container_6_span_8_Template, 2, 0, \"span\", 15);\n    i0.ɵɵtemplate(9, UpdateComponent_div_49_ng_container_6_span_9_Template, 2, 0, \"span\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r9.noEntityYearRange, \" \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.updateMergerAcquisitionFG.controls[\"entityStartYear\"].value < ctx_r9.baseYear);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.updateMergerAcquisitionFG.controls[\"entityStartYear\"].value > ctx_r9.baseYear);\n  }\n}\nfunction UpdateComponent_div_49_ng_container_7_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \" (optional) \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UpdateComponent_div_49_ng_container_7_div_6_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 48);\n    i0.ɵɵlistener(\"click\", function UpdateComponent_div_49_ng_container_7_div_6_button_1_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r21);\n      const years_r13 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r19 = i0.ɵɵnextContext(2);\n      return ctx_r19.openGhgEmissionDialog(years_r13, \"update\");\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", \"Update Emission\", \" \");\n  }\n}\nfunction UpdateComponent_div_49_ng_container_7_div_6_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 48);\n    i0.ɵɵlistener(\"click\", function UpdateComponent_div_49_ng_container_7_div_6_button_2_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const years_r13 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r22 = i0.ɵɵnextContext(2);\n      return ctx_r22.openGhgEmissionDialog(years_r13, \"create\");\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", \"Enter Emission\", \" \");\n  }\n}\nfunction UpdateComponent_div_49_ng_container_7_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 46);\n    i0.ɵɵtemplate(1, UpdateComponent_div_49_ng_container_7_div_6_button_1_Template, 2, 1, \"button\", 47);\n    i0.ɵɵtemplate(2, UpdateComponent_div_49_ng_container_7_div_6_button_2_Template, 2, 1, \"button\", 47);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const years_r13 = i0.ɵɵnextContext().$implicit;\n    const ctx_r15 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r15.fillEmissionYear.includes(years_r13));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r15.fillEmissionYear.includes(years_r13));\n  }\n}\nfunction UpdateComponent_div_49_ng_container_7_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 49);\n    i0.ɵɵtext(1, \" Please enter emissions for the base year. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UpdateComponent_div_49_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 43);\n    i0.ɵɵelementContainerStart(2);\n    i0.ɵɵelementStart(3, \"div\", 41);\n    i0.ɵɵtext(4);\n    i0.ɵɵtemplate(5, UpdateComponent_div_49_ng_container_7_span_5_Template, 2, 0, \"span\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, UpdateComponent_div_49_ng_container_7_div_6_Template, 3, 2, \"div\", 44);\n    i0.ɵɵtemplate(7, UpdateComponent_div_49_ng_container_7_div_7_Template, 2, 0, \"div\", 45);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const years_r13 = ctx.$implicit;\n    const ctx_r10 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", years_r13, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", years_r13 != ctx_r10.baseYear && years_r13 >= ctx_r10.baseYear);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", years_r13 >= ctx_r10.baseYear);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", years_r13 == ctx_r10.baseYear && ctx_r10.emissionsForBaseYearRequired);\n  }\n}\nfunction UpdateComponent_div_49_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵelementStart(1, \"div\", 9);\n    i0.ɵɵelementStart(2, \"div\", 8);\n    i0.ɵɵelementStart(3, \"div\", 38);\n    i0.ɵɵelementStart(4, \"div\", 39);\n    i0.ɵɵtext(5, \" Enter emissions \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, UpdateComponent_div_49_ng_container_6_Template, 10, 3, \"ng-container\", 15);\n    i0.ɵɵtemplate(7, UpdateComponent_div_49_ng_container_7_Template, 8, 4, \"ng-container\", 40);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngIf\", ctx_r7.noEntityYearRange && ctx_r7.baseYear != null);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r7.emissionYear);\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    \"disabled\": a0\n  };\n};\n// /tsc-library\nexport let UpdateComponent = /*#__PURE__*/(() => {\n  class UpdateComponent {\n    constructor(router, activatedRoute, consolidationApproachService, storageUtility, dateService, updateMergerAcquisitionFB, dialog, baseYearController, ghgBaseYearController, ghgBaseYearService, toastrService, location) {\n      this.router = router;\n      this.activatedRoute = activatedRoute;\n      this.consolidationApproachService = consolidationApproachService;\n      this.storageUtility = storageUtility;\n      this.dateService = dateService;\n      this.updateMergerAcquisitionFB = updateMergerAcquisitionFB;\n      this.dialog = dialog;\n      this.baseYearController = baseYearController;\n      this.ghgBaseYearController = ghgBaseYearController;\n      this.ghgBaseYearService = ghgBaseYearService;\n      this.toastrService = toastrService;\n      this.location = location;\n      this.MaterialFormFieldAppearance = MaterialFormFieldAppearance;\n      this.ButtonLabelEnum = ButtonLabelEnum;\n      this.maxLength = 100;\n      this.structuralChangeRes = new StructuralChangeData();\n      this.currentYear = this.dateService.getCurrentYear();\n      this.minYear = 1900;\n      this.maxYear = this.currentYear - 1;\n      this.currentValueYear = this.currentYear - 1;\n      this.year = [];\n      this.emissionYear = [];\n      this.showEmissionYear = false;\n      this.baseYear = null;\n      this.ghgBaseYear = null;\n      this.sbtiBaseYear = null;\n      this.dialogDataArray = [];\n      this.emissionsForBaseYearRequired = false;\n      this.yearlyEmissionDialogData = {};\n      this.isEqual = true;\n      this.afterClosed = false;\n      this.fillEmissionYear = [];\n      this.noEntityYearRange = null;\n      this.consolidationApproachList = [];\n      this.consolidationApproachKeyIDList = [];\n      this.today = new Date();\n      this.errorHandling = (control, error) => {\n        return this.updateMergerAcquisitionFG.controls[control].hasError(error);\n      };\n    }\n    ngOnInit() {\n      this.rootOrgID = this.storageUtility.getStorage('rootOrgID');\n      this.activatedRoute.params.subscribe(param => {\n        this.recordID = param['recordID'];\n      });\n      this.activatedRoute.data.subscribe(data => {\n        this.tabType = data['tabType'];\n        if (this.tabType == StructuralChangeTabTypeEnum.MERGER_ACQUISITION) {\n          this.type = StructuralChangeTypeEnum.MERGER_ACQUISITION;\n          this.routerLink = `carbon-setting/structural-change/merger-acquisition/page`;\n        } else if (this.tabType == StructuralChangeTabTypeEnum.DIVESTMENT) {\n          this.type = StructuralChangeTypeEnum.DIVESTMENT;\n          this.routerLink = `carbon-setting/structural-change/divestment/page`;\n        }\n      });\n      this.updateMergerAcquisitionInit();\n      this.getStructuralChangeOrgByID();\n      this.populateYear();\n      this.getSbtiBaseYear();\n      this.ghgBaseYearEmission();\n      this.getAllConsolidationApproachByOrgID();\n    }\n    ngAfterViewInit() {\n      this.updateMergerAcquisitionFG.get('entityStartYear').valueChanges.subscribe(value => {\n        this.populateYearForEmissions(value);\n      });\n    }\n    ghgBaseYearEmission() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.ghgEmissionRes = yield this.ghgBaseYearService.getAllGHGEmissionsForView(this.rootOrgID);\n        this.ghgBaseYear = this.ghgEmissionRes['baseYear'];\n        this.setBaseYear();\n        this.populateYearForEmissions(this.updateMergerAcquisitionFG.get('entityStartYear').value);\n      });\n    }\n    getAllConsolidationApproachByOrgID() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.consolidationApproachList = yield this.consolidationApproachService.getAllConsolidationApproachByOrgID(this.rootOrgID);\n        this.consolidationApproachList.forEach(data => {\n          this.consolidationApproachKeyIDList.push(data.keyID);\n        });\n      });\n    }\n    getSbtiBaseYear() {\n      this.baseYearController.getBaseYearByType(this.rootOrgID, BaseYearEnum.SBTI_BASE_YEAR).subscribe(res => {\n        this.sbtiBaseYear = res.baseYear;\n      });\n    }\n    setBaseYear() {\n      if (this.ghgBaseYear && this.sbtiBaseYear) {\n        if (this.ghgBaseYear == this.sbtiBaseYear || this.ghgBaseYear > this.sbtiBaseYear) {\n          this.baseYear = this.ghgBaseYear;\n        } else {\n          this.baseYear = this.sbtiBaseYear;\n        }\n      } else if (this.ghgBaseYear) {\n        this.baseYear = this.ghgBaseYear;\n      } else {\n        this.baseYear = this.sbtiBaseYear;\n      }\n    }\n    updateMergerAcquisitionInit() {\n      this.updateMergerAcquisitionFG = this.updateMergerAcquisitionFB.group({\n        type: [this.type],\n        entityName: ['', [Validators.required]],\n        entityStartYear: ['', [Validators.required]],\n        activityTypeID: [],\n        description: [],\n        eventDate: ['', [Validators.required]],\n        structuralChangeData: [[], [Validators.required]]\n      });\n    }\n    getStructuralChangeOrgByID() {\n      this.ghgBaseYearController.getStructuralChangeOrgByID(this.rootOrgID, this.recordID, this.type).subscribe(res => {\n        if (res) {\n          this.structuralChangeRes = res;\n          this.patchStructuralChangeData();\n          this.updateMergerAcquisitionFG.valueChanges.subscribe(() => {\n            this.isEqual = isEqual(this.initialObject, this.updateMergerAcquisitionFG.getRawValue());\n          });\n        } else {\n          this.structuralChangeRes = new StructuralChangeData();\n        }\n      }, error => {\n        console.log('error in getStructuralChangeOrgByID -', error);\n        this.structuralChangeRes = new StructuralChangeData();\n      });\n    }\n    patchStructuralChangeData() {\n      this.updateMergerAcquisitionFG.patchValue({\n        entityName: this.structuralChangeRes['entityName'],\n        entityStartYear: this.structuralChangeRes['entityStartYear'],\n        description: this.structuralChangeRes['description'],\n        eventDate: this.structuralChangeRes['eventDate'],\n        structuralChangeData: this.structuralChangeRes['structuralChangeData']\n      });\n      this.structuralChangeRes['structuralChangeData'].forEach(data => {\n        this.fillEmissionYear.push(data.year);\n      });\n      this.initialObject = this.updateMergerAcquisitionFG.value;\n      this.isEqual = true;\n    }\n    formatDate(control) {\n      let date = moment(this.updateMergerAcquisitionFG.controls[control].value).format(\"YYYY-MM-DD\");\n      this.updateMergerAcquisitionFG.controls[control].patchValue(date);\n    }\n    populateYear() {\n      for (let year = this.minYear; year <= this.maxYear; year++) {\n        this.year.push(year);\n      }\n    }\n    populateYearForEmissions(entityStartYear) {\n      this.noEntityYearRange = null;\n      this.showEmissionYear = true;\n      this.emissionYear = [];\n      for (let year = entityStartYear; year <= this.maxYear; year++) {\n        if (year >= this.baseYear) {\n          this.emissionYear.push(year);\n        }\n        if (entityStartYear == this.baseYear - 1) {\n          this.noEntityYearRange = `${entityStartYear}`;\n        } else {\n          if (year < this.baseYear) {\n            this.noEntityYearRange = `${entityStartYear}   -  ${this.baseYear - 1}`;\n          }\n        }\n        if (entityStartYear == this.baseYear + 1) {\n          this.noEntityYearRange = `${this.baseYear}`;\n        }\n        if (entityStartYear > this.baseYear + 1) {\n          this.noEntityYearRange = `${this.baseYear}   -  ${entityStartYear - 1}`;\n        }\n      }\n    }\n    openGhgEmissionDialog(year, action) {\n      let dialogData;\n      if (action == 'update') {\n        const structuralChangeData = this.updateMergerAcquisitionFG.get('structuralChangeData').value;\n        dialogData = structuralChangeData.find(data => data.year == year);\n        this.action = FormAction.UPDATE;\n      } else {\n        dialogData = this.yearlyEmissionDialogData[year];\n        this.action = FormAction.CREATE;\n      }\n      this.afterClosed = false;\n      const dialog = this.dialog.open(EmissionDataDialog, {\n        data: {\n          year: year,\n          yearlyEmissionData: dialogData,\n          dialogTitle: 'GHG base year emission confirmation - ' + year,\n          consolidationApproachKeyIDList: this.consolidationApproachKeyIDList,\n          action: this.action\n        },\n        minWidth: '80vw',\n        maxWidth: '80vw',\n        height: '100%',\n        position: {\n          right: '-2px',\n          top: '0px'\n        }\n      });\n      dialog.afterClosed().subscribe(emissionRes => {\n        if (emissionRes) {\n          this.fillEmissionYear.push(year);\n          this.afterClosed = true;\n          this.structuralChangeRes = emissionRes;\n          this.yearlyEmissionDialogData[year] = emissionRes;\n          const updatedStructuralChangeData = [...this.updateMergerAcquisitionFG.get('structuralChangeData').value];\n          const index = updatedStructuralChangeData.findIndex(data => data.year == year);\n          if (index != -1) {\n            updatedStructuralChangeData[index] = emissionRes;\n          } else {\n            updatedStructuralChangeData.push(emissionRes);\n          }\n          if (year == this.baseYear) {\n            this.emissionsForBaseYearRequired = false;\n          }\n          this.updateMergerAcquisitionFG.get('structuralChangeData').patchValue(updatedStructuralChangeData);\n          this.dialogDataArray = updatedStructuralChangeData;\n        }\n      });\n    }\n    updateMergerAcquisition() {\n      if (this.isEqual) return;\n      console.log('ads', this.updateMergerAcquisitionFG);\n      let currentDataArr;\n      let prevDataArr;\n      if (this.updateMergerAcquisitionFG.get('structuralChangeData').value) {\n        prevDataArr = this.updateMergerAcquisitionFG.get('structuralChangeData').value;\n        currentDataArr = prevDataArr.filter(data => data['year'] >= this.updateMergerAcquisitionFG.get('entityStartYear').value);\n        if (currentDataArr.length == 0) {\n          this.toastrService.openToast(InvalidForm.INVALID_FORM_TITLE, InvalidForm.INVALID_FORM_MESSAGE, ToastrColor.ERROR);\n          return;\n        }\n      }\n      const emissionFormControl = this.updateMergerAcquisitionFG.get('structuralChangeData');\n      if (this.updateMergerAcquisitionFG.get('entityStartYear').value <= this.baseYear) {\n        if (emissionFormControl.value) {\n          const emissionData = emissionFormControl.value;\n          this.emissionsForBaseYearRequired = true;\n          for (let i = 0; i < emissionData.length; i++) {\n            if (emissionData[i]['year'] == this.baseYear) {\n              this.emissionsForBaseYearRequired = false;\n              break;\n            }\n          }\n        }\n        if (this.emissionsForBaseYearRequired && this.updateMergerAcquisitionFG.controls['entityStartYear'].value <= this.baseYear) {\n          this.toastrService.openToast(InvalidForm.INVALID_FORM_TITLE, InvalidForm.INVALID_FORM_MESSAGE, ToastrColor.ERROR);\n          return;\n        }\n      }\n      if (this.updateMergerAcquisitionFG.invalid) {\n        this.updateMergerAcquisitionFG.markAllAsTouched();\n        this.toastrService.openToast(InvalidForm.INVALID_FORM_TITLE, InvalidForm.INVALID_FORM_MESSAGE, ToastrColor.ERROR);\n        if (emissionFormControl) {\n          const emissionsData = emissionFormControl.value;\n          const emissionsForBaseYear = emissionsData.find(structuralChangeData => {\n            var _a, _b;\n            return structuralChangeData.year == this.baseYear && structuralChangeData.emissionRecords && ((_b = (_a = structuralChangeData.emissionRecords[0]) === null || _a === void 0 ? void 0 : _a['equityShareApproach']) === null || _b === void 0 ? void 0 : _b['emission']) == ('' || null);\n          });\n          if (emissionsForBaseYear) {\n            this.emissionsForBaseYearRequired = true;\n          }\n        }\n        return;\n      }\n      this.updateMergerAcquisitionFG.get('structuralChangeData').patchValue(currentDataArr);\n      this.ghgBaseYearController.updateStructuralChangeOrg(this.rootOrgID, this.recordID, this.updateMergerAcquisitionFG.value).subscribe(subsidiaryRes => {\n        this.router.navigate([this.routerLink]);\n      }, error => {\n        console.log('error in updateStructuralChangeOrg - ', error);\n      });\n    }\n    // Datepicker calender open/close\n    openDatepicker(datepicker) {\n      if (!datepicker.opened) {\n        datepicker.open();\n      }\n    }\n  }\n  UpdateComponent.ɵfac = function UpdateComponent_Factory(t) {\n    return new (t || UpdateComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ConsolidationApproachService), i0.ɵɵdirectiveInject(i3.StorageService), i0.ɵɵdirectiveInject(i4.DateService), i0.ɵɵdirectiveInject(i5.FormBuilder), i0.ɵɵdirectiveInject(i6.MatDialog), i0.ɵɵdirectiveInject(i7.BaseYearController), i0.ɵɵdirectiveInject(i8.GhgBaseYearController), i0.ɵɵdirectiveInject(i9.GhgBaseYearService), i0.ɵɵdirectiveInject(i10.ToastrService), i0.ɵɵdirectiveInject(i11.Location));\n  };\n  UpdateComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UpdateComponent,\n    selectors: [[\"app-update\"]],\n    features: [i0.ɵɵProvidersFeature(date_format_providers)],\n    decls: 57,\n    vars: 24,\n    consts: [[\"xmlns\", \"http://www.w3.org/2000/svg\", 1, \"d-none\"], [\"id\", \"exclamation-triangle-fill\", \"fill\", \"#fd7e14\", \"viewBox\", \"0 0 16 16\"], [\"d\", \"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z\"], [1, \"card\", \"main-card\", \"cardOverwrite\", \"h100\"], [1, \"headerContainer\"], [1, \"headerLeftContainer\"], [1, \"pageTitle\"], [1, \"card-body\"], [1, \"row\"], [1, \"col-sm-12\"], [3, \"formGroup\"], [1, \"col-sm-6\"], [1, \"matFieldWidth100\", 3, \"appearance\"], [1, \"formLabel\"], [\"matInput\", \"\", \"placeholder\", \"Business entity name\", \"type\", \"text\", \"formControlName\", \"entityName\"], [4, \"ngIf\"], [\"formControlName\", \"entityStartYear\"], [\"disabled\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"matInput\", \"\", \"formControlName\", \"description\", 1, \"formPlaceholder\", 3, \"maxlength\"], [\"input\", \"\"], [1, \"matFieldWidth100\", 3, \"appearance\", \"click\", \"keydown.enter\", \"keydown.arrowdown\"], [\"matInput\", \"\", \"formControlName\", \"eventDate\", 1, \"noFocus\", 3, \"matDatepicker\", \"max\", \"dateInput\"], [\"matSuffix\", \"\", 3, \"for\"], [\"disabled\", \"false\"], [\"date\", \"\"], [\"class\", \"row\", 4, \"ngIf\"], [1, \"row\", \"pt-4\"], [1, \"float-end\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", \"me-2\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-success\", 3, \"ngClass\", \"click\"], [3, \"value\"], [1, \"extraInfoCard\", \"mb-4\"], [1, \"alert\", \"alert-warning\", \"m-0\", \"roundedBorder\", \"warningCardWidth\"], [1, \"d-flex\", \"align-items-center\"], [1, \"bi\", \"flex-shrink-0\", \"me-3\", \"extraInfoCardHeaderIcon\"], [0, \"xlink\", \"href\", \"#exclamation-triangle-fill\"], [1, \"mt-2\"], [1, \"card-title\"], [1, \"cardTitle\"], [4, \"ngFor\", \"ngForOf\"], [1, \"col-sm-2\"], [\"fill\", \"#fd7e14\", \"viewBox\", \"0 0 16 16\", 1, \"exclamation-triangle-fill\", \"flex-shrink-0\", \"fs-5\", \"dialogHeaderIcon\", \"verifiedIcon\", \"me-2\"], [1, \"row\", \"mt-4\"], [\"class\", \"col-sm-4\", 4, \"ngIf\"], [\"class\", \"col-sm-6 text-danger\", 4, \"ngIf\"], [1, \"col-sm-4\"], [\"class\", \"btn btn-link btn-sm\", \"type\", \"button\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"btn\", \"btn-link\", \"btn-sm\", 3, \"click\"], [1, \"col-sm-6\", \"text-danger\"]],\n    template: function UpdateComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r26 = i0.ɵɵgetCurrentView();\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(0, \"svg\", 0);\n        i0.ɵɵelementStart(1, \"symbol\", 1);\n        i0.ɵɵelement(2, \"path\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵelementStart(6, \"div\", 6);\n        i0.ɵɵtext(7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 7);\n        i0.ɵɵelementStart(9, \"div\", 8);\n        i0.ɵɵelementStart(10, \"div\", 9);\n        i0.ɵɵelementStart(11, \"form\", 10);\n        i0.ɵɵelementStart(12, \"div\", 8);\n        i0.ɵɵelementStart(13, \"div\", 11);\n        i0.ɵɵelementStart(14, \"mat-form-field\", 12);\n        i0.ɵɵelementStart(15, \"mat-label\", 13);\n        i0.ɵɵtext(16, \"Business entity name\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(17, \"input\", 14);\n        i0.ɵɵtemplate(18, UpdateComponent_mat_error_18_Template, 2, 0, \"mat-error\", 15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"div\", 8);\n        i0.ɵɵelementStart(20, \"div\", 11);\n        i0.ɵɵelementStart(21, \"mat-form-field\", 12);\n        i0.ɵɵelementStart(22, \"mat-label\");\n        i0.ɵɵtext(23, \"Business entity start year\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"mat-select\", 16);\n        i0.ɵɵelementStart(25, \"mat-option\", 17);\n        i0.ɵɵtext(26, \"Select Business start year\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(27, UpdateComponent_mat_option_27_Template, 2, 2, \"mat-option\", 18);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(28, UpdateComponent_mat_error_28_Template, 2, 0, \"mat-error\", 15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"div\", 8);\n        i0.ɵɵelementStart(30, \"div\", 11);\n        i0.ɵɵelementStart(31, \"mat-form-field\", 12);\n        i0.ɵɵelementStart(32, \"mat-label\", 13);\n        i0.ɵɵtext(33);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(34, \"input\", 19, 20);\n        i0.ɵɵelementStart(36, \"mat-hint\");\n        i0.ɵɵtext(37);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"div\", 8);\n        i0.ɵɵelementStart(39, \"div\", 11);\n        i0.ɵɵelementStart(40, \"mat-form-field\", 21);\n        i0.ɵɵlistener(\"click\", function UpdateComponent_Template_mat_form_field_click_40_listener() {\n          i0.ɵɵrestoreView(_r26);\n          const _r4 = i0.ɵɵreference(46);\n          return ctx.openDatepicker(_r4);\n        })(\"keydown.enter\", function UpdateComponent_Template_mat_form_field_keydown_enter_40_listener() {\n          i0.ɵɵrestoreView(_r26);\n          const _r4 = i0.ɵɵreference(46);\n          return ctx.openDatepicker(_r4);\n        })(\"keydown.arrowdown\", function UpdateComponent_Template_mat_form_field_keydown_arrowdown_40_listener() {\n          i0.ɵɵrestoreView(_r26);\n          const _r4 = i0.ɵɵreference(46);\n          return ctx.openDatepicker(_r4);\n        });\n        i0.ɵɵelementStart(41, \"mat-label\", 13);\n        i0.ɵɵtext(42, \"Merger / Acquisition date \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(43, \"input\", 22);\n        i0.ɵɵlistener(\"dateInput\", function UpdateComponent_Template_input_dateInput_43_listener() {\n          return ctx.formatDate(\"eventDate\");\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(44, \"mat-datepicker-toggle\", 23);\n        i0.ɵɵelement(45, \"mat-datepicker\", 24, 25);\n        i0.ɵɵtemplate(47, UpdateComponent_mat_error_47_Template, 2, 0, \"mat-error\", 15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(48, UpdateComponent_ng_container_48_Template, 8, 0, \"ng-container\", 15);\n        i0.ɵɵtemplate(49, UpdateComponent_div_49_Template, 8, 2, \"div\", 26);\n        i0.ɵɵelementStart(50, \"div\", 27);\n        i0.ɵɵelementStart(51, \"div\", 9);\n        i0.ɵɵelementStart(52, \"div\", 28);\n        i0.ɵɵelementStart(53, \"button\", 29);\n        i0.ɵɵlistener(\"click\", function UpdateComponent_Template_button_click_53_listener() {\n          return ctx.location.back();\n        });\n        i0.ɵɵtext(54);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(55, \"button\", 30);\n        i0.ɵɵlistener(\"click\", function UpdateComponent_Template_button_click_55_listener() {\n          return ctx.updateMergerAcquisition();\n        });\n        i0.ɵɵtext(56);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        const _r3 = i0.ɵɵreference(35);\n        const _r4 = i0.ɵɵreference(46);\n        i0.ɵɵadvance(7);\n        i0.ɵɵtextInterpolate1(\"Update \", ctx.tabType, \" Record\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"formGroup\", ctx.updateMergerAcquisitionFG);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"appearance\", ctx.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.errorHandling(\"entityName\", \"required\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"appearance\", ctx.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngForOf\", ctx.year);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.errorHandling(\"entityStartYear\", \"required\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"appearance\", ctx.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"\", ctx.tabType, \" description\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"maxlength\", ctx.maxLength);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate2(\"Total number of character remaining: \", _r3.value.length, \" /\", ctx.maxLength, \"\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"appearance\", ctx.MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"matDatepicker\", _r4)(\"max\", ctx.today);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"for\", _r4);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.errorHandling(\"eventDate\", \"required\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.updateMergerAcquisitionFG.controls[\"entityStartYear\"].value > ctx.baseYear);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showEmissionYear);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate1(\" \", ctx.ButtonLabelEnum.CANCEL_BTN_LABEL, \" \");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(22, _c0, ctx.isEqual));\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \", ctx.ButtonLabelEnum.UPDATE_BTN_LABEL, \" \");\n      }\n    },\n    directives: [i5.ɵNgNoValidate, i5.NgControlStatusGroup, i5.FormGroupDirective, i12.MatFormField, i12.MatLabel, i13.MatInput, i5.DefaultValueAccessor, i5.NgControlStatus, i5.FormControlName, i11.NgIf, i14.MatSelect, i15.MatOption, i11.NgForOf, i5.MaxLengthValidator, i12.MatHint, i16.MatDatepickerInput, i16.MatDatepickerToggle, i12.MatSuffix, i16.MatDatepicker, i11.NgClass, i12.MatError],\n    encapsulation: 2\n  });\n  return UpdateComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}