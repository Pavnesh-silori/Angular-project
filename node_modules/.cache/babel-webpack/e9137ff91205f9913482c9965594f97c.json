{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { ActivityKeyIDEnum } from '@carbon/enum/activity.enum';\n// tsc-library\nimport { COMMON_CONSTANT } from '@library/tsc-common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@carbon/service/activity-data.service\";\nimport * as i2 from \"@carbon/controller/timeline.controller\";\nimport * as i3 from \"@carbon/controller/gwp-dataset.controller\";\nimport * as i4 from \"@angular/material/dialog\";\nimport * as i5 from \"@angular/material/button\";\nimport * as i6 from \"@angular/material/tooltip\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"./view/view.component\";\nfunction ActivityChangeDialog_ng_container_7_ng_container_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\nfunction ActivityChangeDialog_ng_container_7_ng_container_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\nconst _c0 = function (a1, a2) {\n  return {\n    title: \"Previous emissions\",\n    value: a1,\n    unit: a2\n  };\n};\nconst _c1 = function (a1, a2) {\n  return {\n    title: \"Current emissions\",\n    value: a1,\n    unit: a2\n  };\n};\nfunction ActivityChangeDialog_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 9);\n    i0.ɵɵelementStart(2, \"div\", 10);\n    i0.ɵɵelement(3, \"record-view\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 12);\n    i0.ɵɵelement(5, \"record-view\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 13);\n    i0.ɵɵelementStart(7, \"div\", 14);\n    i0.ɵɵelementStart(8, \"div\", 15);\n    i0.ɵɵtext(9, \" Emissions \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 9);\n    i0.ɵɵelementStart(11, \"div\", 16);\n    i0.ɵɵtemplate(12, ActivityChangeDialog_ng_container_7_ng_container_12_Template, 1, 0, \"ng-container\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 16);\n    i0.ɵɵtemplate(14, ActivityChangeDialog_ng_container_7_ng_container_14_Template, 1, 0, \"ng-container\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    const _r3 = i0.ɵɵreference(11);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"gwpResponse\", ctx_r0.gwpResponse)(\"recordType\", \"previousData\")(\"isUpdate\", ctx_r0.isUpdate)(\"cedID\", ctx_r0.cedID)(\"view\", false)(\"sentData\", ctx_r0.activityData)(\"up_diff\", ctx_r0.up_diff)(\"down_diff\", ctx_r0.down_diff)(\"activityKeyID\", ctx_r0.activityKeyID)(\"diff\", ctx_r0.diff);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"gwpResponse\", ctx_r0.gwpResponse)(\"recordType\", \"currentData\")(\"isUpdate\", ctx_r0.isUpdate)(\"cedID\", ctx_r0.cedID)(\"view\", ctx_r0.showRedirectToView)(\"sentData\", ctx_r0.currentData)(\"up_diff\", ctx_r0.up_diff)(\"down_diff\", ctx_r0.down_diff)(\"activityKeyID\", ctx_r0.activityKeyID)(\"diff\", ctx_r0.diff);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", _r3)(\"ngTemplateOutletContext\", i0.ɵɵpureFunction2(24, _c0, ctx_r0.emission == null ? null : ctx_r0.emission[\"first\"] == null ? null : ctx_r0.emission[\"first\"][\"co2e\"], ctx_r0.emission == null ? null : ctx_r0.emission[\"first\"] == null ? null : ctx_r0.emission[\"first\"][\"co2eUomCode\"]));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", _r3)(\"ngTemplateOutletContext\", i0.ɵɵpureFunction2(27, _c1, ctx_r0.emission == null ? null : ctx_r0.emission[\"second\"] == null ? null : ctx_r0.emission[\"second\"][\"co2e\"], ctx_r0.emission == null ? null : ctx_r0.emission[\"second\"] == null ? null : ctx_r0.emission[\"second\"][\"co2eUomCode\"]));\n  }\n}\nfunction ActivityChangeDialog_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵelementStart(1, \"div\", 18);\n    i0.ɵɵelement(2, \"record-view\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"gwpResponse\", ctx_r2.gwpResponse)(\"isUpdate\", ctx_r2.isUpdate)(\"cedID\", ctx_r2.cedID)(\"view\", ctx_r2.showRedirectToView)(\"sentData\", ctx_r2.recordData)(\"activityKeyID\", ctx_r2.activityKeyID);\n  }\n}\nfunction ActivityChangeDialog_ng_template_10_ng_container_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"span\", 23);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r13 = i0.ɵɵnextContext();\n    const value_r10 = ctx_r13.value;\n    const unit_r11 = ctx_r13.unit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"matTooltip\", value_r10 + \" \" + unit_r11);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(3, 2, value_r10, \"1.2-2\") + \" \" + unit_r11, \" \");\n  }\n}\nfunction ActivityChangeDialog_ng_template_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵelementStart(1, \"div\", 20);\n    i0.ɵɵelementStart(2, \"div\", 21);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 22);\n    i0.ɵɵtemplate(5, ActivityChangeDialog_ng_template_10_ng_container_5_Template, 4, 5, \"ng-container\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const title_r9 = ctx.title;\n    const value_r10 = ctx.value;\n    const ctx_r4 = i0.ɵɵnextContext();\n    const _r5 = i0.ɵɵreference(13);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", title_r9, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.haveValue(value_r10))(\"ngIfElse\", _r5);\n  }\n}\nfunction ActivityChangeDialog_ng_template_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r6.COMMON_CONSTANT.HYPHEN, \" \");\n  }\n}\n// tsc-library\nexport let ActivityChangeDialog = /*#__PURE__*/(() => {\n  class ActivityChangeDialog {\n    constructor(data, activityDataService, timelineController, gwpdatasetController) {\n      this.data = data;\n      this.activityDataService = activityDataService;\n      this.timelineController = timelineController;\n      this.gwpdatasetController = gwpdatasetController;\n      this.COMMON_CONSTANT = COMMON_CONSTANT;\n      this.activityName = 'Activity';\n      this.showRedirectToView = false;\n      this.diff = [];\n      this.up_diff = [];\n      this.down_diff = [];\n      this.isUpdate = data['isUpdate'];\n      this.rootOrgID = data['rootOrgID'];\n      this.cedID = data['cedID'];\n      this.baseYearKeyID = data['baseYearKeyID'];\n      this.activityKeyID = data['activityKeyID'];\n      this.activityDataID = data['activityDataID'];\n      this.showRedirectToView = data['showRedirectToView'];\n    }\n    ngOnInit() {\n      this.isUpdate ? this.getActivityDiff() : this.getActivityDataByID();\n    }\n    haveValue(value) {\n      if (value != null && value >= 0) return true;\n      return false;\n    }\n    getActivityDataByID() {\n      return __awaiter(this, void 0, void 0, function* () {\n        let dataID = this.activityDataID;\n        if (this.activityKeyID == ActivityKeyIDEnum.REFRIGERATION_AC_AND_FIRE_SUPPRESSION) {\n          this.getGwpDataSet();\n          this.recordData = yield this.activityDataService.getFugitiveRefrigerationActivityDataByCedID(this.rootOrgID, this.activityKeyID, this.cedID);\n        } else {\n          this.recordData = yield this.activityDataService.getActivityDataByID(this.rootOrgID, dataID, this.activityKeyID);\n          this.activityData = this.recordData['activityData'];\n          this.activityName = this.activityData['activityName'];\n        }\n      });\n    }\n    getGwpDataSet() {\n      try {\n        this.gwpdatasetController.getGwpDataSet(this.rootOrgID, this.cedID).subscribe(response => {\n          this.gwpResponse = response;\n        });\n      } catch (error) {\n        console.error(\"error in getGwpData: \", error);\n      }\n    }\n    getActivityDiff() {\n      let dataID = this.activityDataID;\n      if (this.activityKeyID == ActivityKeyIDEnum.REFRIGERATION_AC_AND_FIRE_SUPPRESSION) dataID = this.cedID;\n      this.timelineController.getActivityDiff(this.rootOrgID, this.baseYearKeyID, this.activityKeyID, dataID).subscribe(res => {\n        if (this.activityKeyID == ActivityKeyIDEnum.REFRIGERATION_AC_AND_FIRE_SUPPRESSION) {\n          this.recordData = res['value']['second'];\n          console.log('this.activityData  - ', this.activityData);\n        } else {\n          this.activityData = res['value']['first'];\n          this.currentData = res['value']['second'];\n          this.activityName = this.activityData['activityData']['activityName'];\n          this.emission = res['emission'];\n        }\n        // this.getDiff();\n      });\n    }\n\n    getDiff() {\n      let prev = this.activityData['activityData'];\n      let current = this.currentData['activityData'];\n      for (let key of Object.keys(prev)) {\n        if (prev[key] != current[key]) {\n          console.log(key, prev[key], current[key]);\n          this.diff.push(key);\n        }\n        if (typeof prev[key] == 'number') {\n          if (prev[key] < current[key]) {\n            this.up_diff.push(key);\n          } else {\n            this.down_diff.push(key);\n          }\n        }\n      }\n    }\n  }\n  ActivityChangeDialog.ɵfac = function ActivityChangeDialog_Factory(t) {\n    return new (t || ActivityChangeDialog)(i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i1.ActivityDataService), i0.ɵɵdirectiveInject(i2.TimelineController), i0.ɵɵdirectiveInject(i3.GwpdatasetController));\n  };\n  ActivityChangeDialog.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ActivityChangeDialog,\n    selectors: [[\"app-activity-change\"]],\n    decls: 14,\n    vars: 4,\n    consts: [[\"mat-dialog-title\", \"\"], [1, \"dialogTitle\"], [\"mat-icon-button\", \"\", \"mat-dialog-close\", \"\", \"cdkFocusInitial\", \"\", \"matTooltip\", \"Close\", \"matTooltipPosition\", \"before\", 1, \"float-end\", \"matDialogClose\"], [1, \"material-symbols-outlined\"], [\"mat-dialog-content\", \"\", 1, \"matDialogContent\"], [4, \"ngIf\", \"ngIfElse\"], [\"create\", \"\"], [\"valueAndUnit\", \"\"], [\"hyphen\", \"\"], [1, \"row\"], [1, \"col-sm-6\", \"cardOverwrite\", \"pe-1\"], [3, \"gwpResponse\", \"recordType\", \"isUpdate\", \"cedID\", \"view\", \"sentData\", \"up_diff\", \"down_diff\", \"activityKeyID\", \"diff\"], [1, \"col-sm-6\", \"cardOverwrite\"], [1, \"row\", \"mt-2\", \"mx-0\"], [1, \"cardOverwrite\", \"bg-light\", \"p-3\"], [1, \"cardTitle\", \"ps-1\"], [1, \"col-sm-6\"], [4, \"ngTemplateOutlet\", \"ngTemplateOutletContext\"], [1, \"col-sm-12\", \"cardOverwrite\"], [\"recordType\", \"newData\", 3, \"gwpResponse\", \"isUpdate\", \"cedID\", \"view\", \"sentData\", \"activityKeyID\"], [1, \"d-flex\", \"justify-content-between\"], [1, \"col-form-label\", \"ms-1\"], [1, \"col-form-value\", \"fw-bold\", \"centerAlign\"], [\"matTooltipPosition\", \"above\", \"matTooltipClass\", \"infoTooltip\", 3, \"matTooltip\"], [1, \"ms-5\", \"fw-bold\"]],\n    template: function ActivityChangeDialog_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"strong\", 1);\n        i0.ɵɵtext(2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"button\", 2);\n        i0.ɵɵelementStart(4, \"span\", 3);\n        i0.ɵɵtext(5, \"close\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 4);\n        i0.ɵɵtemplate(7, ActivityChangeDialog_ng_container_7_Template, 15, 30, \"ng-container\", 5);\n        i0.ɵɵtemplate(8, ActivityChangeDialog_ng_template_8_Template, 3, 6, \"ng-template\", null, 6, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(10, ActivityChangeDialog_ng_template_10_Template, 6, 3, \"ng-template\", null, 7, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(12, ActivityChangeDialog_ng_template_12_Template, 2, 1, \"ng-template\", null, 8, i0.ɵɵtemplateRefExtractor);\n      }\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(9);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate2(\" \", ctx.activityName, \" Record \", ctx.isUpdate ? \"Updated\" : \"Created\", \" \");\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.isUpdate)(\"ngIfElse\", _r1);\n      }\n    },\n    directives: [i4.MatDialogTitle, i5.MatButton, i4.MatDialogClose, i6.MatTooltip, i4.MatDialogContent, i7.NgIf, i8.ViewComponent, i7.NgTemplateOutlet],\n    pipes: [i7.DecimalPipe],\n    styles: [\"\"]\n  });\n  return ActivityChangeDialog;\n})();","map":null,"metadata":{},"sourceType":"module"}