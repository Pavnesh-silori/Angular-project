<div class="card main-card cardOverwrite h100">
    <div class="headerContainer">
        <div class="headerLeftContainer">
            <div class="pageTitle">{{ alertLabel }} Alert</div>
        </div>
        <div class="headerRightContainer">
            <div class="headerRightContainerInner">
                <lib-search-bar-one class="me-3" #searchBar searchBy="name" (emitSearch)="searchFn($event)">
                </lib-search-bar-one>
                <a class="btn btn-sm btn-success btnBase" matRipple
                    [matRippleCentered]="MATERIAL_CONSTANT.MAT_RIPPLE_CENTER" [routerLink]="[baseUrl, 'create']">
                    <fa-icon [icon]="faPlus"></fa-icon>&nbsp; {{ alertLabel }} Alert
                </a>
            </div>
        </div>
    </div>

    <button #refreshBtn class="d-none"></button>

    <div class="overflowX customScrollBar">
        <table class="w-100" mat-table [dataSource]="dataSource" #sort="matSort" matSort matSortActive="id"
            matSortDirection="asc" matSortDisableClear>

            <ng-container matColumnDef="id">
                <th class="px-3 columnWidth1" mat-header-cell *matHeaderCellDef mat-sort-header disableClear>
                    ID
                </th>
                <td class="px-3 columnWidth1" mat-cell *matCellDef="let row">
                    {{ row['id'] ? row['id']: COMMON_CONSTANT.HYPHEN }}
                </td>
            </ng-container>

            <ng-container matColumnDef="name">
                <th class="px-3 columnWidth2" mat-header-cell *matHeaderCellDef> Name </th>
                <td class="px-3 columnWidth2" mat-cell *matCellDef="let row" [matTooltip]="row?.['name']?.length>20? row['name']: ''"
                    matTooltipPosition="above" matTooltipClass="nameTooltip">
                    {{ (row['name'] ? row['name']: COMMON_CONSTANT.HYPHEN) | dotdotdot:20}}
                </td>
            </ng-container>

            <ng-container matColumnDef="associatedWith">
                <th class="px-3 columnWidth3" mat-header-cell *matHeaderCellDef> Associated with </th>
                <td class="px-3 columnWidth3" mat-cell *matCellDef="let row"
                    [matTooltip]="row?.['associatedWith']?.length>25? row['associatedWith']: ''"
                    matTooltipPosition="above" matTooltipClass="nameTooltip">
                    {{ (row['associatedWith'] ? row['associatedWith']: COMMON_CONSTANT.HYPHEN) | dotdotdot:25}}
                </td>
            </ng-container>

            <ng-container matColumnDef="ruleDescription">
                <th class="px-3 columnWidth3" mat-header-cell *matHeaderCellDef> Rule </th>
                <td class="px-3 columnWidth3" mat-cell *matCellDef="let row"
                    [matTooltip]="row?.['ruleDescription']?.length>25? row['ruleDescription']: ''"
                    matTooltipPosition="above" matTooltipClass="nameTooltip">
                    {{ (row['ruleDescription'] ? row['ruleDescription']: COMMON_CONSTANT.HYPHEN) | dotdotdot:25}}
                </td>
            </ng-container>

            <ng-container matColumnDef="status">
                <th class="px-3 columnWidth1" mat-header-cell *matHeaderCellDef> Status </th>
                <td class="px-3 columnWidth1" mat-cell *matCellDef="let row">
                    <mat-slide-toggle [formControl]="getAlertStatusFC(row.id)" (change)="alertStatusChange(row.id)"></mat-slide-toggle>
                </td>
            </ng-container>

            <ng-container matColumnDef="action">
                <th class="columnWidth1" mat-header-cell *matHeaderCellDef></th>
                <td class="columnWidth1" mat-cell *matCellDef="let row">
                    <div class="d-flex align-items-center">
                        <div class="btn-group" ngbDropdown placement="left">
                            <button type="button" ngbDropdownToggle class="dropdown-after dropdownAfter btn">
                                <fa-icon [icon]="faEllipsisV"></fa-icon>
                            </button>
                            <div ngbDropdownMenu>
                                <button class="dropdown-item" [routerLink]="[baseUrl, row['id'], 'update']">
                                    {{ ButtonLabelEnum.UPDATE_BTN_LABEL }}
                                </button>
                                <button class="dropdown-item" [routerLink]="[baseUrl + '/' + row['id'] + '/escalation']" *ngIf="escalationPermissionM">
                                    Escalation rule
                                </button>
                                <button class="btn btn-outline-danger rounded-0 dropdown-item" (click)="openDeleteAlertDialog(row.id, row.name)">
                                    {{ ButtonLabelEnum.DELETE_BTN_LABEL }}
                                </button>
                            </div>
                        </div>
                    </div>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumn"></tr>
            <tr mat-row *matRowDef="let task; columns: displayedColumn;"></tr>

            <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell text-center" [attr.colspan]="displayedColumn.length">
                    {{ TABLE_CONSTANT.TABLE_NO_DATA }}
                </td>
            </tr>
        </table>
    </div>
    <mat-paginator #paginator class="roundedBorder" showFirstLastButtons [length]="resultLength"
        [pageSize]="TABLE_CONSTANT.DEFAULT_PAGE_SIZE" [pageSizeOptions]="TABLE_CONSTANT.PAGE_SIZE_OPTION">
    </mat-paginator>
</div>