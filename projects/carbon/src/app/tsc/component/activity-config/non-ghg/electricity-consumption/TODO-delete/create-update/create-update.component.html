<mat-card class="cardOverwrite border">
    <div class="cardTitle pb-2"> Details </div>
    <form [formGroup]="activityConfigFG">
        <div formGroupName="activityConfig" class="row">
            <div class="col-sm-6">
                <mat-form-field class="matFieldWidth100"
                    [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                    <mat-label class="formLabel">Activity form name</mat-label>
                    <input formControlName="configName" type="text" matInput required>
                    <mat-error *ngIf="errorHandling('activityConfig.configName', 'required')">
                        {{ formErrorEnum.REQUIRED }}
                    </mat-error>
                </mat-form-field>
            </div>
        </div>
        <div formGroupName="activityConfigData">
            <div class="row">
                <div class="col-sm-6">
                    <mat-form-field class="matFieldWidth100"
                        [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                        <mat-label class="formLabel">Select process</mat-label>
                        <mat-select formControlName="processID" required
                            (selectionChange)="getProcessByID(currentOrgID, $event.value)">
                            <mat-option>
                                <ngx-mat-select-search [formControl]="processSearchUtil.filterFC"
                                    placeholderLabel="search by name" noEntriesFoundLabel="No matching name found">
                                </ngx-mat-select-search>
                            </mat-option>
                            <mat-option *ngFor="let process of processSearchUtil.filteredEntities | async"
                                [value]="process.id">
                                <span class="d-flex justify-content-between">
                                    {{ process.name }}
                                </span>
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="errorHandling('activityConfigData.processID', 'required')">
                            {{ formErrorEnum.REQUIRED }}
                        </mat-error>
                    </mat-form-field>
                </div>
            </div>
            <!-- <div class="row">
                <div class="col-sm-6">
                    <mat-form-field class="matFieldWidth100"
                        [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                        <mat-label class="formLabel">Select electricity source</mat-label>
                        <mat-select formControlName="inputOutputSourceID" required multiple>
                            <mat-option *ngFor="let source of heatSources" [value]="source.id">
                                <span class="d-flex justify-content-between">
                                    {{ source.description }}
                                </span>
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="errorHandling('activityConfigData.inputOutputSourceID', 'required')">
                            {{ formErrorEnum.REQUIRED }}
                        </mat-error>
                    </mat-form-field>
                </div>
                <div class="col-sm-2">
                    <mat-icon matTooltip="Select multiple electricity sources in case of a common sub-meter at the process"
                        matTooltipPosition="above">
                        <span class="material-symbols-outlined info-button cursorPointer">info</span>
                    </mat-icon>
                </div>
            </div> -->

            <div class="row mb-2">
                <div class="col-sm-4">
                    Electricity Source
                </div>
                <div class="col-sm-8 fw-bold">
                    <div *ngIf="electricitySource.length == 0">--</div>
                    <div *ngFor="let name of electricitySource">
                        <li>{{ name ? name : COMMON_CONSTANT.HYPHEN }}</li>
                    </div>
                </div>
            </div>
        </div>

        <div formArrayName="activityConfigSource" class="row pt-2">
            <div *ngFor="let group of activityConfigSourceFA.controls; let i = index" class="col-sm-6">
                <div [formGroupName]="i">
                    <div *ngIf="isGridSupplier">
                        <mat-form-field class="matFieldWidth100"
                            [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                            <mat-label class="formLabel">Select grid electricity supplier</mat-label>
                            <mat-select formControlName="gridSupplierControl" required>
                                <mat-option *ngFor="let supplier of gridSuppliers" [value]="supplier.supplierID"
                                    (click)="setSourceTypeID(supplier)">
                                    <span class="d-flex justify-content-between">{{ supplier.supplierName }}</span>
                                </mat-option>
                            </mat-select>
                            <!-- <mat-error *ngIf="errorHandlingForFormArrayData('gridSupplier', 'required', i)">
                                {{ formErrorEnum.REQUIRED }}
                            </mat-error> -->
                        </mat-form-field>
                    </div>
                    <div *ngIf="isPrivateSupplier">
                        <mat-form-field class="matFieldWidth100"
                            [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                            <mat-label class="formLabel">Select private electricity supplier</mat-label>
                            <mat-select formControlName="privateSupplierControl" required>
                                <mat-option *ngFor="let supplier of privateSuppliers" [value]="supplier.supplierID"
                                    (click)="setSourceTypeID(supplier)">
                                    <span class="d-flex justify-content-between">{{ supplier.supplierName }}</span>
                                </mat-option>
                            </mat-select>
                            <!-- <mat-error *ngIf="errorHandlingForFormArrayData('privateSupplier', 'required', i)">
                                {{ formErrorEnum.REQUIRED }}
                            </mat-error> -->
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>

        <div formGroupName="activityConfigData">
            <div class="row">
                <mat-label class="formLabel mb-2"> Enter data using*</mat-label>
                <mat-radio-group formControlName="dataInputMethodStdID">
                    <mat-radio-button class="col-sm-3" *ngFor="let input of dataInputMethodList" [value]="input.id"
                        (change)="alterValidatorsForDataInput(input.keyID)">
                        {{ input.name }}
                    </mat-radio-button>
                    <mat-error class="ms-2 mt-2"
                        *ngIf="radioError('activityConfigData.dataInputMethodStdID', 'required')">
                        {{ formErrorEnum.REQUIRED }}
                    </mat-error>
                </mat-radio-group>
            </div>

            <div *ngIf="isMeterReading">
                <div class="row mt-3">
                    <div class="col-sm-3">
                        <mat-form-field class="matFieldWidth100"
                            [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                            <mat-label class="formLabel">Meter rollover value</mat-label>
                            <input class="formPlaceholder" matInput min="0" type="number"
                                placeholder="Meter rollover value" formControlName="meterRolloverValue" />
                            <mat-error *ngIf="errorHandling('activityConfigData.meterRolloverValue', 'min')">
                                Meter reading can't be negative.
                            </mat-error>
                            <mat-error *ngIf="errorHandling('activityConfigData.meterRolloverValue', 'required')">
                                {{ formErrorEnum.REQUIRED }}
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-sm-3">
                        <mat-form-field class="matFieldWidth100"
                            [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                            <mat-label class="formLabel">Meter unit</mat-label>
                            <mat-select formControlName="meterRolloverUnitID">
                                <mat-option *ngFor="let unit of distanceUnit" [value]="unit.id">
                                    {{ unit.name }}
                                </mat-option>
                            </mat-select>
                            <mat-error *ngIf="errorHandling('activityConfigData.meterRolloverUnitID', 'required')">
                                {{ formErrorEnum.REQUIRED }}
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>
    </form>
</mat-card>