<mat-card class="cardOverwrite border">
    <div class="py-2">
        <div class="cardTitle">Details</div>
    </div>

    <form [formGroup]="activityConfigFG">
        <ng-container *ngIf="origin == ActivityConfigEnum.PFF">
            <ng-container formGroupName="activityConfig">
                <div class="row">
                    <div class="col-sm-8">
                        <mat-form-field class="matFieldWidth100"
                            [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                            <mat-label class="formLabel">Activity form name</mat-label>
                            <input placeholder="Activity form name" matInput formControlName="configName" type="text"
                                required>
                            <mat-error *ngIf="errorHandling('activityConfig.configName', 'required')">
                                {{ FormErrorEnum.REQUIRED }}
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </ng-container>
        </ng-container>

        <ng-container formGroupName="activityConfigData">
            <div class="row">
                <div class="col-sm-8">
                    <mat-form-field class="matFieldWidth100"
                        [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                        <mat-label class="formLabel">Select Process</mat-label>
                        <mat-select formControlName="processRecordID" required
                            (selectionChange)="setProcessIDAndGetProcess($event.value)">
                            <mat-option>
                                <ngx-mat-select-search [formControl]="processSearch.filterFC"
                                    placeholderLabel="Search by name" noEntriesFoundLabel="No matching name found.">
                                </ngx-mat-select-search>
                            </mat-option>
                            <mat-option *ngFor="let process of processSearch.filteredEntities | async"
                                [value]="process.recordID">
                                {{ process.name }}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="errorHandling('activityConfigData.processID', 'required')">
                            {{ FormErrorEnum.REQUIRED }}
                        </mat-error>
                    </mat-form-field>
                </div>
            </div>

            <div class="row mb-3">
                <mat-label class="formLabel ms-2 pb-2"> Enter fuel consumption data using</mat-label>
                <div class="col-sm-8">
                    <mat-radio-group class="row" formControlName="dataInputMethodStdID">
                        <span class="col-sm-6 ps-3" *ngFor="let input of dataInputMethodList">
                            <mat-radio-button class="col-sm-3" [value]="input.id"
                                (change)="inputMethodChange(input.keyID)">
                                {{ input.name }}
                            </mat-radio-button>
                        </span>
                        <mat-error class="radioGroupError"
                            *ngIf="errorHandlingRadio('activityConfigData.dataInputMethodStdID', 'required')">
                            {{ FormErrorEnum.REQUIRED }}
                        </mat-error>
                    </mat-radio-group>
                </div>
            </div>

            <ng-container *ngIf="inputMethod == DataInputMethodKeyIDEnum.METER_READING">
                <div class="row">
                    <div class="col-sm-8">
                        <div class="row">
                            <div class="col-sm-6">
                                <mat-form-field class="matFieldWidth100"
                                    [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                                    <mat-label class="formLabel">Meter rollover value</mat-label>
                                    <input class="formPlaceholder" matInput min="0" type="number" matInput type="number"
                                        formControlName="meterRolloverValue" />
                                    <mat-error *ngIf="errorHandling('activityConfigData.meterRolloverValue', 'min')">
                                        {{ FormErrorEnum.NEGATIVE }}
                                    </mat-error>
                                    <mat-error
                                        *ngIf="errorHandling('activityConfigData.meterRolloverValue', 'required')">
                                        {{ FormErrorEnum.REQUIRED }}
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-6">
                                <mat-form-field class="matFieldWidth100"
                                    [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                                    <mat-label class="formLabel">Select Unit</mat-label>
                                    <mat-select formControlName="meterRolloverUnitID">
                                        <mat-option *ngFor="let unit of distanceUnit" [value]="unit.id">
                                            {{ unit.name }}
                                        </mat-option>
                                    </mat-select>
                                    <mat-error
                                        *ngIf="errorHandling('activityConfigData.meterRolloverUnitID', 'required')">
                                        {{ FormErrorEnum.REQUIRED }}
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                </div>
            </ng-container>
        </ng-container>

        <ng-container formArrayName="activityConfigSource">
            <ng-container *ngFor="let formGroup of activityConfigSourceFA.controls; let i = index">
                <div class="row">
                    <ng-container [formGroupName]="i">
                        <div class="col-sm-8">
                            <mat-form-field class="matFieldWidth100"
                                [appearance]="MaterialFormFieldAppearance.FORM_FIELD_APPEARANCE">
                                <mat-label class="formLabel">Select Combustion Equipment</mat-label>
                                <mat-select formControlName="sourceID" multiple required>
                                    <mat-option>
                                        <ngx-mat-select-search [formControl]="combustionEquipmentSearch.filterFC"
                                            placeholderLabel="Search by name"
                                            noEntriesFoundLabel="No matching name found.">
                                        </ngx-mat-select-search>
                                    </mat-option>
                                    <mat-option
                                        *ngFor="let equipment of combustionEquipmentSearch.filteredEntities | async"
                                        [value]="equipment.assetID" (click)="setSourceTypeID(formGroup, equipment)">
                                        {{ equipment.assetName }}
                                    </mat-option>
                                </mat-select>
                                <mat-error *ngIf="errorHandlingFA(formGroup, 'sourceID', 'required')">
                                    {{ FormErrorEnum.REQUIRED }}
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </ng-container>
                </div>
            </ng-container>
        </ng-container>
    </form>
</mat-card>