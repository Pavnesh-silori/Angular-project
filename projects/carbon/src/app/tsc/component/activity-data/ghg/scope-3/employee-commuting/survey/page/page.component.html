<div class="card main-card cardOverwrite h100">
    <div class="headerContainer">
        <div class="headerLeftContainer">
            <div class="pageTitle">Employee commute survey</div>
            <div class="pageSubtitle"></div>
        </div>
        <div class="headerRightContainer">
			<div class="headerRightContainerInner">
				<lib-search-bar-one class="me-3" #searchBar [searchBy]="'name'"
					(emitSearch)="searchFn($event)"></lib-search-bar-one>

				<button class="btn btn-sm btn-light refreshBtn centerAlign me-3 py-1" #refreshBtn matRipple
					[matRippleCentered]="MATERIAL_CONSTANT.MAT_RIPPLE_CENTER" matTooltipPosition="below"
					[matTooltip]="'Refresh'">
					<span class="material-symbols-outlined">
						refresh
					</span>
				</button>
				<button class="btn btn-sm btn-success" type="button" (click)=createSurvey()>
					<fa-icon [icon]="faPlus"></fa-icon> &nbsp;
                    Survey
				</button>
			</div>
		</div>
    </div>

    <div class="ms-3 me-3">
		<lib-date-filter #filterChild></lib-date-filter>
	</div>

    <div class="ms-3 mb-4">
        <button matRipple [matRippleCentered]="MATERIAL_CONSTANT.MAT_RIPPLE_CENTER" class="btn btn-link float-end"
            (click)="refreshFilter()" [disabled]="statusFlag == false">
            <span class="material-symbols-outlined fs-6">
                filter_list_off
            </span>
            Reset Filters
        </button>
    </div>

    <table mat-table [dataSource]="dataSource" #sort matSort matSortActive="id" matSortDirection="desc"
        matSortDisableClear>
        <ng-container matColumnDef="id">
            <th class="surveyID" mat-header-cell *matHeaderCellDef mat-sort-header disableClear> Survey ID </th>
            <td mat-cell *matCellDef="let row">
                {{ row.surveyID ? row.surveyID : COMMON_CONSTANT.HYPHEN }}
            </td>
        </ng-container>


        <ng-container matColumnDef="surveyName">
            <th class="ps-3 surveyName" mat-header-cell *matHeaderCellDef> Survey name </th>
            <td class="ps-3 " style="cursor: pointer;" mat-cell *matCellDef="let row"> <a
                    [routerLink]="routeToView(row)">{{ row.surveyName? row.surveyName :COMMON_CONSTANT.HYPHEN}}</a>
            </td>
        </ng-container>

        <ng-container matColumnDef="AccStartDate">
            <th class="ps-3 AccStartDate" mat-header-cell *matHeaderCellDef> Accounting start date </th>
            <td class="ps-3" mat-cell *matCellDef="let row">
                {{ row.accountingStartDate | date:'dd-MMM-yyyy'}}
            </td>
        </ng-container>

        <ng-container matColumnDef="totalEmployee">
            <th mat-header-cell *matHeaderCellDef> Total employee </th>
            <td class="totalEmployeeData" mat-cell *matCellDef="let row"> {{ row.totalEmployee? row.totalEmployee
                :COMMON_CONSTANT.HYPHEN}}
            </td>
        </ng-container>

        <ng-container matColumnDef="sampleSetPCT">
            <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear> Sample set </th>
            <td class="ps-4" mat-cell *matCellDef="let row"> {{ row.sampleSetPct? row.sampleSetPct +
                '%':COMMON_CONSTANT.HYPHEN}}
            </td>
        </ng-container>

        <ng-container matColumnDef="status">
            <th class="ps-3 status" mat-header-cell *matHeaderCellDef>
                <div class="row" style="display: flex; align-items: center;">
                    <funnel-filter #statusSelect header="Status" type="mono" [entityList]="statusList"
							value="keyID" view="name" [selectFC]="statusFC" [searchBy]="name" [active]="statusFlag"
							selectAllLabel="Select all" (mono)="statusFlag = true;">
						</funnel-filter>
                    <!-- <span class="col-sm-4" style="white-space: nowrap;">Status</span>
                    <funnel-filter class="col-sm-2"  #statusSelect header="" type="mono"
                        value="keyID" view="name" [entityList]="statusList" [selectFC]="statusFC" [active]="statusFlag"
                        (mono)="statusFlag = true;">
                    </funnel-filter> -->
                </div>
            </th>
            <td class="ps-3" mat-cell *matCellDef="let row">{{ row.status? getStatusName(row.status) :
                COMMON_CONSTANT.HYPHEN}}
            </td>
        </ng-container>


        <ng-container matColumnDef="reminder">
            <th class="reminder" mat-header-cell *matHeaderCellDef>
            </th>
            <td mat-cell *matCellDef="let row">
                <span class="ms-5 text-success surveyDecision" *ngIf="row.status !== 'COMPLETED'"
                    (click)="reminder(row)">
                    Reminder
                </span>
            </td>
        </ng-container>

        <ng-container matColumnDef="sendData">
            <th class="end" mat-header-cell *matHeaderCellDef>
            </th>
            <td mat-cell *matCellDef="let row">
                <span class="ms-5 text-danger surveyDecision" *ngIf="row.status !== 'COMPLETED'"
                    (click)="endSurvey(row)">
                    End Survey
                </span>
            </td>
        </ng-container>

        <!-- If, in the future, we decide to implement editing or deleting functionality -->

        <!-- <ng-container matColumnDef="action">
            <th class="ps-3 action" mat-header-cell *matHeaderCellDef></th>
            <td class="ps-3" mat-cell *matCellDef="let row">
                <div class="btn-group" ngbDropdown placement="left-top">
                    <button type="button" ngbDropdownToggle class="dropdown-after dropdownAfter btn">
                        <fa-icon [icon]="faEllipsisV">
                        </fa-icon>
                    </button>
                    <div ngbDropdownMenu>
                        <button class="dropdown-item" (click)="routeToADUpdate(row)">
                            Edit
                        </button>
                    </div>
                </div>
            </td>
        </ng-container> -->

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell text-center" [attr.colspan]="displayedColumns.length">
                {{ TABLE_CONSTANT.TABLE_NO_DATA }}
            </td>
        </tr>
    </table>

    <mat-paginator class="roundedBorder" #paginator [length]="resultLength"
        [pageSizeOptions]="TABLE_CONSTANT['pageSizeOption']" [pageSize]="TABLE_CONSTANT['pageSize']"
        showFirstLastButtons>
    </mat-paginator>
</div>